{"version":3,"sources":["meteor://ðŸ’»app/packages/montiapm:agent/lib/common/utils.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/common/unify.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/common/default_error_filters.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/common/send.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/models/base_error.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/models/0model.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/models/methods.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/models/pubsub.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/models/system.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/models/errors.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/models/http.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/jobs.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/retry.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/utils.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/ntp.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/sourcemaps.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/wait_time_builder.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/check_for_oplog.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/tracer/tracer.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/tracer/default_filters.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/tracer/tracer_store.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/docsize_cache.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/kadira.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/wrap_server.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/wrap_session.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/wrap_subscription.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/wrap_observers.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/wrap_ddp_stringify.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/instrument.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/db.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/http.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/email.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/async.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/error.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/set_labels.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/fast_render.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/fs.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/gc.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/mongo_driver_events.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/picker.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/timeout_manager.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/wrap_routers.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/hijack/wrap_webapp.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/environment_variables.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/auto_connect.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/conflicting_agents.js","meteor://ðŸ’»app/packages/montiapm:agent/lib/event_loop_monitor.js"],"names":["module","export","getClientArchVersion","getErrorParameters","objectHasData","millisToHuman","Meteor","link","v","arch","autoupdate","__meteor_runtime_config__","versions","version","autoupdateVersionCordova","autoupdateVersion","createStackTrace","Error","captureStackTrace","err","Kadira","trackError","stack","split","toRemove","length","indexOf","join","slice","args","type","message","subType","kadiraInfo","options","isClient","stacks","error","isErrorObject","obj","Object","values","some","val","undefined","includes","milliseconds","millis","seconds","Math","floor","minutes","hours","days","builder","push","concat","Monti","wrapAsync","_wrapAsync","isServer","EventEmitter","Npm","require","eventBus","setMaxListeners","buildArgs","eventName","unshift","EventBus","forEach","m","_len","arguments","Array","_key","_args","commonErrRegExps","errorFilters","filterValidationErrors","filterCommonMeteorErrors","lc","regExp","test","Retry","send","payload","path","callback","connected","substr","endpoint","retryCount","retry","minCount","minTimeout","baseTimeout","maxTimeout","sendFunction","_getSendFunction","tryToSend","retryLater","console","warn","res","statusCode","data","content","_serverSend","_clientSend","_makeHttpRequest","headers","JSON","stringify","BaseErrorModel","_filters","prototype","addFilter","filter","removeFilter","index","splice","applyFilters","validated","ex","KadiraModel","_getDateId","timestamp","remainder","dateId","MethodsModel","_","TracerStore","Ntp","DDSketch","METHOD_METRICS_FIELDS","metricsThreshold","methodMetricsByMinute","create","errorMap","_metricsThreshold","extend","wait","db","http","email","async","compute","total","maxEventTimesForMethods","tracerStore","interval","maxTotalPoints","archiveEvery","start","_getMetrics","method","methods","count","errors","fetchedDocSize","sentMsgSize","histogram","alpha","field","processMethod","methodTrace","at","_appendMetrics","errored","name","addTrace","id","methodMetrics","startTime","value","metrics","add","endTime","trackDocSize","size","_now","trackMsgSize","buildPayload","methodRequests","key","syncedDate","syncTime","methodName","collectTraces","PubsubModel","countKeys","getProperty","iterate","logger","metricsByMinute","subscriptions","_trackSub","session","msg","params","publication","_getPublicationName","subs","_startTime","_trackUnsub","sub","_subscriptionId","_name","subscriptionId","subscriptionState","unsubs","lifeTime","_trackReady","trace","readyTracked","resTime","_trackError","pubs","activeSubs","activeDocs","totalObservers","cachedObservers","createdObservers","deletedObservers","observerLifetime","polledDocuments","oplogUpdatedDocuments","oplogInsertedDocuments","oplogDeletedDocuments","initiallyAddedDocuments","liveAddedDocuments","liveChangedDocuments","liveRemovedDocuments","polledDocSize","initiallyFetchedDocSize","liveFetchedDocSize","initiallySentMsgSize","liveSentMsgSize","_getSubscriptionInfo","self","server","sessions","_namedSubs","countSubData","_universalSubs","avgObserverReuse","each","countSubscriptions","countDocuments","countObservers","_documents","collection","_totalObservers","_cachedObservers","pubMetrics","subscriptionData","dateMetrics","singlePubMetrics","pubRequests","incrementHandleCount","isCached","publicationName","trackCreatedObserver","info","trackDeletedObserver","Date","getTime","trackDocumentChanges","op","trackPolledDocuments","trackLiveUpdates","SystemModel","createHistogram","GCMetrics","default","getFiberMetrics","resetFiberMetrics","getMongoDriverStats","resetMongoDriverStats","EventLoopMonitor","newSessions","sessionTimeout","evloopHistogram","evloopMonitor","on","lag","gcMetrics","cpuTime","process","hrtime","previousCpuUsage","cpuUsage","cpuHistory","currentCpuUsage","setInterval","now","memoryUsage","memory","rss","memoryArrayBuffers","arrayBuffers","memoryExternal","external","memoryHeapUsed","heapUsed","memoryHeapTotal","heapTotal","activeRequests","_getActiveRequests","activeHandles","_getActiveHandles","pctEvloopBlock","status","pctBlock","gcMajorDuration","gcMajor","gcMinorDuration","gcMinor","gcIncrementalDuration","gcIncremental","gcWeakCBDuration","gcWeakCB","reset","driverMetrics","mongoPoolSize","poolSize","mongoPoolPrimaryCheckouts","primaryCheckouts","mongoPoolOtherCheckouts","otherCheckouts","mongoPoolCheckoutTime","checkoutTime","mongoPoolMaxCheckoutTime","maxCheckoutTime","mongoPoolPending","pending","mongoPoolCheckedOutConnections","checkedOut","mongoPoolCreatedConnections","created","fiberMetrics","createdFibers","activeFibers","active","fiberPoolSize","pcpu","pcpuUser","pcpuSystem","lastCpuUsage","usage","user","sys","map","entry","time","systemMetrics","hrtimeToMS","elapTimeMS","elapUsage","elapUserMS","elapSystMS","system","totalUsageMS","totalUsagePercent","docSzCache","setPcpu","handleSessionActivity","countNewSession","isSessionActive","_activeAt","isLocalAddress","socket","inactiveTime","isLocalHostRegex","isLocalAddressRegex","host","address","remoteAddress","ErrorModel","appId","call","maxErrors","assign","metric","errorCount","errorDef","_formatError","details","errorEvent","events","errorObject","HttpModel","processRequest","req","routeId","routes","statusCodes","requestMetrics","statusMetric","httpMetrics","httpRequests","requestName","Jobs","getAsync","coreApi","getJob","then","catch","setAsync","changes","updateJob","set","get","Random","constructor","exponent","fuzz","retryTimer","clear","clearTimeout","_timeout","timeout","min","pow","fraction","ceil","fn","setTimeout","haveAsyncCallback","UniqueId","DefaultUniqueId","CreateUserStack","OptimizedApply","getClientVersions","pick","lastArg","context","a","apply","Map","Set","keys","reduce","result","getLogger","disableNtp","isDisabled","setEndpoint","diff","synced","reSyncCount","reSync","round","localTime","sync","cacheDns","getServerTime","calculateTimeDiff","clientStartTime","serverTime","networkTime","serverStartTime","noRetries","parseInt","random","canLog","global","localStorage","getItem","e","log","handleApiResponse","WebApp","fs","clientPaths","__meteor_bootstrap__","configJson","clientArchs","serverDir","absClientPaths","resolve","dirname","body","unavailable","parse","neededSourcemaps","promises","sourcemap","uploadSourceMaps","getSourcemapPath","file","sourceMapPath","sendSourcemap","Promise","all","sendData","unavailableSourcemaps","_body","sourcemapPath","stream","createReadStream","archVersion","encodeURIComponent","sendStream","preparePath","urlPath","posix","normalize","checkForDynamicImport","filePath","archPath","dynamicPath","stat","reject","clientProgram","clientPrograms","manifest","fileInfo","find","url","startsWith","sourceMap","WaitTimeBuilder","TimeoutManager","WAITON_MESSAGE_FIELDS","_waitListStore","_currentProcessingMessages","_messageCache","register","msgId","mainKey","_getMessageKey","inQueue","toArray","waitList","_getCacheMessage","currentlyProcessingMessage","build","filteredWaitList","_cleanCacheMessage","bind","sessionId","cachedMessage","_registered","trackWaitTime","unblock","started","unblocked","wrappedUnblock","waitTime","OplogCheck","Tracker","env","MONGO_OPLOG_URL","code","reason","solution","disableOplog","cursorDescription","_disableOplog","miniMongoMatcher","Minimongo","Matcher","selector","miniMongoSorter","matcher","Sorter","sort","fields","projection","LocalCollection","_checkSupportedProjection","skip","where","hasWhere","geo","hasGeoQuery","limitButNoSort","limit","thirdParty","observerDriver","unknownReason","driver","preRunningMatchers","globalMatchers","checkWhyNoOplog","runMatchers","matcherList","matched","Tracer","eventLogger","REPETITIVE_EVENTS","custom","TRACE_TYPES","MAX_TRACE_EVENTS","_filterFields","maxArrayItemsToFilter","userId","traceInfo","_id","event","metaData","lastEvent","getLastEvent","isEventsProcessed","endAt","nested","_applyFilters","eventStackTrace","dir","depth","lastNested","eventEnd","endLastEvent","forcedEnd","_hasUsefulNested","every","buildEvent","elapsedTimeForEvent","builtEvent","prevEnd","i","nestedEvent","computeTime","buildTrace","firstEvent","processedEvents","totalNonCompute","prevEvent","lastEventData","removeCount","optimizeEvent","objectEvent","duration","optimizedNestedEvents","optimizeEvents","optimizedEvent","extraInfo","optimizedEvents","filterFn","redactField","eventType","clone","_applyObjectFilters","toFilter","filterObject","cloned","isArray","tracer","stripSensitive","typesToStrip","receiverType","strippedTypes","item","stripSensitiveThorough","fieldsToKeep","stripSelectors","collectionList","collMap","collName","coll","EJSON","maxTotals","currentMaxTrace","traceArchive","processedCnt","kind","_handleErrors","traces","_timeoutHandler","processTraces","stop","clearInterval","errorKey","erroredTrace","kinds","currentMaxTotal","exceedingPoints","archiveDefault","canArchive","_isTraceOutlier","dataSet","_isOutlier","dataPoint","maxMadZ","median","_getMedian","mad","_calculateMad","madZ","_funcMedianDeviation","sortedDataSet","b","_pickQuartile","num","pos","medianDeviations","x","abs","_getMean","dataPoints","point","DocSzCache","DocSzCacheItem","LRU","jsonStringify","maxItems","maxValues","items","max","getSize","query","opts","getKey","needsUpdate","doc","element","Buffer","byteLength","addData","getValue","getItemScore","updated","score","currentTime","timeSinceUpdate","shift","sortNumber","sorted","idx","packageMap","TrackMeteorDebug","TrackUncaughtExceptions","TrackUnhandledRejections","hostname","Fibers","KadiraCore","DEBUG_PAYLOAD_SIZE","MONTI_DEBUG_PAYLOAD_SIZE","models","currentSub","EnvironmentVariable","waitTimeBuilder","pubsub","buildInterval","_buildPayload","connect","appSecret","payloadTimeout","clientEngineSyncDelay","thresholds","isHostNameSet","proxy","recordIPAddress","stalledTimeout","disableClientErrorTracking","documentSizeCacheSize","last","enableErrorTracking","isProduction","authHeaders","trim","agentVersion","_headers","release","replace","_checkAuth","_sendAppStats","_schedulePayloadSend","addFilterFn","kadira","disableErrorTracking","startup","publish","_options","added","ready","clientVersions","buildDetailedInfo","_isDetailedInfo","_countDataSent","_detailInfoSentInterval","appStats","protocolVersion","packageVersions","Package","_sendPayload","logPayload","traceCount","largestTrace","countBreakdowns","breakdowns","sizeTraces","stringified","normalized","entries","_ref","k","logErr","RangeError","run","_getInfo","currentFiber","useEnvironmentVariable","current","__kadiraInfo","_setInfo","startContinuousProfiling","MontiProfiler","startContinuous","onProfile","_ref2","profile","profiles","enableClientErrorTracking","previousEvents","ignoreErrorTracking","_skipKadira","startEvent","endEvent","wrapServer","serverProto","originalHandleConnect","_handleConnect","_meteorSession","emit","wrapSession","MeteorDebugIgnore","MAX_PARAMS_LENGTH","sessionProto","originalProcessMessage","processMessage","stringifiedParams","startData","_waitEventId","originalMethodHandler","protocol_handlers","response","trackTimeout","waitOn","withValue","orginalSubHandler","orginalUnSubHandler","unsub","originalSend","currentError","method_handlers","handler","wrapMethodHanderForErrors","originalMeteorMethods","methodMap","originalHandler","source","wrapSubscription","subscriptionProto","originalRunHandler","_runHandler","originalReady","_apmReadyTracked","_session","originalError","errorForApm","originalDeactivate","_deactivate","funcName","originalFunc","collectionName","wrapOplogObserveDriver","wrapPollingObserveDriver","wrapMultiplexer","wrapForCountingObservers","proto","originalPublishNewResults","_publishNewResults","newResults","newBuffer","_cursorDescription","docSize","_ownerInfo","_polledDocuments","_docSize","polledFetches","originalHandleOplogEntryQuerying","_handleOplogEntryQuerying","originalHandleOplogEntrySteadyOrFetching","_handleOplogEntrySteadyOrFetching","fnName","originalFn","c","_liveUpdatesCounts","_initialAdds","initialFetches","originalStop","originalPollMongo","_pollMongo","_results","_map","_polledDocSize","originalInitalAdd","addHandleAndSendInitialAdds","handle","_firstInitialAddTime","_wasMultiplexerReady","_ready","_queueLength","_queue","_taskHandles","_elapsedPollingTime","mongoConnectionProto","MeteorX","MongoConnection","originalObserveChanges","_observeChanges","ordered","callbacks","ret","_multiplexer","__kadiraTracked","ownerInfo","_observeDriver","wrapStringifyDDP","DDPCommon","originalStringifyDDP","stringifyDDP","msgString","msgSize","wrapWebApp","wrapFastRender","wrapFs","wrapPicker","wrapRouters","wrapFibers","setLabels","hijackDBOps","instrumented","_startInstrumenting","onReady","Server","Session","Subscription","MongoOplogDriver","MongoPollingDriver","Multiplexer","Mongo","MongoInternals","originalOpen","RemoteCollectionDriver","open","mongo","getSyncronousCursor","MongoColl","Collection","findOne","cursor","fetch","_synchronousCursor","func","mod","upsert","eventId","endOptions","updatedDocs","numberAffected","insertedId","removedDocs","cursorProto","MongoCursor","cursorOptions","previousTrackNextObject","trackNextObject","endData","oplog","wasMultiplexerReady","queueLength","elapsedPollingTime","observerDriverClass","cursorSupported","_cache","docs","noOfCachedDocs","initialPollingTime","_lastPollTime","reasonInfo","noOplogCode","noOplogReason","noOplogSolution","docsFetched","SyncronousCursor","origNextObject","_nextObject","shouldTrack","HTTP","library","originalCall","Request","request","CAPTURED_OPTIONS","getWrapper","wrapper","Email","sendAsync","EventSymbol","Symbol","StartTracked","wrapped","endAsyncEvent","fiber","originalYield","yield","originalRun","originalThrowInto","throwInto","ensureFiberCounted","activeFiberTotal","activeFiberCount","previousTotalCreated","fibersCreated","timer","throwError","printErrorAndKill","_tracked","getTrace","_err","nextTick","exit","originalMeteorDebug","_debug","isArgs","alreadyTracked","errorMessage","separator","endsWith","DDPServer","kadira_Session_send","originalSendAdds","_sendAdds","kadira_Multiplexer_sendAdds","originalMongoInsert","_insert","kadira_MongoConnection_insert","cb","originalMongoUpdate","_update","kadira_MongoConnection_update","originalMongoRemove","_remove","kadira_MongoConnection_remove","originalPubsubAdded","sendAdded","kadira_Session_sendAdded","originalPubsubChanged","sendChanged","kadira_Session_sendChanged","originalPubsubRemoved","sendRemoved","kadira_Session_sendRemoved","originalCursorForEach","kadira_Cursor_forEach","originalCursorMap","kadira_Cursor_map","originalCursorFetch","kadira_Cursor_fetch","originalCursorCount","kadira_Cursor_count","originalCursorObserveChanges","observeChanges","kadira_Cursor_observeChanges","originalCursorObserve","observe","kadira_Cursor_observe","originalCrossbarListen","_Crossbar","listen","kadira_Crossbar_listen","trigger","originalCrossbarFire","fire","kadira_Crossbar_fire","notification","FastRender","origRoute","route","_callback","suggestedRouteName","handleErrorEvent","wrapCallback","createWrapper","eventEmitter","listenerCount","removeListener","fsKadiraInfo","originalStat","originalCreateReadStream","PerformanceObserver","constants","performance","_observer","observer","list","getEntries","_mapKindToMetric","clearGC","entryTypes","buffered","gcKind","NODE_PERFORMANCE_GC_MAJOR","NODE_PERFORMANCE_GC_MINOR","NODE_PERFORMANCE_GC_INCREMENTAL","NODE_PERFORMANCE_GC_WEAKCB","client","serverStatus","totalCheckoutTime","measurementCount","pendingTotal","checkedOutTotal","getServerStatus","getPrimary","DEFAULT_MAX_POOL_SIZE","getPoolSize","topology","s","maxPoolSize","_client","defaultRemoteCollectionDriver","versionParts","NpmModules","mongodb","part","useUnifiedTopology","primaryDescription","getServerDescription","pool","totalConnections","totalConnectionCount","availableConnections","availableConnectionCount","primary","delete","connectionId","checkoutDuration","disableCreate","lastIsMaster","lastHello","servers","description","Fiber","Picker","origProcessRoute","_processRoute","prettyMessage","addTimeout","bindEnvironment","timeoutId","has","connectRoutes","connectRoute","router","oldAdd","checkHandlersInFiber","WebAppInternals","MAX_BODY_SIZE","MAX_STRINGIFIED_BODY_SIZE","canWrapStaticHandler","staticFilesByArch","handlersLength","rawConnectHandlers","inFiber","outsideFiber","use","_req","_res","next","pop","InfoSymbol","asyncApply","parseUrl","registerBoilerplateDataCallback","isAppRoute","origCategorizeRequest","categorizeRequest","pathname","asyncEvent","isStatic","isJson","hasSmallBody","built","wrapHandler","errorHandler","nextCalled","wrappedNext","potentialPromise","finished","wrapConnect","app","wrapStack","oldUse","wrappedHandler","meteorInternalHandlers","connectHandlers","connectApp","oldStaticFilesMiddleware","staticFilesMiddleware","staticHandler","_staticFiles","normalizedPrefix","_parseEnv","normalizedName","parser","str","parseBool","toLowerCase","parseString","MONTI_APP_ID","MONTI_APP_SECRET","MONTI_OPTIONS_STALLED_TIMEOUT","MONTI_OPTIONS_CLIENT_ENGINE_SYNC_DELAY","MONTI_OPTIONS_ERROR_DUMP_INTERVAL","MONTI_OPTIONS_MAX_ERRORS_PER_INTERVAL","MONTI_OPTIONS_COLLECT_ALL_STACKS","MONTI_OPTIONS_ENABLE_ERROR_TRACKING","MONTI_OPTIONS_DISABLE_CLIENT_ERROR_TRACKING","MONTI_OPTIONS_ENDPOINT","MONTI_OPTIONS_HOSTNAME","MONTI_OPTIONS_PAYLOAD_TIMEOUT","MONTI_OPTIONS_PROXY","MONTI_OPTIONS_DOCUMENT_SIZE_CACHE_SIZE","MONTI_UPLOAD_SOURCE_MAPS","MONTI_RECORD_IP_ADDRESS","MONTI_EVENT_STACK_TRACE","MONTI_OPTIONS_DISABLE_NTP","_connectWithEnv","_connectWithSettings","montiSettings","settings","monti","conflictingPackages","isNode","node","polyfillNow","nanoseconds","timeoutMillis","_watchLag","_stopped","_totalLag","_registerNowFunc","_lastWatchTime","_detectLag","removeAllListeners","elapsedTime","statusObject","totalLag","end","realDiff","major","Number","window"],"mappings":"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","file":"/packages/montiapm_agent.js","sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nexport function getClientArchVersion (arch) {\n  const autoupdate = __meteor_runtime_config__.autoupdate;\n\n  if (autoupdate) {\n    return autoupdate.versions[arch] ? autoupdate.versions[arch].version : 'none';\n  }\n\n  // Meteor 1.7 and older did not have an `autoupdate` object.\n  switch (arch) {\n    case 'cordova.web':\n      return __meteor_runtime_config__.autoupdateVersionCordova;\n    case 'web.browser':\n    case 'web.browser.legacy':\n      // Meteor 1.7 always used the web.browser.legacy version\n      return __meteor_runtime_config__.autoupdateVersion;\n\n    default:\n      return 'none';\n  }\n}\n\nconst createStackTrace = () => {\n  if (Error.captureStackTrace) {\n    let err = {};\n    Error.captureStackTrace(err, Kadira.trackError);\n    return err.stack;\n  }\n\n  const stack = new Error().stack.split('\\n');\n  let toRemove = 0;\n\n  // Remove frames starting from when trackError was called\n  for (; toRemove < stack.length; toRemove++) {\n    if (stack[toRemove].indexOf('trackError') > -1) {\n      toRemove += 1;\n      break;\n    }\n  }\n\n  // In safari, there isn't a frame that has trackError\n  if (toRemove === stack.length) {\n    return stack.join('\\n');\n  }\n\n  return stack.slice(toRemove).join('\\n');\n};\n\nexport const getErrorParameters = function (args) {\n  let type = null;\n  let message = null;\n  let subType = null;\n  let stack = null;\n  let kadiraInfo = null;\n\n  if (\n    !(args[0] instanceof Error) &&\n    typeof args[0] === 'string' &&\n    typeof args[1] === 'string'\n  ) {\n    // Old usage:\n    // Monti.trackError(\n    //   'type', 'error message', { stacks: 'error stack', subType: 'sub type }\n    // );\n\n    const options = args[2] || {};\n\n    type = args[0];\n    subType = Meteor.isClient ? args[0] : options.subType;\n    message = args[1];\n    stack = options.stacks || createStackTrace();\n    kadiraInfo = options.kadiraInfo;\n  } else {\n    // New usage:\n    // Monti.trackError(error, { type: 'type', subType: 'subType' });\n    const error = args[0];\n    const options = args[1] || {};\n    const isErrorObject = typeof error === 'object' && error !== null;\n\n    message = isErrorObject ? error.message : error;\n    stack = isErrorObject && error.stack || createStackTrace();\n    type = options.type;\n    subType = options.subType;\n    kadiraInfo = options.kadiraInfo;\n  }\n\n  return { type, message, subType, stack, kadiraInfo };\n};\n\n/**\n * @param {Object} obj The object to check.\n * @returns {boolean} True if the object has set any data which is not `null`, `undefined` or an empty string.\n */\nexport const objectHasData = function (obj) {\n  return Object.values(obj).some(val => ![null, undefined, ''].includes(val));\n};\n\n/**\n * @param {Number} milliseconds The number of milliseconds.\n * @returns {string} A human-readable representation of the given milliseconds.\n */\nexport const millisToHuman = function (milliseconds) {\n  const millis = milliseconds % 1000;\n  const seconds = Math.floor(milliseconds / 1000);\n  const minutes = Math.floor(seconds / 60);\n  const hours = Math.floor(minutes / 60);\n  const days = Math.floor(hours / 24);\n\n  const builder = [];\n\n  if (days > 0) {\n    builder.push(`${days}d`);\n  }\n\n  if (hours > 0) {\n    builder.push(`${hours % 24}h`);\n  }\n\n  if (minutes > 0) {\n    builder.push(`${minutes % 60}m`);\n  }\n\n  if (seconds > 0) {\n    builder.push(`${seconds % 60}s`);\n  }\n\n  if (millis > 0) {\n    builder.push(`${millis}ms`);\n  }\n\n  return builder.join(' ');\n};\n","import { Meteor } from 'meteor/meteor';\n\nKadira = {};\nKadira.options = {};\n\nMonti = Kadira;\n\nif (Meteor.wrapAsync) {\n  Kadira._wrapAsync = Meteor.wrapAsync;\n} else {\n  Kadira._wrapAsync = Meteor._wrapAsync;\n}\n\nif (Meteor.isServer) {\n  const EventEmitter = Npm.require('events').EventEmitter;\n  const eventBus = new EventEmitter();\n  eventBus.setMaxListeners(0);\n\n  const buildArgs = function (args) {\n    let eventName = `${args[0]}-${args[1]}`;\n    args = args.slice(2);\n    args.unshift(eventName);\n    return args;\n  };\n\n  Kadira.EventBus = {};\n\n  ['on', 'emit', 'removeListener', 'removeAllListeners', 'once'].forEach(function (m) {\n    Kadira.EventBus[m] = function (...args) {\n      const _args = buildArgs(args);\n      return eventBus[m](..._args);\n    };\n  });\n}\n","import { Meteor } from 'meteor/meteor';\n\nconst commonErrRegExps = [\n  /connection timeout\\. no (\\w*) heartbeat received/i,\n  /INVALID_STATE_ERR/i,\n];\n\nKadira.errorFilters = {\n  filterValidationErrors (type, message, err) {\n    if (err && err instanceof Meteor.Error) {\n      return false;\n    }\n    return true;\n  },\n\n  filterCommonMeteorErrors (type, message) {\n    for (let lc = 0; lc < commonErrRegExps.length; lc++) {\n      const regExp = commonErrRegExps[lc];\n      if (regExp.test(message)) {\n        return false;\n      }\n    }\n    return true;\n  }\n};\n","import { Meteor } from 'meteor/meteor';\nimport { Retry } from '../retry';\n\nKadira.send = function (payload, path, callback) {\n  if (!Kadira.connected) {\n    throw new Error('You need to connect with Kadira first, before sending messages!');\n  }\n\n  path = path.substr(0, 1) !== '/' ? `/${path}` : path;\n  let endpoint = Kadira.options.endpoint + path;\n  let retryCount = 0;\n  let retry = new Retry({\n    minCount: 1,\n    minTimeout: 0,\n    baseTimeout: 1000 * 5,\n    maxTimeout: 1000 * 60,\n  });\n\n  let sendFunction = Kadira._getSendFunction();\n  tryToSend();\n\n  function tryToSend (err) {\n    if (retryCount < 5) {\n      retry.retryLater(retryCount++, send);\n    } else {\n      console.warn('Error sending error traces to Monti APM server');\n      if (callback) {\n        callback(err);\n      }\n    }\n  }\n\n  function send () {\n    sendFunction(endpoint, payload, function (err, res) {\n      if (err && !res) {\n        tryToSend(err);\n      } else if (res.statusCode === 200) {\n        if (callback) {\n          callback(null, res.data);\n        }\n      } else if (callback) {\n        callback(new Meteor.Error(res.statusCode, res.content));\n      }\n    });\n  }\n};\n\nKadira._getSendFunction = function () {\n  return Meteor.isServer ? Kadira._serverSend : Kadira._clientSend;\n};\n\nKadira._clientSend = function (endpoint, payload, callback) {\n  Kadira._makeHttpRequest('POST', endpoint, {\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    content: JSON.stringify(payload)\n  }, callback);\n};\n\nKadira._serverSend = function () {\n  throw new Error('Kadira._serverSend is not supported. Use coreApi instead.');\n};\n","export function BaseErrorModel () {\n  this._filters = [];\n}\n\nBaseErrorModel.prototype.addFilter = function (filter) {\n  if (typeof filter === 'function') {\n    this._filters.push(filter);\n  } else {\n    throw new Error('Error filter must be a function');\n  }\n};\n\nBaseErrorModel.prototype.removeFilter = function (filter) {\n  const index = this._filters.indexOf(filter);\n  if (index >= 0) {\n    this._filters.splice(index, 1);\n  }\n};\n\nBaseErrorModel.prototype.applyFilters = function (type, message, error, subType) {\n  for (let lc = 0; lc < this._filters.length; lc++) {\n    let filter = this._filters[lc];\n    try {\n      let validated = filter(type, message, error, subType);\n      if (!validated) {\n        return false;\n      }\n    } catch (ex) {\n      // we need to remove this filter\n      // we may ended up in an error cycle\n      this._filters.splice(lc, 1);\n      throw new Error(\"an error thrown from a filter you've suplied\", ex.message);\n    }\n  }\n\n  return true;\n};\n","export function KadiraModel () {}\n\nKadiraModel.prototype._getDateId = function (timestamp) {\n  const remainder = timestamp % (1000 * 60);\n  const dateId = timestamp - remainder;\n  return dateId;\n};\n","import { _ } from 'meteor/underscore';\nconst { DDSketch } = require('monti-apm-sketches-js');\nimport { KadiraModel } from './0model';\nimport { TracerStore } from '../tracer/tracer_store';\nimport { Ntp } from '../ntp';\n\nconst METHOD_METRICS_FIELDS = ['wait', 'db', 'http', 'email', 'async', 'compute', 'total'];\n\nexport function MethodsModel (metricsThreshold) {\n  this.methodMetricsByMinute = Object.create(null);\n  this.errorMap = Object.create(null);\n\n  this._metricsThreshold = _.extend({\n    wait: 100,\n    db: 100,\n    http: 1000,\n    email: 100,\n    async: 100,\n    compute: 100,\n    total: 200\n  }, metricsThreshold || Object.create(null));\n\n  // store max time elapsed methods for each method, event(metrics-field)\n  this.maxEventTimesForMethods = Object.create(null);\n\n  this.tracerStore = new TracerStore({\n    // process traces every minute\n    interval: 1000 * 60,\n    // for 30 minutes\n    maxTotalPoints: 30,\n    // always trace for every 5 minutes\n    archiveEvery: 5\n  });\n\n  this.tracerStore.start();\n}\n\n_.extend(MethodsModel.prototype, KadiraModel.prototype);\n\nMethodsModel.prototype._getMetrics = function (timestamp, method) {\n  const dateId = this._getDateId(timestamp);\n\n  if (!this.methodMetricsByMinute[dateId]) {\n    this.methodMetricsByMinute[dateId] = {\n      methods: Object.create(null),\n    };\n  }\n\n  let methods = this.methodMetricsByMinute[dateId].methods;\n\n  // initialize method\n  if (!methods[method]) {\n    methods[method] = {\n      count: 0,\n      errors: 0,\n      fetchedDocSize: 0,\n      sentMsgSize: 0,\n      histogram: new DDSketch({\n        alpha: 0.02\n      })\n    };\n\n    METHOD_METRICS_FIELDS.forEach(function (field) {\n      methods[method][field] = 0;\n    });\n  }\n\n  return this.methodMetricsByMinute[dateId].methods[method];\n};\n\nMethodsModel.prototype.processMethod = function (methodTrace) {\n  const dateId = this._getDateId(methodTrace.at);\n\n  // append metrics to previous values\n  this._appendMetrics(dateId, methodTrace);\n  if (methodTrace.errored) {\n    this.methodMetricsByMinute[dateId].methods[methodTrace.name].errors++;\n  }\n\n  this.tracerStore.addTrace(methodTrace);\n};\n\nMethodsModel.prototype._appendMetrics = function (id, methodTrace) {\n  const methodMetrics = this._getMetrics(id, methodTrace.name);\n\n  // startTime needs to be converted into serverTime before sending\n  if (!this.methodMetricsByMinute[id].startTime) {\n    this.methodMetricsByMinute[id].startTime = methodTrace.at;\n  }\n\n  // merge\n  METHOD_METRICS_FIELDS.forEach(function (field) {\n    let value = methodTrace.metrics[field];\n    if (value > 0) {\n      methodMetrics[field] += value;\n    }\n  });\n\n  methodMetrics.count++;\n  methodMetrics.histogram.add(methodTrace.metrics.total);\n  this.methodMetricsByMinute[id].endTime = methodTrace.metrics.at;\n};\n\nMethodsModel.prototype.trackDocSize = function (method, size) {\n  const timestamp = Ntp._now();\n  const dateId = this._getDateId(timestamp);\n\n  let methodMetrics = this._getMetrics(dateId, method);\n  methodMetrics.fetchedDocSize += size;\n};\n\nMethodsModel.prototype.trackMsgSize = function (method, size) {\n  const timestamp = Ntp._now();\n  const dateId = this._getDateId(timestamp);\n\n  let methodMetrics = this._getMetrics(dateId, method);\n  methodMetrics.sentMsgSize += size;\n};\n\n/*\n  There are two types of data\n\n  1. methodMetrics - metrics about the methods (for every 10 secs)\n  2. methodRequests - raw method request. normally max, min for every 1 min and errors always\n*/\nMethodsModel.prototype.buildPayload = function () {\n  const payload = {\n    methodMetrics: [],\n    methodRequests: []\n  };\n\n  // handling metrics\n  let methodMetricsByMinute = this.methodMetricsByMinute;\n  this.methodMetricsByMinute = Object.create(null);\n\n  // create final payload for methodMetrics\n  for (let key in methodMetricsByMinute) {\n    const methodMetrics = methodMetricsByMinute[key];\n    // converting startTime into the actual serverTime\n    let startTime = methodMetrics.startTime;\n    methodMetrics.startTime = Kadira.syncedDate.syncTime(startTime);\n\n    for (let methodName in methodMetrics.methods) {\n      METHOD_METRICS_FIELDS.forEach(function (field) {\n        methodMetrics.methods[methodName][field] /=\n          methodMetrics.methods[methodName].count;\n      });\n    }\n\n    payload.methodMetrics.push(methodMetricsByMinute[key]);\n  }\n\n  // collect traces and send them with the payload\n  payload.methodRequests = this.tracerStore.collectTraces();\n\n  return payload;\n};\n","import { Meteor } from 'meteor/meteor';\nimport { _ } from 'meteor/underscore';\nconst logger = Npm.require('debug')('kadira:pubsub');\nconst { DDSketch } = require('monti-apm-sketches-js');\nimport { KadiraModel } from './0model';\nimport { TracerStore } from '../tracer/tracer_store';\nimport { Ntp } from '../ntp';\nimport {countKeys, getProperty, iterate} from '../utils';\n\nexport function PubsubModel () {\n  this.metricsByMinute = Object.create(null);\n  this.subscriptions = Object.create(null);\n\n  this.tracerStore = new TracerStore({\n    // process traces every minute\n    interval: 1000 * 60,\n    // for 30 minutes\n    maxTotalPoints: 30,\n    // always trace for every 5 minutes\n    archiveEvery: 5\n  });\n\n  this.tracerStore.start();\n}\n\nPubsubModel.prototype._trackSub = function (session, msg) {\n  logger('SUB:', session.id, msg.id, msg.name, msg.params);\n  let publication = this._getPublicationName(msg.name);\n  let timestamp = Ntp._now();\n  let metrics = this._getMetrics(timestamp, publication);\n\n  metrics.subs++;\n  this.subscriptions[msg.id] = {\n    // We use localTime here, because when we used synedTime we might get\n    // minus or more than we've expected\n    //   (before serverTime diff changed overtime)\n    startTime: timestamp,\n    publication,\n    params: msg.params,\n    id: msg.id\n  };\n\n  // set session startedTime\n  session._startTime = session._startTime || timestamp;\n};\n\n_.extend(PubsubModel.prototype, KadiraModel.prototype);\n\nPubsubModel.prototype._trackUnsub = function (session, sub) {\n  logger('UNSUB:', session.id, sub._subscriptionId);\n  let publication = this._getPublicationName(sub._name);\n  let subscriptionId = sub._subscriptionId;\n  let subscriptionState = this.subscriptions[subscriptionId];\n\n  let startTime = null;\n  // sometime, we don't have these states\n  if (subscriptionState) {\n    startTime = subscriptionState.startTime;\n  } else {\n    // if this is null subscription, which is started automatically\n    // hence, we don't have a state\n    startTime = session._startTime;\n  }\n\n  // in case, we can't get the startTime\n  if (startTime) {\n    let timestamp = Ntp._now();\n    let metrics = this._getMetrics(timestamp, publication);\n    // track the count\n    if (sub._name !== null) {\n      // we can't track subs for `null` publications.\n      // so we should not track unsubs too\n      metrics.unsubs++;\n    }\n    // use the current date to get the lifeTime of the subscription\n    metrics.lifeTime += timestamp - startTime;\n    // this is place we can clean the subscriptionState if exists\n    delete this.subscriptions[subscriptionId];\n  }\n};\n\nPubsubModel.prototype._trackReady = function (session, sub, trace) {\n  logger('READY:', session.id, sub._subscriptionId);\n  // use the current time to track the response time\n  let publication = this._getPublicationName(sub._name);\n  let subscriptionId = sub._subscriptionId;\n  let timestamp = Ntp._now();\n  let metrics = this._getMetrics(timestamp, publication);\n\n  let subscriptionState = this.subscriptions[subscriptionId];\n  if (subscriptionState && !subscriptionState.readyTracked) {\n    let resTime = timestamp - subscriptionState.startTime;\n    metrics.resTime += resTime;\n    subscriptionState.readyTracked = true;\n    metrics.histogram.add(resTime);\n  }\n\n  if (trace) {\n    this.tracerStore.addTrace(trace);\n  }\n};\n\nPubsubModel.prototype._trackError = function (session, sub, trace) {\n  logger('ERROR:', session.id, sub._subscriptionId);\n  // use the current time to track the response time\n  let publication = this._getPublicationName(sub._name);\n  let timestamp = Ntp._now();\n  let metrics = this._getMetrics(timestamp, publication);\n\n  metrics.errors++;\n\n  if (trace) {\n    this.tracerStore.addTrace(trace);\n  }\n};\n\nPubsubModel.prototype._getMetrics = function (timestamp, publication) {\n  let dateId = this._getDateId(timestamp);\n\n  if (!this.metricsByMinute[dateId]) {\n    this.metricsByMinute[dateId] = {\n      // startTime needs to be convert to serverTime before sending to the server\n      startTime: timestamp,\n      pubs: Object.create(null)\n    };\n  }\n\n  if (!this.metricsByMinute[dateId].pubs[publication]) {\n    this.metricsByMinute[dateId].pubs[publication] = {\n      subs: 0,\n      unsubs: 0,\n      resTime: 0,\n      activeSubs: 0,\n      activeDocs: 0,\n      lifeTime: 0,\n      totalObservers: 0,\n      cachedObservers: 0,\n      createdObservers: 0,\n      deletedObservers: 0,\n      errors: 0,\n      observerLifetime: 0,\n      polledDocuments: 0,\n      oplogUpdatedDocuments: 0,\n      oplogInsertedDocuments: 0,\n      oplogDeletedDocuments: 0,\n      initiallyAddedDocuments: 0,\n      liveAddedDocuments: 0,\n      liveChangedDocuments: 0,\n      liveRemovedDocuments: 0,\n      polledDocSize: 0,\n      fetchedDocSize: 0,\n      initiallyFetchedDocSize: 0,\n      liveFetchedDocSize: 0,\n      initiallySentMsgSize: 0,\n      liveSentMsgSize: 0,\n      histogram: new DDSketch({\n        alpha: 0.02\n      })\n    };\n  }\n\n  return this.metricsByMinute[dateId].pubs[publication];\n};\n\nPubsubModel.prototype._getPublicationName = function (name) {\n  return name || 'null(autopublish)';\n};\n\nPubsubModel.prototype._getSubscriptionInfo = function () {\n  let self = this;\n  let activeSubs = Object.create(null);\n  let activeDocs = Object.create(null);\n  let totalObservers = Object.create(null);\n  let cachedObservers = Object.create(null);\n\n  iterate(Meteor.server.sessions, session => {\n    iterate(session._namedSubs, countSubData);\n    iterate(session._universalSubs, countSubData);\n  });\n\n  let avgObserverReuse = Object.create(null);\n  _.each(totalObservers, function (value, publication) {\n    avgObserverReuse[publication] = cachedObservers[publication] / totalObservers[publication];\n  });\n\n  return {\n    activeSubs,\n    activeDocs,\n    avgObserverReuse\n  };\n\n  function countSubData (sub) {\n    let publication = self._getPublicationName(sub._name);\n    countSubscriptions(sub, publication);\n    countDocuments(sub, publication);\n    countObservers(sub, publication);\n  }\n\n  function countSubscriptions (sub, publication) {\n    activeSubs[publication] = activeSubs[publication] || 0;\n    activeSubs[publication]++;\n  }\n\n  function countDocuments (sub, publication) {\n    activeDocs[publication] = activeDocs[publication] || 0;\n    iterate(sub._documents, collection => {\n      activeDocs[publication] += countKeys(collection);\n    });\n  }\n\n  function countObservers (sub, publication) {\n    totalObservers[publication] = totalObservers[publication] || 0;\n    cachedObservers[publication] = cachedObservers[publication] || 0;\n\n    totalObservers[publication] += sub._totalObservers;\n    cachedObservers[publication] += sub._cachedObservers;\n  }\n};\n\nPubsubModel.prototype.buildPayload = function () {\n  let metricsByMinute = this.metricsByMinute;\n  this.metricsByMinute = Object.create(null);\n\n  let payload = {\n    pubMetrics: []\n  };\n\n  let subscriptionData = this._getSubscriptionInfo();\n  let activeSubs = subscriptionData.activeSubs;\n  let activeDocs = subscriptionData.activeDocs;\n  let avgObserverReuse = subscriptionData.avgObserverReuse;\n\n  // to the averaging\n  for (let dateId in metricsByMinute) {\n    let dateMetrics = metricsByMinute[dateId];\n    // We need to convert startTime into actual serverTime\n    dateMetrics.startTime = Kadira.syncedDate.syncTime(dateMetrics.startTime);\n\n    for (let publication in metricsByMinute[dateId].pubs) {\n      let singlePubMetrics = metricsByMinute[dateId].pubs[publication];\n      // We only calculate resTime for new subscriptions\n      singlePubMetrics.resTime /= singlePubMetrics.subs;\n      singlePubMetrics.resTime = singlePubMetrics.resTime || 0;\n      // We only track lifeTime in the unsubs\n      singlePubMetrics.lifeTime /= singlePubMetrics.unsubs;\n      singlePubMetrics.lifeTime = singlePubMetrics.lifeTime || 0;\n\n      // Count the average for observer lifetime\n      if (singlePubMetrics.deletedObservers > 0) {\n        singlePubMetrics.observerLifetime /= singlePubMetrics.deletedObservers;\n      }\n\n      // If there are two or more dateIds, we will be using the currentCount for all of them.\n      // We can come up with a better solution later on.\n      singlePubMetrics.activeSubs = activeSubs[publication] || 0;\n      singlePubMetrics.activeDocs = activeDocs[publication] || 0;\n      singlePubMetrics.avgObserverReuse = avgObserverReuse[publication] || 0;\n    }\n\n    payload.pubMetrics.push(metricsByMinute[dateId]);\n  }\n\n  // collect traces and send them with the payload\n  payload.pubRequests = this.tracerStore.collectTraces();\n\n  return payload;\n};\n\nPubsubModel.prototype.incrementHandleCount = function (trace, isCached) {\n  let timestamp = Ntp._now();\n  let publicationName = this._getPublicationName(trace.name);\n  let publication = this._getMetrics(timestamp, publicationName);\n\n  let session = getProperty(Meteor.server.sessions, trace.session);\n\n  let sub;\n\n  if (session) {\n    sub = getProperty(session._namedSubs, trace.id);\n    if (sub) {\n      sub._totalObservers = sub._totalObservers || 0;\n      sub._cachedObservers = sub._cachedObservers || 0;\n    }\n  }\n  // not sure, we need to do this? But I don't need to break the however\n  sub = sub || {_totalObservers: 0 , _cachedObservers: 0};\n\n  publication.totalObservers++;\n  sub._totalObservers++;\n  if (isCached) {\n    publication.cachedObservers++;\n    sub._cachedObservers++;\n  }\n};\n\nPubsubModel.prototype.trackCreatedObserver = function (info) {\n  let timestamp = Ntp._now();\n  let publicationName = this._getPublicationName(info.name);\n  let publication = this._getMetrics(timestamp, publicationName);\n  publication.createdObservers++;\n};\n\nPubsubModel.prototype.trackDeletedObserver = function (info) {\n  let timestamp = Ntp._now();\n  let publicationName = this._getPublicationName(info.name);\n  let publication = this._getMetrics(timestamp, publicationName);\n  publication.deletedObservers++;\n  publication.observerLifetime += new Date().getTime() - info.startTime;\n};\n\nPubsubModel.prototype.trackDocumentChanges = function (info, op) {\n  // It's possibel that info to be null\n  // Specially when getting changes at the very begining.\n  // This may be false, but nice to have a check\n  if (!info) {\n    return;\n  }\n\n  let timestamp = Ntp._now();\n  let publicationName = this._getPublicationName(info.name);\n  let publication = this._getMetrics(timestamp, publicationName);\n  if (op.op === 'd') {\n    publication.oplogDeletedDocuments++;\n  } else if (op.op === 'i') {\n    publication.oplogInsertedDocuments++;\n  } else if (op.op === 'u') {\n    publication.oplogUpdatedDocuments++;\n  }\n};\n\nPubsubModel.prototype.trackPolledDocuments = function (info, count) {\n  let timestamp = Ntp._now();\n  let publicationName = this._getPublicationName(info.name);\n  let publication = this._getMetrics(timestamp, publicationName);\n  publication.polledDocuments += count;\n};\n\nPubsubModel.prototype.trackLiveUpdates = function (info, type, count) {\n  let timestamp = Ntp._now();\n  let publicationName = this._getPublicationName(info.name);\n  let publication = this._getMetrics(timestamp, publicationName);\n\n  if (type === '_addPublished') {\n    publication.liveAddedDocuments += count;\n  } else if (type === '_removePublished') {\n    publication.liveRemovedDocuments += count;\n  } else if (type === '_changePublished') {\n    publication.liveChangedDocuments += count;\n  } else if (type === '_initialAdds') {\n    publication.initiallyAddedDocuments += count;\n  } else {\n    throw new Error('Kadira: Unknown live update type');\n  }\n};\n\nPubsubModel.prototype.trackDocSize = function (name, type, size) {\n  let timestamp = Ntp._now();\n  let publicationName = this._getPublicationName(name);\n  let publication = this._getMetrics(timestamp, publicationName);\n\n  if (type === 'polledFetches') {\n    publication.polledDocSize += size;\n  } else if (type === 'liveFetches') {\n    publication.liveFetchedDocSize += size;\n  } else if (type === 'cursorFetches') {\n    publication.fetchedDocSize += size;\n  } else if (type === 'initialFetches') {\n    publication.initiallyFetchedDocSize += size;\n  } else {\n    throw new Error('Kadira: Unknown docs fetched type');\n  }\n};\n\nPubsubModel.prototype.trackMsgSize = function (name, type, size) {\n  let timestamp = Ntp._now();\n  let publicationName = this._getPublicationName(name);\n  let publication = this._getMetrics(timestamp, publicationName);\n\n  if (type === 'liveSent') {\n    publication.liveSentMsgSize += size;\n  } else if (type === 'initialSent') {\n    publication.initiallySentMsgSize += size;\n  } else {\n    throw new Error('Kadira: Unknown docs fetched type');\n  }\n};\n","import { _ } from 'meteor/underscore';\nimport { Meteor } from 'meteor/meteor';\nimport { countKeys, createHistogram } from '../utils.js';\nimport GCMetrics from '../hijack/gc.js';\nimport { getFiberMetrics, resetFiberMetrics } from '../hijack/async.js';\nimport { getMongoDriverStats, resetMongoDriverStats } from '../hijack/mongo_driver_events.js';\nimport { KadiraModel } from './0model';\nimport { EventLoopMonitor } from '../event_loop_monitor.js';\nimport { Ntp } from '../ntp';\n\nexport function SystemModel () {\n  this.startTime = Ntp._now();\n  this.newSessions = 0;\n  // 30 min\n  this.sessionTimeout = 1000 * 60 * 30;\n\n  this.evloopHistogram = createHistogram();\n  this.evloopMonitor = new EventLoopMonitor(200);\n  this.evloopMonitor.start();\n  this.evloopMonitor.on('lag', lag => {\n    // store as microsecond\n    this.evloopHistogram.add(lag * 1000);\n  });\n\n  this.gcMetrics = new GCMetrics();\n  this.gcMetrics.start();\n\n\n  this.cpuTime = process.hrtime();\n  this.previousCpuUsage = process.cpuUsage();\n  this.cpuHistory = [];\n  this.currentCpuUsage = 0;\n\n  setInterval(() => {\n    this.cpuUsage();\n  }, 2000);\n}\n\n_.extend(SystemModel.prototype, KadiraModel.prototype);\n\nSystemModel.prototype.buildPayload = function () {\n  let metrics = {};\n  let now = Ntp._now();\n  metrics.startTime = Kadira.syncedDate.syncTime(this.startTime);\n  metrics.endTime = Kadira.syncedDate.syncTime(now);\n  metrics.sessions = countKeys(Meteor.server.sessions);\n\n  let memoryUsage = process.memoryUsage();\n  metrics.memory = memoryUsage.rss / (1024 * 1024);\n  metrics.memoryArrayBuffers = (memoryUsage.arrayBuffers || 0) / (1024 * 1024);\n  metrics.memoryExternal = memoryUsage.external / (1024 * 1024);\n  metrics.memoryHeapUsed = memoryUsage.heapUsed / (1024 * 1024);\n  metrics.memoryHeapTotal = memoryUsage.heapTotal / (1024 * 1024);\n\n  metrics.newSessions = this.newSessions;\n  this.newSessions = 0;\n\n  metrics.activeRequests = process._getActiveRequests().length;\n  metrics.activeHandles = process._getActiveHandles().length;\n\n  // track eventloop metrics\n  metrics.pctEvloopBlock = this.evloopMonitor.status().pctBlock;\n  metrics.evloopHistogram = this.evloopHistogram;\n  this.evloopHistogram = createHistogram();\n\n  metrics.gcMajorDuration = this.gcMetrics.metrics.gcMajor;\n  metrics.gcMinorDuration = this.gcMetrics.metrics.gcMinor;\n  metrics.gcIncrementalDuration = this.gcMetrics.metrics.gcIncremental;\n  metrics.gcWeakCBDuration = this.gcMetrics.metrics.gcWeakCB;\n  this.gcMetrics.reset();\n\n  const driverMetrics = getMongoDriverStats();\n  resetMongoDriverStats();\n\n  metrics.mongoPoolSize = driverMetrics.poolSize;\n  metrics.mongoPoolPrimaryCheckouts = driverMetrics.primaryCheckouts;\n  metrics.mongoPoolOtherCheckouts = driverMetrics.otherCheckouts;\n  metrics.mongoPoolCheckoutTime = driverMetrics.checkoutTime;\n  metrics.mongoPoolMaxCheckoutTime = driverMetrics.maxCheckoutTime;\n  metrics.mongoPoolPending = driverMetrics.pending;\n  metrics.mongoPoolCheckedOutConnections = driverMetrics.checkedOut;\n  metrics.mongoPoolCreatedConnections = driverMetrics.created;\n\n  const fiberMetrics = getFiberMetrics();\n  resetFiberMetrics();\n  metrics.createdFibers = fiberMetrics.created;\n  metrics.activeFibers = fiberMetrics.active;\n  metrics.fiberPoolSize = fiberMetrics.poolSize;\n\n  metrics.pcpu = 0;\n  metrics.pcpuUser = 0;\n  metrics.pcpuSystem = 0;\n\n  if (this.cpuHistory.length > 0) {\n    let lastCpuUsage = this.cpuHistory[this.cpuHistory.length - 1];\n    metrics.pcpu = lastCpuUsage.usage * 100;\n    metrics.pcpuUser = lastCpuUsage.user * 100;\n    metrics.pcpuSystem = lastCpuUsage.sys * 100;\n  }\n\n  metrics.cpuHistory = this.cpuHistory.map(entry => ({\n    time: Kadira.syncedDate.syncTime(entry.time),\n    usage: entry.usage,\n    sys: entry.sys,\n    user: entry.user\n  }));\n\n  this.cpuHistory = [];\n  this.startTime = now;\n  return {systemMetrics: [metrics]};\n};\n\nfunction hrtimeToMS (hrtime) {\n  return hrtime[0] * 1000 + hrtime[1] / 1000000;\n}\n\nSystemModel.prototype.cpuUsage = function () {\n  let elapTimeMS = hrtimeToMS(process.hrtime(this.cpuTime));\n  let elapUsage = process.cpuUsage(this.previousCpuUsage);\n  let elapUserMS = elapUsage.user / 1000;\n  let elapSystMS = elapUsage.system / 1000;\n  let totalUsageMS = elapUserMS + elapSystMS;\n  let totalUsagePercent = totalUsageMS / elapTimeMS;\n\n  this.cpuHistory.push({\n    time: Ntp._now(),\n    usage: totalUsagePercent,\n    user: elapUserMS / elapTimeMS,\n    sys: elapSystMS / elapUsage.system\n  });\n\n  this.currentCpuUsage = totalUsagePercent * 100;\n  Kadira.docSzCache.setPcpu(this.currentCpuUsage);\n\n  this.cpuTime = process.hrtime();\n  this.previousCpuUsage = process.cpuUsage();\n};\n\nSystemModel.prototype.handleSessionActivity = function (msg, session) {\n  if (msg.msg === 'connect' && !msg.session) {\n    this.countNewSession(session);\n  } else if (['sub', 'method'].indexOf(msg.msg) !== -1) {\n    if (!this.isSessionActive(session)) {\n      this.countNewSession(session);\n    }\n  }\n  session._activeAt = Date.now();\n};\n\nSystemModel.prototype.countNewSession = function (session) {\n  if (!isLocalAddress(session.socket)) {\n    this.newSessions++;\n  }\n};\n\nSystemModel.prototype.isSessionActive = function (session) {\n  let inactiveTime = Date.now() - session._activeAt;\n  return inactiveTime < this.sessionTimeout;\n};\n\n// ------------------------------------------------------------------------- //\n\n// http://regex101.com/r/iF3yR3/2\n// eslint-disable-next-line no-useless-escape\nlet isLocalHostRegex = /^(?:.*\\.local|localhost)(?:\\:\\d+)?|127(?:\\.\\d{1,3}){3}|192\\.168(?:\\.\\d{1,3}){2}|10(?:\\.\\d{1,3}){3}|172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2}$/;\n\n// http://regex101.com/r/hM5gD8/1\nlet isLocalAddressRegex = /^127(?:\\.\\d{1,3}){3}|192\\.168(?:\\.\\d{1,3}){2}|10(?:\\.\\d{1,3}){3}|172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2}$/;\n\nfunction isLocalAddress (socket) {\n  let host = socket.headers['host'];\n  if (host) {\n    return isLocalHostRegex.test(host);\n  }\n  let address = socket.headers['x-forwarded-for'] || socket.remoteAddress;\n  if (address) {\n    return isLocalAddressRegex.test(address);\n  }\n}\n","import { _ } from 'meteor/underscore';\nimport { KadiraModel } from './0model';\nimport { BaseErrorModel } from './base_error';\nimport { Ntp } from '../ntp';\n\nexport function ErrorModel (appId) {\n  BaseErrorModel.call(this);\n  this.appId = appId;\n  this.errors = {};\n  this.startTime = Date.now();\n  this.maxErrors = 10;\n}\n\nObject.assign(ErrorModel.prototype, KadiraModel.prototype);\nObject.assign(ErrorModel.prototype, BaseErrorModel.prototype);\n\nErrorModel.prototype.buildPayload = function () {\n  const metrics = _.values(this.errors);\n  this.startTime = Ntp._now();\n\n  metrics.forEach(function (metric) {\n    metric.startTime = Kadira.syncedDate.syncTime(metric.startTime);\n  });\n\n  this.errors = {};\n  return {errors: metrics};\n};\n\nErrorModel.prototype.errorCount = function () {\n  return _.values(this.errors).length;\n};\n\nErrorModel.prototype.trackError = function (ex, trace) {\n  const key = `${trace.type}:${ex.message}`;\n  if (this.errors[key]) {\n    this.errors[key].count++;\n  } else if (this.errorCount() < this.maxErrors) {\n    const errorDef = this._formatError(ex, trace);\n    if (this.applyFilters(errorDef.type, errorDef.name, ex, errorDef.subType)) {\n      this.errors[key] = this._formatError(ex, trace);\n    }\n  }\n};\n\nErrorModel.prototype._formatError = function (ex, trace) {\n  const time = Date.now();\n  let stack = ex.stack;\n\n  // to get Meteor's Error details\n  if (ex.details) {\n    stack = `Details: ${ex.details}\\r\\n${stack}`;\n  }\n\n  // Update trace's error event with the next stack\n  const errorEvent = trace.events && trace.events[trace.events.length - 1];\n  const errorObject = errorEvent && errorEvent[2] && errorEvent[2].error;\n\n  if (errorObject) {\n    errorObject.stack = stack;\n  }\n\n  return {\n    appId: this.appId,\n    name: ex.message,\n    type: trace.type,\n    startTime: time,\n    subType: trace.subType || trace.name,\n    trace,\n    stacks: [{stack}],\n    count: 1\n  };\n};\n","import { _ } from 'meteor/underscore';\nconst { DDSketch } = require('monti-apm-sketches-js');\nimport { KadiraModel } from './0model';\nimport { TracerStore } from '../tracer/tracer_store';\n\nconst METHOD_METRICS_FIELDS = ['db', 'http', 'email', 'async', 'compute', 'total', 'fs'];\n\n\nexport function HttpModel () {\n  this.metricsByMinute = Object.create(null);\n  this.tracerStore = new TracerStore({\n    interval: 1000 * 10,\n    maxTotalPoints: 30,\n    archiveEvery: 10\n  });\n\n  this.tracerStore.start();\n}\n\n_.extend(HttpModel.prototype, KadiraModel.prototype);\n\nHttpModel.prototype.processRequest = function (trace, req, res) {\n  const dateId = this._getDateId(trace.at);\n  this._appendMetrics(dateId, trace, res);\n  this.tracerStore.addTrace(trace);\n};\n\nHttpModel.prototype._getMetrics = function (timestamp, routeId) {\n  const dateId = this._getDateId(timestamp);\n\n  if (!this.metricsByMinute[dateId]) {\n    this.metricsByMinute[dateId] = {\n      routes: Object.create(null)\n    };\n  }\n\n  const routes = this.metricsByMinute[dateId].routes;\n\n  if (!routes[routeId]) {\n    routes[routeId] = {\n      histogram: new DDSketch({\n        alpha: 0.02,\n      }),\n      count: 0,\n      errors: 0,\n      statusCodes: Object.create(null)\n    };\n\n    METHOD_METRICS_FIELDS.forEach(function (field) {\n      routes[routeId][field] = 0;\n    });\n  }\n\n  return this.metricsByMinute[dateId].routes[routeId];\n};\n\nHttpModel.prototype._appendMetrics = function (dateId, trace, res) {\n  let requestMetrics = this._getMetrics(dateId, trace.name);\n\n  if (!this.metricsByMinute[dateId].startTime) {\n    this.metricsByMinute[dateId].startTime = trace.at;\n  }\n\n  // merge\n  METHOD_METRICS_FIELDS.forEach(field => {\n    let value = trace.metrics[field];\n    if (value > 0) {\n      requestMetrics[field] += value;\n    }\n  });\n\n  const statusCode = res.statusCode;\n  let statusMetric;\n\n  if (statusCode < 200) {\n    statusMetric = '1xx';\n  } else if (statusCode < 300) {\n    statusMetric = '2xx';\n  } else if (statusCode < 400) {\n    statusMetric = '3xx';\n  } else if (statusCode < 500) {\n    statusMetric = '4xx';\n  } else if (statusCode < 600) {\n    statusMetric = '5xx';\n  }\n\n  requestMetrics.statusCodes[statusMetric] = requestMetrics.statusCodes[statusMetric] || 0;\n  requestMetrics.statusCodes[statusMetric] += 1;\n\n  requestMetrics.count += 1;\n  requestMetrics.histogram.add(trace.metrics.total);\n  this.metricsByMinute[dateId].endTime = trace.metrics.at;\n};\n\nHttpModel.prototype.buildPayload = function () {\n  let payload = {\n    httpMetrics: [],\n    httpRequests: []\n  };\n\n  let metricsByMinute = this.metricsByMinute;\n  this.metricsByMinute = Object.create(null);\n\n  for (let key in metricsByMinute) {\n    const metrics = metricsByMinute[key];\n    // convert startTime into the actual serverTime\n    let startTime = metrics.startTime;\n    metrics.startTime = Kadira.syncedDate.syncTime(startTime);\n\n    for (let requestName in metrics.routes) {\n      METHOD_METRICS_FIELDS.forEach(function (field) {\n        metrics.routes[requestName][field] /= metrics.routes[requestName].count;\n      });\n    }\n\n    payload.httpMetrics.push(metricsByMinute[key]);\n  }\n\n  payload.httpRequests = this.tracerStore.collectTraces();\n\n  return payload;\n};\n","let Jobs = Kadira.Jobs = {};\n\nJobs.getAsync = function (id, callback) {\n  Kadira.coreApi.getJob(id)\n    .then(function (data) {\n      callback(null, data);\n    })\n    .catch(function (err) {\n      callback(err);\n    });\n};\n\n\nJobs.setAsync = function (id, changes, callback) {\n  Kadira.coreApi.updateJob(id, changes)\n    .then(function (data) {\n      callback(null, data);\n    })\n    .catch(function (err) {\n      callback(err);\n    });\n};\n\nJobs.set = Kadira._wrapAsync(Jobs.setAsync);\nJobs.get = Kadira._wrapAsync(Jobs.getAsync);\n","import { Random } from 'meteor/random';\n\n// Retry logic with an exponential backoff.\n//\n// options:\n//  baseTimeout: time for initial reconnect attempt (ms).\n//  exponent: exponential factor to increase timeout each attempt.\n//  maxTimeout: maximum time between retries (ms).\n//  minCount: how many times to reconnect \"instantly\".\n//  minTimeout: time to wait for the first `minCount` retries (ms).\n//  fuzz: factor to randomize retry times by (to avoid retry storms).\n\n// TODO: remove this class and use Meteor Retry in a later version of meteor.\n\nexport class Retry {\n  constructor ({\n    // 1 second\n    baseTimeout = 1000,\n    exponent = 2.2,\n    // The default is high-ish to ensure a server can recover from a\n    // failure caused by load.\n    // 5 minutes\n    maxTimeout = 5 * 60000,\n    minTimeout = 10,\n    minCount = 2,\n    // +- 25%\n    fuzz = 0.5,\n  } = {}) {\n    this.baseTimeout = baseTimeout;\n    this.exponent = exponent;\n    this.maxTimeout = maxTimeout;\n    this.minTimeout = minTimeout;\n    this.minCount = minCount;\n    this.fuzz = fuzz;\n    this.retryTimer = null;\n  }\n\n  // Reset a pending retry, if any.\n  clear () {\n    if (this.retryTimer) {\n      clearTimeout(this.retryTimer);\n    }\n    this.retryTimer = null;\n  }\n\n  // Calculate how long to wait in milliseconds to retry, based on the\n  // `count` of which retry this is.\n  _timeout (count) {\n    if (count < this.minCount) {\n      return this.minTimeout;\n    }\n\n    let timeout = Math.min(\n      this.maxTimeout,\n      this.baseTimeout * Math.pow(this.exponent, count));\n    // fuzz the timeout randomly, to avoid reconnect storms when a\n    // server goes down.\n    timeout *= (Random.fraction() * this.fuzz) +\n                         (1 - this.fuzz / 2);\n    return Math.ceil(timeout);\n  }\n\n  // Call `fn` after a delay, based on the `count` of which retry this is.\n  retryLater (count, fn) {\n    const timeout = this._timeout(count);\n    if (this.retryTimer) {\n      clearTimeout(this.retryTimer);\n    }\n\n    this.retryTimer = setTimeout(fn, timeout);\n    return timeout;\n  }\n}\n","import { getClientArchVersion } from './common/utils';\n\nconst { DDSketch } = require('monti-apm-sketches-js');\n\nexport function haveAsyncCallback (args) {\n  const lastArg = args[args.length - 1];\n\n  return typeof lastArg === 'function';\n}\n\nexport class UniqueId {\n  constructor () {\n    this.id = 0;\n  }\n\n  get () {\n    return `${this.id++}`;\n  }\n}\n\nexport const DefaultUniqueId = new UniqueId();\n\n// creates a stack trace, removing frames in montiapm:agent's code\nexport function CreateUserStack (error) {\n  const stack = (error || new Error()).stack.split('\\n');\n  let toRemove = 1;\n\n  // Find how many frames need to be removed\n  // to make the user's code the first frame\n  for (; toRemove < stack.length; toRemove++) {\n    if (stack[toRemove].indexOf('montiapm:agent') === -1) {\n      break;\n    }\n  }\n\n  return stack.slice(toRemove).join('\\n');\n}\n\n// Optimized version of apply which tries to call as possible as it can\n// Then fall back to apply\n// This is because, v8 is very slow to invoke apply.\nexport function OptimizedApply (context, fn, args) {\n  let a = args;\n  switch (a.length) {\n    case 0:\n      return fn.call(context);\n    case 1:\n      return fn.call(context, a[0]);\n    case 2:\n      return fn.call(context, a[0], a[1]);\n    case 3:\n      return fn.call(context, a[0], a[1], a[2]);\n    case 4:\n      return fn.call(context, a[0], a[1], a[2], a[3]);\n    case 5:\n      return fn.call(context, a[0], a[1], a[2], a[3], a[4]);\n    default:\n      return fn.apply(context, a);\n  }\n}\n\nexport function getClientVersions () {\n  return {\n    'web.cordova': getClientArchVersion('web.cordova'),\n    'web.browser': getClientArchVersion('web.browser'),\n    'web.browser.legacy': getClientArchVersion('web.browser.legacy')\n  };\n}\n\n// Returns number of keys of an object, or size of a Map or Set\nexport function countKeys (obj) {\n  if (obj instanceof Map || obj instanceof Set) {\n    return obj.size;\n  }\n\n  return Object.keys(obj).length;\n}\n\n// Iterates objects and maps.\n// Callback is called with a value and key\nexport function iterate (obj, callback) {\n  if (obj instanceof Map) {\n    return obj.forEach(callback);\n  }\n\n  // eslint-disable-next-line guard-for-in\n  for (let key in obj) {\n    let value = obj[key];\n    callback(value, key);\n  }\n}\n\n// Returns a property from an object, or an entry from a map\nexport function getProperty (obj, key) {\n  if (obj instanceof Map) {\n    return obj.get(key);\n  }\n\n  return obj[key];\n}\n\nexport function createHistogram () {\n  return new DDSketch({\n    alpha: 0.02\n  });\n}\n\nexport function pick (obj, keys) {\n  return keys.reduce((result, key) => {\n    if (obj[key] !== undefined) {\n      result[key] = obj[key];\n    }\n    return result;\n  }, {});\n}\n","import { Meteor } from 'meteor/meteor';\nimport { Retry } from './retry';\n\nconst logger = getLogger();\n\nexport class Ntp {\n  constructor (options) {\n    const {endpoint, disableNtp} = options || {};\n\n    this.isDisabled = disableNtp;\n    this.path = '/simplentp/sync';\n    this.setEndpoint(endpoint);\n    this.diff = 0;\n    this.synced = false;\n    this.reSyncCount = 0;\n    this.reSync = new Retry({\n      baseTimeout: 1000 * 60,\n      maxTimeout: 1000 * 60 * 10,\n      minCount: 0\n    });\n  }\n\n  static _now () {\n    const now = Date.now();\n    if (typeof now === 'number') {\n      return now;\n    } else if (now instanceof Date) {\n      // some extenal JS libraries override Date.now and returns a Date object\n      // which directly affect us. So we need to prepare for that\n      return now.getTime();\n    }\n    // trust me. I've seen now === undefined\n    return new Date().getTime();\n  }\n\n  setEndpoint (endpoint) {\n    this.endpoint = endpoint ? endpoint + this.path : null;\n  }\n\n  getTime () {\n    return Ntp._now() + Math.round(this.diff);\n  }\n\n  syncTime (localTime) {\n    return localTime + Math.ceil(this.diff);\n  }\n\n  sync () {\n    if (this.endpoint === null || this.isDisabled) {\n      return;\n    }\n\n    logger('init sync');\n    let self = this;\n    let retryCount = 0;\n\n    let retry = new Retry({\n      baseTimeout: 1000 * 20,\n      maxTimeout: 1000 * 60,\n      minCount: 1,\n      minTimeout: 0\n    });\n\n    syncTime();\n\n    function syncTime () {\n      if (retryCount < 5) {\n        logger('attempt time sync with server', retryCount);\n        // if we send 0 to the retryLater, cacheDns will run immediately\n        retry.retryLater(retryCount++, cacheDns);\n      } else {\n        logger('maximum retries reached');\n        self.reSync.retryLater(self.reSyncCount++, function () {\n          let args = [].slice.call(arguments);\n          self.sync(...args);\n        });\n      }\n    }\n\n    // first attempt is to cache dns. So, calculation does not\n    // include DNS resolution time\n    function cacheDns () {\n      self.getServerTime(function (err) {\n        if (!err) {\n          calculateTimeDiff();\n        } else {\n          syncTime();\n        }\n      });\n    }\n\n    function calculateTimeDiff () {\n      let clientStartTime = new Date().getTime();\n      self.getServerTime(function (err, serverTime) {\n        if (!err && serverTime) {\n          // (Date.now() + clientStartTime)/2 : Midpoint between req and res\n          let networkTime = (new Date().getTime() - clientStartTime) / 2;\n          let serverStartTime = serverTime - networkTime;\n          self.diff = serverStartTime - clientStartTime;\n          self.synced = true;\n          // we need to send 1 into retryLater.\n          self.reSync.retryLater(self.reSyncCount++, function () {\n            let args = [].slice.call(arguments);\n            self.sync(...args);\n          });\n          logger('successfully updated diff value', self.diff);\n        } else {\n          syncTime();\n        }\n      });\n    }\n  }\n\n  getServerTime (callback) {\n    let self = this;\n\n    if (self.endpoint === null) {\n      throw new Error('getServerTime requires the endpoint to be set');\n    }\n\n    if (self.isDisabled) {\n      throw new Error('getServerTime requires NTP to be enabled');\n    }\n\n    if (Meteor.isServer) {\n      Kadira.coreApi.get(self.path, {noRetries: true}).then(content => {\n        let serverTime = parseInt(content, 10);\n        callback(null, serverTime);\n      })\n        .catch(err => {\n          callback(err);\n        });\n    } else {\n      Kadira._makeHttpRequest('GET', `${self.endpoint}?noCache=${new Date().getTime()}-${Math.random()}`, function (err, res) {\n        if (err) {\n          callback(err);\n        } else {\n          let serverTime = parseInt(res.content, 10);\n          callback(null, serverTime);\n        }\n      });\n    }\n  }\n}\n\nfunction getLogger () {\n  if (Meteor.isServer) {\n    return Npm.require('debug')('kadira:ntp');\n  }\n\n  return function (message) {\n    let canLog = false;\n    try {\n      canLog = global.localStorage.getItem('LOG_KADIRA') !== null && typeof console !== 'undefined';\n      // eslint-disable-next-line no-empty\n    } catch (e) { } // older browsers can sometimes throw because of getItem\n\n    if (!canLog) {\n      return;\n    }\n\n    if (message) {\n      message = `kadira:ntp ${message}`;\n      arguments[0] = message;\n    }\n\n    console.log(...arguments);\n  };\n}\n","import { WebApp } from 'meteor/webapp';\nlet path = Npm.require('path');\nlet fs = Npm.require('fs');\nlet logger = Npm.require('debug')('kadira:apm:sourcemaps');\n\n// Meteor 1.7 and older used clientPaths\nlet clientPaths = __meteor_bootstrap__.configJson.clientPaths;\nlet clientArchs = __meteor_bootstrap__.configJson.clientArchs;\nlet serverDir = __meteor_bootstrap__.serverDir;\nlet absClientPaths;\n\nif (clientArchs) {\n  absClientPaths = clientArchs.reduce((result, arch) => {\n    result[arch] = path.resolve(path.dirname(serverDir), arch);\n\n    return result;\n  }, {});\n} else {\n  absClientPaths = Object.keys(clientPaths).reduce((result, key) => {\n    result[key] = path.resolve(serverDir, path.dirname(clientPaths[key]));\n\n    return result;\n  }, {});\n}\n\nexport function handleApiResponse (body = {}) {\n  let unavailable = [];\n\n  if (typeof body === 'string') {\n    try {\n      body = JSON.parse(body);\n    } catch (e) {\n      logger('failed parsing body', e, body);\n      return;\n    }\n  }\n\n  let neededSourcemaps = body.neededSourcemaps || [];\n  logger('body', neededSourcemaps);\n\n  let promises = neededSourcemaps.map((sourcemap) => {\n    if (!Kadira.options.uploadSourceMaps) {\n      return unavailable.push(sourcemap);\n    }\n\n    return getSourcemapPath(sourcemap.arch, sourcemap.file.path)\n      .then(function (sourceMapPath) {\n        if (sourceMapPath === null) {\n          unavailable.push(sourcemap);\n        } else {\n          sendSourcemap(sourcemap, sourceMapPath);\n        }\n      });\n  });\n\n  Promise.all(promises).then(function () {\n    if (unavailable.length > 0) {\n      logger('sending unavailable sourcemaps', unavailable);\n      Kadira.coreApi.sendData({\n        unavailableSourcemaps: unavailable\n      })\n        .then(function (_body) {\n          handleApiResponse(_body);\n        })\n        .catch(function (err) {\n          console.log('Monti APM: unable to send data', err);\n        });\n    }\n  });\n}\n\nfunction sendSourcemap (sourcemap, sourcemapPath) {\n  logger('Sending sourcemap', sourcemap, sourcemapPath);\n\n  let stream = fs.createReadStream(sourcemapPath);\n\n  stream.on('error', (err) => {\n    console.log('Monti APM: error while uploading sourcemap', err);\n  });\n\n  let arch = sourcemap.arch;\n  let archVersion = sourcemap.archVersion;\n  let file = encodeURIComponent(sourcemap.file.path);\n\n  Kadira.coreApi.sendStream(`/sourcemap?arch=${arch}&archVersion=${archVersion}&file=${file}`, stream)\n    .catch(function (err) {\n      console.log('Monti APM: error uploading sourcemap', err);\n    });\n}\n\nfunction preparePath (urlPath) {\n  urlPath = path.posix.normalize(urlPath);\n\n  if (urlPath[0] === '/') {\n    urlPath = urlPath.slice(1);\n  }\n\n  return urlPath;\n}\n\nfunction checkForDynamicImport (arch, urlPath) {\n  const filePath = preparePath(urlPath);\n\n  return new Promise(function (resolve) {\n    const archPath = absClientPaths[arch];\n    const dynamicPath = `${path.join(archPath, 'dynamic', filePath)}.map`;\n\n    fs.stat(dynamicPath, function (err) {\n      resolve(err ? null : dynamicPath);\n    });\n  });\n}\n\nfunction getSourcemapPath (arch, urlPath) {\n  return new Promise((resolve, reject) => {\n    let clientProgram = WebApp.clientPrograms[arch];\n\n    if (!clientProgram || !clientProgram.manifest) {\n      return resolve(null);\n    }\n\n    let fileInfo = clientProgram.manifest.find((file) => file.url && file.url.startsWith(urlPath));\n\n    if (fileInfo && fileInfo.sourceMap) {\n      return resolve(path.join(\n        absClientPaths[arch],\n        fileInfo.sourceMap\n      ));\n    }\n\n    checkForDynamicImport(arch, urlPath).then(resolve).catch(reject);\n  });\n}\n","import { _ } from 'meteor/underscore';\nimport { TimeoutManager } from './hijack/timeout_manager';\n\nconst WAITON_MESSAGE_FIELDS = ['msg', 'id', 'method', 'name', 'waitTime'];\n\n// This is way how we can build waitTime and it's breakdown\nexport class WaitTimeBuilder {\n  constructor () {\n    this._waitListStore = {};\n    this._currentProcessingMessages = {};\n    this._messageCache = {};\n  }\n\n  register (session, msgId) {\n    const mainKey = this._getMessageKey(session.id, msgId);\n\n    let inQueue = session.inQueue || [];\n    if (typeof inQueue.toArray === 'function') {\n      // latest version of Meteor uses a double-ended-queue for the inQueue\n      // info: https://www.npmjs.com/package/double-ended-queue\n      inQueue = inQueue.toArray();\n    }\n\n    const waitList =\n      inQueue.map(msg => {\n        const key = this._getMessageKey(session.id, msg.id);\n\n        return this._getCacheMessage(key, msg);\n      }) || [];\n\n    // add currently processing ddp message if exists\n    const currentlyProcessingMessage =\n      this._currentProcessingMessages[session.id];\n    if (currentlyProcessingMessage) {\n      const key = this._getMessageKey(\n        session.id,\n        currentlyProcessingMessage.id\n      );\n      waitList.unshift(this._getCacheMessage(key, currentlyProcessingMessage));\n    }\n\n    this._waitListStore[mainKey] = waitList;\n  }\n\n  build (session, msgId) {\n    const mainKey = this._getMessageKey(session.id, msgId);\n    const waitList = this._waitListStore[mainKey] || [];\n    delete this._waitListStore[mainKey];\n\n    const filteredWaitList = waitList.map(this._cleanCacheMessage.bind(this));\n\n    return filteredWaitList;\n  }\n\n  _getMessageKey (sessionId, msgId) {\n    return `${sessionId}::${msgId}`;\n  }\n\n  _getCacheMessage (key, msg) {\n    let cachedMessage = this._messageCache[key];\n    if (!cachedMessage) {\n      this._messageCache[key] = cachedMessage = _.pick(\n        msg,\n        WAITON_MESSAGE_FIELDS\n      );\n      cachedMessage._key = key;\n      cachedMessage._registered = 1;\n    } else {\n      cachedMessage._registered++;\n    }\n\n    return cachedMessage;\n  }\n\n  _cleanCacheMessage (msg) {\n    msg._registered--;\n    if (msg._registered === 0) {\n      delete this._messageCache[msg._key];\n    }\n\n    // need to send a clean set of objects\n    // otherwise register can go with this\n    return _.pick(msg, WAITON_MESSAGE_FIELDS);\n  }\n\n  trackWaitTime (session, msg, unblock) {\n    const started = Date.now();\n    this._currentProcessingMessages[session.id] = msg;\n\n    let unblocked = false;\n    const self = this;\n\n    const wrappedUnblock = function () {\n      if (!unblocked) {\n        const waitTime = Date.now() - started;\n        const key = self._getMessageKey(session.id, msg.id);\n        const cachedMessage = self._messageCache[key];\n        if (cachedMessage) {\n          cachedMessage.waitTime = waitTime;\n        }\n        delete self._currentProcessingMessages[session.id];\n        unblocked = true;\n        unblock();\n\n        TimeoutManager.clearTimeout();\n      }\n    };\n\n    return wrappedUnblock;\n  }\n}\n","/* global LocalCollection */\n\nimport { Tracker } from 'meteor/tracker';\n\n// expose for testing purpose\nexport const OplogCheck = {};\n\nOplogCheck.env = function () {\n  if (!process.env.MONGO_OPLOG_URL) {\n    return {\n      code: 'NO_ENV',\n      reason: \"You haven't added oplog support for your the Meteor app.\",\n      solution: 'Add oplog support for your Meteor app. see: http://goo.gl/Co1jJc'\n    };\n  }\n  return true;\n};\n\nOplogCheck.disableOplog = function (cursorDescription) {\n  const { options } = cursorDescription;\n\n  // Underscored version for Meteor pre 1.2\n  if (options._disableOplog || options.disableOplog) {\n    return {\n      code: 'DISABLE_OPLOG',\n      reason: \"You've disabled oplog for this cursor explicitly with _disableOplog option.\"\n    };\n  }\n  return true;\n};\n\n// when creating Minimongo.Matcher object, if that's throws an exception\n// meteor won't do the oplog support\nOplogCheck.miniMongoMatcher = function (cursorDescription) {\n  if (Minimongo.Matcher) {\n    try {\n      // eslint-disable-next-line no-new\n      new Minimongo.Matcher(cursorDescription.selector);\n      return true;\n    } catch (ex) {\n      return {\n        code: 'MINIMONGO_MATCHER_ERROR',\n        reason: `There's something wrong in your mongo query: ${ex.message}`,\n        solution: 'Check your selector and change it accordingly.'\n      };\n    }\n  } else {\n    // If there is no Minimongo.Matcher, we don't need to check this\n    return true;\n  }\n};\n\nOplogCheck.miniMongoSorter = function (cursorDescription) {\n  let matcher = new Minimongo.Matcher(cursorDescription.selector);\n  if (Minimongo.Sorter && cursorDescription.options.sort) {\n    try {\n      // eslint-disable-next-line no-new\n      new Minimongo.Sorter(\n        cursorDescription.options.sort,\n        { matcher }\n      );\n      return true;\n    } catch (ex) {\n      return {\n        code: 'MINIMONGO_SORTER_ERROR',\n        reason: `Some of your sort specifiers are not supported: ${ex.message}`,\n        solution: 'Check your sort specifiers and chage them accordingly.'\n      };\n    }\n  } else {\n    return true;\n  }\n};\n\nOplogCheck.fields = function (cursorDescription) {\n  let options = cursorDescription.options;\n\n  // Checking `projection` for Meteor 2.6+\n  const fields = options.fields || options.projection;\n\n  if (fields) {\n    try {\n      LocalCollection._checkSupportedProjection(fields);\n      return true;\n    } catch (e) {\n      if (e.name === 'MinimongoError') {\n        return {\n          code: 'NOT_SUPPORTED_FIELDS',\n          reason: `Some of the field filters are not supported: ${e.message}`,\n          solution: 'Try removing those field filters.'\n        };\n      }\n      throw e;\n    }\n  }\n  return true;\n};\n\nOplogCheck.skip = function (cursorDescription) {\n  if (cursorDescription.options.skip) {\n    return {\n      code: 'SKIP_NOT_SUPPORTED',\n      reason: 'Skip does not support with oplog.',\n      solution: 'Try to avoid using skip. Use range queries instead: http://goo.gl/b522Av'\n    };\n  }\n\n  return true;\n};\n\nOplogCheck.where = function (cursorDescription) {\n  let matcher = new Minimongo.Matcher(cursorDescription.selector);\n  if (matcher.hasWhere()) {\n    return {\n      code: 'WHERE_NOT_SUPPORTED',\n      reason: 'Meteor does not support queries with $where.',\n      solution: 'Try to remove $where from your query. Use some alternative.'\n    };\n  }\n\n  return true;\n};\n\nOplogCheck.geo = function (cursorDescription) {\n  let matcher = new Minimongo.Matcher(cursorDescription.selector);\n\n  if (matcher.hasGeoQuery()) {\n    return {\n      code: 'GEO_NOT_SUPPORTED',\n      reason: 'Meteor does not support queries with geo partial operators.',\n      solution: 'Try to remove geo partial operators from your query if possible.'\n    };\n  }\n\n  return true;\n};\n\nOplogCheck.limitButNoSort = function (cursorDescription) {\n  let options = cursorDescription.options;\n\n  if (options.limit && !options.sort) {\n    return {\n      code: 'LIMIT_NO_SORT',\n      reason: 'Meteor oplog implementation does not support limit without a sort specifier.',\n      solution: 'Try adding a sort specifier.'\n    };\n  }\n\n  return true;\n};\n\nOplogCheck.thirdParty = function (cursorDescription, observerDriver) {\n  if (Tracker.active && observerDriver.constructor.name !== 'OplogObserveDriver') {\n    return {\n      code: 'TRACKER_ACTIVE',\n      reason: 'Observe driver detected inside an active tracker, you might be using a third party library (e.g \"reactive-mongo\").',\n      solution: 'Check the library documentation, perhaps an option is missing.'\n    };\n  }\n  return true;\n};\n\nOplogCheck.unknownReason = function (cursorDescription, driver) {\n  if (driver && driver.constructor.name !== 'OplogObserveDriver') {\n    return {\n      code: 'UNKNOWN_REASON',\n      reason: `Not using the Oplog Observe Driver for unknown reason. Driver: ${driver.constructor.name}`,\n      solution: 'Check your third-party libraries.'\n    };\n  }\n  return true;\n};\n\nlet preRunningMatchers = [\n  OplogCheck.env,\n  OplogCheck.disableOplog,\n  OplogCheck.miniMongoMatcher\n];\n\nlet globalMatchers = [\n  OplogCheck.fields,\n  OplogCheck.skip,\n  OplogCheck.where,\n  OplogCheck.geo,\n  OplogCheck.limitButNoSort,\n  OplogCheck.miniMongoSorter,\n  OplogCheck.thirdParty,\n  OplogCheck.unknownReason,\n];\n\nKadira.checkWhyNoOplog = function (cursorDescription, observerDriver) {\n  if (typeof Minimongo === 'undefined') {\n    return {\n      code: 'CANNOT_DETECT',\n      reason: \"You are running an older Meteor version and Monti APM can't check oplog state.\",\n      solution: 'Try updating your Meteor app'\n    };\n  }\n\n  let result = runMatchers(preRunningMatchers, cursorDescription, observerDriver);\n\n  if (result !== true) {\n    return result;\n  }\n\n  result = runMatchers(globalMatchers, cursorDescription, observerDriver);\n\n  if (result !== true) {\n    return result;\n  }\n\n  return {\n    code: 'OPLOG_SUPPORTED',\n    reason: \"This query should support oplog. It's weird if it's not.\",\n    solution: \"Please contact Kadira support and let's discuss.\"\n  };\n};\n\nfunction runMatchers (matcherList, cursorDescription, observerDriver) {\n  for (const matcher of matcherList) {\n    const matched = matcher(cursorDescription, observerDriver);\n\n    if (matched !== true) {\n      return matched;\n    }\n  }\n\n  return true;\n}\n","import { _ } from 'meteor/underscore';\nimport { objectHasData } from '../common/utils';\nimport { CreateUserStack, DefaultUniqueId } from '../utils';\nimport { Ntp } from '../ntp';\n\n\nlet eventLogger = Npm.require('debug')('kadira:tracer');\n\nlet REPETITIVE_EVENTS = {db: true, http: true, email: true, wait: true, async: true, custom: true, fs: true};\nlet TRACE_TYPES = ['sub', 'method', 'http'];\nlet MAX_TRACE_EVENTS = 1500;\n\n\nexport const Tracer = function () {\n  this._filters = [];\n  this._filterFields = ['password'];\n  this.maxArrayItemsToFilter = 20;\n};\n\n// In the future, we might wan't to track inner fiber events too.\n// Then we can't serialize the object with methods\n// That's why we use this method of returning the data\nTracer.prototype.start = function (name, type, {\n  sessionId,\n  msgId,\n  userId\n} = {}) {\n  // for backward compatibility\n  if (typeof name === 'object' && typeof type === 'object') {\n    let session = name;\n    let msg = type;\n    sessionId = session.id;\n    msgId = msg.id;\n    userId = session.userId;\n\n    if (msg.msg === 'method') {\n      type = 'method';\n      name = msg.method;\n    } else if (msg.msg === 'sub') {\n      type = 'sub';\n      name = msg.name;\n    } else {\n      return null;\n    }\n  }\n\n  if (TRACE_TYPES.indexOf(type) === -1) {\n    console.warn(`Monti APM: unknown trace type \"${type}\"`);\n    return null;\n  }\n\n  const traceInfo = {\n    _id: `${sessionId}::${msgId || DefaultUniqueId.get()}`,\n    type,\n    name,\n    session: sessionId,\n    id: msgId,\n    events: [],\n    userId,\n  };\n\n  return traceInfo;\n};\n\nTracer.prototype.event = function (traceInfo, type, data, metaData) {\n  // do not allow to proceed, if already completed or errored\n  let lastEvent = this.getLastEvent(traceInfo);\n\n  if (\n    // trace completed but has not been processed\n    lastEvent &&\n    ['complete', 'error'].indexOf(lastEvent.type) >= 0 ||\n    // trace completed and processed.\n    traceInfo.isEventsProcessed\n  ) {\n    return false;\n  }\n\n  let event = {\n    type,\n    at: Ntp._now(),\n    endAt: null,\n    nested: [],\n  };\n\n  // special handling for events that are not repetitive\n  if (!REPETITIVE_EVENTS[type]) {\n    event.endAt = event.at;\n  }\n\n  if (data) {\n    let info = _.pick(traceInfo, 'type', 'name');\n    event.data = this._applyFilters(type, data, info, 'start');\n  }\n\n  if (metaData && metaData.name) {\n    event.name = metaData.name;\n  }\n\n  if (Kadira.options.eventStackTrace) {\n    event.stack = CreateUserStack();\n  }\n\n  eventLogger('%s %s', type, traceInfo._id);\n\n  if (lastEvent && !lastEvent.endAt) {\n    if (!lastEvent.nested) {\n      console.error('Monti: invalid trace. Please share the trace below at');\n      console.error('Monti: https://github.com/monti-apm/monti-apm-agent/issues/14');\n      console.dir(traceInfo, { depth: 10 });\n    }\n    let lastNested = lastEvent.nested[lastEvent.nested.length - 1];\n\n    // Only nest one level\n    if (!lastNested || lastNested.endAt) {\n      lastEvent.nested.push(event);\n      return event;\n    }\n\n    return false;\n  }\n\n  traceInfo.events.push(event);\n\n  return event;\n};\n\nTracer.prototype.eventEnd = function (traceInfo, event, data) {\n  if (event.endAt) {\n    // Event already ended or is not a repititive event\n    return false;\n  }\n\n  event.endAt = Ntp._now();\n\n  if (data) {\n    let info = _.pick(traceInfo, 'type', 'name');\n    event.data = Object.assign(\n      event.data || {},\n      this._applyFilters(`${event.type}end`, data, info, 'end')\n    );\n  }\n  eventLogger('%s %s', `${event.type}end`, traceInfo._id);\n\n  return true;\n};\n\nTracer.prototype.getLastEvent = function (traceInfo) {\n  return traceInfo.events[traceInfo.events.length - 1];\n};\n\nTracer.prototype.endLastEvent = function (traceInfo) {\n  let lastEvent = this.getLastEvent(traceInfo);\n\n  if (!lastEvent.endAt) {\n    this.eventEnd(traceInfo, lastEvent);\n    lastEvent.forcedEnd = true;\n    return true;\n  }\n  return false;\n};\n\n// Most of the time, all the nested events are async\n// which is not helpful. This returns true if\n// there are nested events other than async.\nTracer.prototype._hasUsefulNested = function (event) {\n  return event.nested &&\n    event.nested.length &&\n    !event.nested.every(e => e.type === 'async');\n};\n\nTracer.prototype.buildEvent = function (event, depth = 0, trace) {\n  let elapsedTimeForEvent = event.endAt - event.at;\n  let builtEvent = [event.type];\n  let nested = [];\n\n  builtEvent.push(elapsedTimeForEvent);\n  builtEvent.push(event.data || {});\n\n  if (this._hasUsefulNested(event)) {\n    let prevEnd = event.at;\n    for (let i = 0; i < event.nested.length; i++) {\n      let nestedEvent = event.nested[i];\n      if (!nestedEvent.endAt) {\n        this.eventEnd(trace, nestedEvent);\n        nestedEvent.forcedEnd = true;\n      }\n\n      let computeTime = nestedEvent.at - prevEnd;\n      if (computeTime > 0) {\n        nested.push(['compute', computeTime]);\n      }\n\n      nested.push(this.buildEvent(nestedEvent, depth + 1, trace));\n      prevEnd = nestedEvent.endAt;\n    }\n  }\n\n\n  if (\n    nested.length ||\n    event.stack ||\n    event.forcedEnd ||\n    event.name\n  ) {\n    builtEvent.push({\n      stack: event.stack,\n      nested: nested.length ? nested : undefined,\n      forcedEnd: event.forcedEnd,\n      name: event.name\n    });\n  }\n\n  return builtEvent;\n};\n\nTracer.prototype.buildTrace = function (traceInfo) {\n  let firstEvent = traceInfo.events[0];\n  let lastEvent = traceInfo.events[traceInfo.events.length - 1];\n  let processedEvents = [];\n\n  if (firstEvent.type !== 'start') {\n    console.warn('Monti APM: trace has not started yet');\n    return null;\n  } else if (lastEvent.type !== 'complete' && lastEvent.type !== 'error') {\n    // trace is not completed or errored yet\n    console.warn('Monti APM: trace has not completed or errored yet');\n    return null;\n  }\n  // build the metrics\n  traceInfo.errored = lastEvent.type === 'error';\n  traceInfo.at = firstEvent.at;\n\n  let metrics = {\n    total: lastEvent.at - firstEvent.at,\n  };\n\n  let totalNonCompute = 0;\n\n  firstEvent = ['start', 0];\n  if (traceInfo.events[0].data) {\n    firstEvent.push(traceInfo.events[0].data);\n  }\n  processedEvents.push(firstEvent);\n\n  let computeTime;\n\n  for (let lc = 1; lc < traceInfo.events.length - 1; lc += 1) {\n    let prevEvent = traceInfo.events[lc - 1];\n    let event = traceInfo.events[lc];\n\n    if (!event.endAt) {\n      console.error('Monti APM: no end event for type: ', event.type);\n      return null;\n    }\n\n    computeTime = event.at - prevEvent.endAt;\n    if (computeTime > 0) {\n      processedEvents.push(['compute', computeTime]);\n    }\n    let builtEvent = this.buildEvent(event, 0, traceInfo);\n    processedEvents.push(builtEvent);\n\n    metrics[event.type] = metrics[event.type] || 0;\n    metrics[event.type] += builtEvent[1];\n    totalNonCompute += builtEvent[1];\n  }\n\n\n  computeTime = lastEvent.at - traceInfo.events[traceInfo.events.length - 2].endAt;\n\n  if (computeTime > 0) {\n    processedEvents.push(['compute', computeTime]);\n  }\n\n  let lastEventData = [lastEvent.type, 0];\n  if (lastEvent.data) {\n    lastEventData.push(lastEvent.data);\n  }\n  processedEvents.push(lastEventData);\n\n  if (processedEvents.length > MAX_TRACE_EVENTS) {\n    const removeCount = processedEvents.length - MAX_TRACE_EVENTS;\n    processedEvents.splice(MAX_TRACE_EVENTS, removeCount);\n  }\n\n  metrics.compute = metrics.total - totalNonCompute;\n  traceInfo.metrics = metrics;\n  traceInfo.events = processedEvents;\n  traceInfo.isEventsProcessed = true;\n  return traceInfo;\n};\n\n/**\n * There are two formats for traces. While the method/publication is running, the trace is in the object format.\n * This is easier to work with, but takes more space to store. After the trace is complete (either finished or errored),\n * it is built which among other things converts the events to the array format.\n *\n * The key difference of `optimizeEvent` and `optimizeEvents` is that they do not mutate the original events.\n *\n * @param {Object} objectEvent Expanded object event.\n *\n * @returns {Array} Array notation of the event optimized for transport\n */\nTracer.prototype.optimizeEvent = function (objectEvent) {\n  let {at, endAt, stack, nested = [], forcedEnd, name, type, data} = objectEvent;\n\n  if (!endAt) {\n    endAt = Ntp._now();\n    forcedEnd = true;\n  }\n\n  let duration = at && endAt ? endAt - at : 0;\n\n  const optimizedNestedEvents = this._hasUsefulNested(objectEvent) ? this.optimizeEvents(nested) : undefined;\n\n  const optimizedEvent = [type, duration, data || {}];\n\n  const extraInfo = {\n    stack,\n    forcedEnd,\n    name,\n    nested: optimizedNestedEvents\n  };\n\n  if (objectHasData(extraInfo)) {\n    optimizedEvent.push(extraInfo);\n  }\n\n  return optimizedEvent;\n};\n\nTracer.prototype.optimizeEvents = function (events) {\n  if (!events) {\n    return [];\n  }\n\n  const optimizedEvents = [];\n\n  let prevEvent = {};\n\n  events.forEach((event) => {\n    if (prevEvent.endAt && event.at) {\n      const computeTime = event.at - prevEvent.endAt;\n\n      if (computeTime > 0) {\n        optimizedEvents.push(['compute', computeTime]);\n      }\n    }\n\n    optimizedEvents.push(this.optimizeEvent(event));\n\n    prevEvent = event;\n  });\n\n  return optimizedEvents;\n};\n\nTracer.prototype.addFilter = function (filterFn) {\n  this._filters.push(filterFn);\n};\n\nTracer.prototype.redactField = function (field) {\n  this._filterFields.push(field);\n};\n\nTracer.prototype._applyFilters = function (eventType, data, info) {\n  this._filters.forEach(function (filterFn) {\n    data = filterFn(eventType, _.clone(data), info);\n  });\n\n  return data;\n};\n\nTracer.prototype._applyObjectFilters = function (toFilter) {\n  const filterObject = (obj) => {\n    let cloned;\n    this._filterFields.forEach(function (field) {\n      if (field in obj) {\n        cloned = cloned || Object.assign({}, obj);\n        cloned[field] = 'Monti: redacted';\n      }\n    });\n\n    return cloned;\n  };\n\n  if (Array.isArray(toFilter)) {\n    let cloned;\n    // There could be thousands or more items in the array, and this usually runs\n    // before the data is validated. For performance reasons we limit how\n    // many to check\n    let length = Math.min(toFilter.length, this.maxArrayItemsToFilter);\n    for (let i = 0; i < length; i++) {\n      if (typeof toFilter[i] === 'object' && toFilter[i] !== null) {\n        let result = filterObject(toFilter[i]);\n        if (result) {\n          cloned = cloned || [...toFilter];\n          cloned[i] = result;\n        }\n      }\n    }\n\n    return cloned || toFilter;\n  }\n\n  return filterObject(toFilter) || toFilter;\n};\n\nKadira.tracer = new Tracer();\n// need to expose Tracer to provide default set of filters\nKadira.Tracer = Tracer;\n","import { Tracer } from './tracer';\n\n// strip sensitive data sent to Monti APM engine.\n// possible to limit types by providing an array of types to strip\n// possible types are: \"start\", \"db\", \"http\", \"email\"\nTracer.stripSensitive = function stripSensitive (typesToStrip, receiverType, name) {\n  typesToStrip = typesToStrip || [];\n\n  let strippedTypes = {};\n  typesToStrip.forEach(function (type) {\n    strippedTypes[type] = true;\n  });\n\n  return function (type, data, info) {\n    if (typesToStrip.length > 0 && !strippedTypes[type]) {\n      return data;\n    }\n\n    if (receiverType && receiverType !== info.type) {\n      return data;\n    }\n\n    if (name && name !== info.name) {\n      return data;\n    }\n\n    if (type === 'start') {\n      if (data.params) {\n        data.params = '[stripped]';\n      }\n      if (data.headers) {\n        data.headers = '[stripped]';\n      }\n      if (data.body) {\n        data.body = '[stripped]';\n      }\n    } else if (type === 'db') {\n      data.selector = '[stripped]';\n    } else if (type === 'http') {\n      data.url = '[stripped]';\n    } else if (type === 'email') {\n      ['from', 'to', 'cc', 'bcc', 'replyTo'].forEach(function (item) {\n        if (data[item]) {\n          data[item] = '[stripped]';\n        }\n      });\n    }\n\n    return data;\n  };\n};\n\n// Strip sensitive data sent to Monti APM engine.\n// In contrast to stripSensitive, this one has an allow list of what to keep\n// to guard against forgetting to strip new fields\n// In the future this one might replace Tracer.stripSensitive\n// options\nTracer.stripSensitiveThorough = function stripSensitive () {\n  return function (type, data) {\n    let fieldsToKeep = [];\n\n    if (type === 'start') {\n      fieldsToKeep = ['userId'];\n    } else if (type === 'waitend') {\n      fieldsToKeep = ['waitOn'];\n    } else if (type === 'db') {\n      fieldsToKeep = [\n        'coll', 'func', 'cursor', 'limit', 'docsFetched', 'docSize', 'oplog',\n        'fields', 'projection', 'wasMultiplexerReady', 'queueLength', 'elapsedPollingTime',\n        'noOfCachedDocs'\n      ];\n    } else if (type === 'http') {\n      fieldsToKeep = ['method', 'statusCode'];\n    } else if (type === 'email') {\n      fieldsToKeep = [];\n    } else if (type === 'custom') {\n      // This is supplied by the user so we assume they are only giving data that can be sent\n      fieldsToKeep = Object.keys(data);\n    } else if (type === 'error') {\n      fieldsToKeep = ['error'];\n    }\n\n    Object.keys(data).forEach(key => {\n      if (fieldsToKeep.indexOf(key) === -1) {\n        data[key] = '[stripped]';\n      }\n    });\n\n    return data;\n  };\n};\n\n// strip selectors only from the given list of collection names\nTracer.stripSelectors = function stripSelectors (collectionList, receiverType, name) {\n  collectionList = collectionList || [];\n\n  let collMap = {};\n  collectionList.forEach(function (collName) {\n    collMap[collName] = true;\n  });\n\n  return function (type, data, info) {\n    if (type !== 'db' || (data && !collMap[data.coll])) {\n      return data;\n    }\n\n    if (receiverType && receiverType !== info.type) {\n      return data;\n    }\n\n    if (name && name !== info.name) {\n      return data;\n    }\n\n    data.selector = '[stripped]';\n    return data;\n  };\n};\n","import { _ } from 'meteor/underscore';\nimport { EJSON } from 'meteor/ejson';\nlet logger = Npm.require('debug')('kadira:ts');\n\nexport function TracerStore (options) {\n  options = options || {};\n\n  this.maxTotalPoints = options.maxTotalPoints || 30;\n  this.interval = options.interval || 1000 * 60;\n  this.archiveEvery = options.archiveEvery || this.maxTotalPoints / 6;\n\n  // store max total on the past 30 minutes (or past 30 items)\n  this.maxTotals = Object.create(null);\n  // store the max trace of the current interval\n  this.currentMaxTrace = Object.create(null);\n  // archive for the traces\n  this.traceArchive = [];\n\n  this.processedCnt = Object.create(null);\n\n  // group errors by messages between an interval\n  this.errorMap = Object.create(null);\n}\n\nTracerStore.prototype.addTrace = function (trace) {\n  let kind = [trace.type, trace.name].join('::');\n  if (!this.currentMaxTrace[kind]) {\n    this.currentMaxTrace[kind] = EJSON.clone(trace);\n  } else if (this.currentMaxTrace[kind].metrics.total < trace.metrics.total) {\n    this.currentMaxTrace[kind] = EJSON.clone(trace);\n  } else if (trace.errored) {\n    this._handleErrors(trace);\n  }\n};\n\nTracerStore.prototype.collectTraces = function () {\n  let traces = this.traceArchive;\n  this.traceArchive = [];\n\n  // convert at(timestamp) into the actual serverTime\n  traces.forEach(function (trace) {\n    trace.at = Kadira.syncedDate.syncTime(trace.at);\n  });\n  return traces;\n};\n\nTracerStore.prototype.start = function () {\n  this._timeoutHandler = setInterval(this.processTraces.bind(this), this.interval);\n};\n\nTracerStore.prototype.stop = function () {\n  if (this._timeoutHandler) {\n    clearInterval(this._timeoutHandler);\n  }\n};\n\nTracerStore.prototype._handleErrors = function (trace) {\n  // sending error requests as it is\n  let lastEvent = trace.events[trace.events.length - 1];\n  if (lastEvent && lastEvent[2]) {\n    let error = lastEvent[2].error;\n\n    // grouping errors occured (reset after processTraces)\n    let errorKey = [trace.type, trace.name, error.message].join('::');\n    if (!this.errorMap[errorKey]) {\n      let erroredTrace = EJSON.clone(trace);\n      this.errorMap[errorKey] = erroredTrace;\n\n      this.traceArchive.push(erroredTrace);\n    }\n  } else {\n    logger('last events is not an error: ', JSON.stringify(trace.events));\n  }\n};\n\nTracerStore.prototype.processTraces = function () {\n  let self = this;\n\n  let kinds = new Set();\n  Object.keys(this.maxTotals).forEach(key => {\n    kinds.add(key);\n  });\n  Object.keys(this.currentMaxTrace).forEach(key => {\n    kinds.add(key);\n  });\n\n  for (const kind of kinds) {\n    self.processedCnt[kind] = self.processedCnt[kind] || 0;\n    let currentMaxTrace = self.currentMaxTrace[kind];\n    let currentMaxTotal = currentMaxTrace ? currentMaxTrace.metrics.total : 0;\n\n    self.maxTotals[kind] = self.maxTotals[kind] || [];\n    // add the current maxPoint\n    self.maxTotals[kind].push(currentMaxTotal);\n    let exceedingPoints = self.maxTotals[kind].length - self.maxTotalPoints;\n    if (exceedingPoints > 0) {\n      self.maxTotals[kind].splice(0, exceedingPoints);\n    }\n\n    let archiveDefault = (self.processedCnt[kind] % self.archiveEvery) === 0;\n    self.processedCnt[kind]++;\n\n    let canArchive = archiveDefault ||\n      self._isTraceOutlier(kind, currentMaxTrace);\n\n    if (canArchive && currentMaxTrace) {\n      self.traceArchive.push(currentMaxTrace);\n    }\n\n    // reset currentMaxTrace\n    self.currentMaxTrace[kind] = null;\n  }\n\n  // reset the errorMap\n  self.errorMap = Object.create(null);\n};\n\nTracerStore.prototype._isTraceOutlier = function (kind, trace) {\n  if (trace) {\n    let dataSet = this.maxTotals[kind];\n    return this._isOutlier(dataSet, trace.metrics.total, 3);\n  }\n  return false;\n};\n\n/*\n  Data point must exists in the dataSet\n*/\nTracerStore.prototype._isOutlier = function (dataSet, dataPoint, maxMadZ) {\n  let median = this._getMedian(dataSet);\n  let mad = this._calculateMad(dataSet, median);\n  let madZ = this._funcMedianDeviation(median)(dataPoint) / mad;\n\n  return madZ > maxMadZ;\n};\n\nTracerStore.prototype._getMedian = function (dataSet) {\n  let sortedDataSet = _.clone(dataSet).sort(function (a, b) {\n    return a - b;\n  });\n  return this._pickQuartile(sortedDataSet, 2);\n};\n\nTracerStore.prototype._pickQuartile = function (dataSet, num) {\n  let pos = ((dataSet.length + 1) * num) / 4;\n  if (pos % 1 === 0) {\n    return dataSet[pos - 1];\n  }\n  pos -= pos % 1;\n  return (dataSet[pos - 1] + dataSet[pos]) / 2;\n};\n\nTracerStore.prototype._calculateMad = function (dataSet, median) {\n  let medianDeviations = _.map(dataSet, this._funcMedianDeviation(median));\n  let mad = this._getMedian(medianDeviations);\n\n  return mad;\n};\n\nTracerStore.prototype._funcMedianDeviation = function (median) {\n  return function (x) {\n    return Math.abs(median - x);\n  };\n};\n\nTracerStore.prototype._getMean = function (dataPoints) {\n  if (dataPoints.length > 0) {\n    let total = 0;\n    dataPoints.forEach(function (point) {\n      total += point;\n    });\n    return total / dataPoints.length;\n  }\n  return 0;\n};\n","let LRU = Npm.require('lru-cache');\nlet jsonStringify = Npm.require('json-stringify-safe');\n\nexport const DocSzCache = function (maxItems, maxValues) {\n  this.items = new LRU({max: maxItems});\n  this.maxValues = maxValues;\n  this.cpuUsage = 0;\n};\n\n// This is called from SystemModel.prototype.cpuUsage and saves cpu usage.\nDocSzCache.prototype.setPcpu = function (pcpu) {\n  this.cpuUsage = pcpu;\n};\n\nDocSzCache.prototype.getSize = function (coll, query, opts, data) {\n  // If the dataset is null or empty we can't calculate the size\n  // Do not process this data and return 0 as the document size.\n  if (!(data && (data.length || (typeof data.size === 'function' && data.size())))) {\n    return 0;\n  }\n\n  let key = this.getKey(coll, query, opts);\n  let item = this.items.get(key);\n\n  if (!item) {\n    item = new DocSzCacheItem(this.maxValues);\n    this.items.set(key, item);\n  }\n\n  if (this.needsUpdate(item)) {\n    let doc = {};\n    if (typeof data.get === 'function') {\n      // This is an IdMap\n      data.forEach(function (element) {\n        doc = element;\n        return false; // return false to stop loop. We only need one doc.\n      });\n    } else {\n      doc = data[0];\n    }\n    let size = Buffer.byteLength(jsonStringify(doc), 'utf8');\n    item.addData(size);\n  }\n\n  return item.getValue();\n};\n\nDocSzCache.prototype.getKey = function (coll, query, opts) {\n  return jsonStringify([coll, query, opts]);\n};\n\n// returns a score between 0 and 1 for a cache item\n// this score is determined by:\n//  * available cache item slots\n//  * time since last updated\n//  * cpu usage of the application\nDocSzCache.prototype.getItemScore = function (item) {\n  return [\n    (item.maxValues - item.values.length) / item.maxValues,\n    (Date.now() - item.updated) / 60000,\n    (100 - this.cpuUsage) / 100,\n  ].map(function (score) {\n    return score > 1 ? 1 : score;\n  }).reduce(function (total, score) {\n    return (total || 0) + score;\n  }) / 3;\n};\n\nDocSzCache.prototype.needsUpdate = function (item) {\n  // handle newly made items\n  if (!item.values.length) {\n    return true;\n  }\n\n  let currentTime = Date.now();\n  let timeSinceUpdate = currentTime - item.updated;\n  if (timeSinceUpdate > 1000 * 60) {\n    return true;\n  }\n\n  return this.getItemScore(item) > 0.5;\n};\n\n\nexport const DocSzCacheItem = function (maxValues) {\n  this.maxValues = maxValues;\n  this.updated = 0;\n  this.values = [];\n};\n\nDocSzCacheItem.prototype.addData = function (value) {\n  this.values.push(value);\n  this.updated = Date.now();\n\n  if (this.values.length > this.maxValues) {\n    this.values.shift();\n  }\n};\n\nDocSzCacheItem.prototype.getValue = function () {\n  function sortNumber (a, b) {\n    return a - b;\n  }\n  let sorted = this.values.sort(sortNumber);\n  let median = 0;\n  let idx;\n\n  if (sorted.length % 2 === 0) {\n    idx = sorted.length / 2;\n    median = (sorted[idx] + sorted[idx - 1]) / 2;\n  } else {\n    idx = Math.floor(sorted.length / 2);\n    median = sorted[idx];\n  }\n\n  return median;\n};\n","/* global MontiProfiler */\n\nimport { Meteor } from 'meteor/meteor';\nimport { Random } from 'meteor/random';\nimport { _ } from 'meteor/underscore';\nimport { ErrorModel } from './models/errors';\nimport { HttpModel } from './models/http';\nimport { MethodsModel } from './models/methods';\nimport { PubsubModel } from './models/pubsub';\nimport { SystemModel } from './models/system';\nimport packageMap from './.meteor-package-versions';\nimport { getErrorParameters } from './common/utils';\nimport { WaitTimeBuilder } from './wait_time_builder';\nimport { DocSzCache } from './docsize_cache';\nimport { Ntp } from './ntp';\nimport { getClientVersions } from './utils';\nimport { handleApiResponse } from './sourcemaps';\nimport { TrackMeteorDebug, TrackUncaughtExceptions, TrackUnhandledRejections } from './hijack/error';\n\nconst hostname = Npm.require('os').hostname();\nconst logger = Npm.require('debug')('kadira:apm');\nconst Fibers = Npm.require('fibers');\nconst KadiraCore = Npm.require('monti-apm-core').Kadira;\n\nconst DEBUG_PAYLOAD_SIZE = process.env.MONTI_DEBUG_PAYLOAD_SIZE === 'true';\n\nKadira.models = {};\nKadira.options = {};\nKadira.env = {\n  currentSub: null, // keep current subscription inside ddp\n  kadiraInfo: new Meteor.EnvironmentVariable(),\n};\nKadira.waitTimeBuilder = new WaitTimeBuilder();\nKadira.errors = [];\nKadira.errors.addFilter = Kadira.errors.push.bind(Kadira.errors);\n\nKadira.models.methods = new MethodsModel();\nKadira.models.pubsub = new PubsubModel();\nKadira.models.system = new SystemModel();\nKadira.models.http = new HttpModel();\nKadira.docSzCache = new DocSzCache(100000, 10);\nKadira.syncedDate = new Ntp();\n\n// If the agent is not connected, we still want to build the payload occasionally\n// since building the payload does some cleanup to prevent memory leaks\n// Once connected, this interval is cleared\nlet buildInterval = Meteor.setInterval(() => {\n  Kadira._buildPayload();\n}, 1000 * 60);\n\n\nKadira.connect = function (appId, appSecret, options) {\n  if (Kadira.connected) {\n    console.log('Monti APM: Already Connected');\n    return;\n  }\n\n  options = options || {};\n  options.appId = appId;\n  options.appSecret = appSecret;\n  options.payloadTimeout = options.payloadTimeout || 1000 * 20;\n  options.endpoint = options.endpoint || 'https://engine.montiapm.com';\n  options.clientEngineSyncDelay = options.clientEngineSyncDelay || 10000;\n  options.thresholds = options.thresholds || {};\n  options.isHostNameSet = !!options.hostname;\n  options.hostname = options.hostname || hostname;\n  options.proxy = options.proxy || null;\n  options.recordIPAddress = options.recordIPAddress || 'full';\n  options.eventStackTrace = options.eventStackTrace || false;\n  options.stalledTimeout = options.stalledTimeout || 1000 * 60 * 30;\n  options.disableClientErrorTracking = options.disableClientErrorTracking || false;\n\n  if (options.documentSizeCacheSize) {\n    Kadira.docSzCache = new DocSzCache(options.documentSizeCacheSize, 10);\n  }\n\n  // remove trailing slash from endpoint url (if any)\n  if (_.last(options.endpoint) === '/') {\n    options.endpoint = options.endpoint.substr(0, options.endpoint.length - 1);\n  }\n\n  // error tracking is enabled by default\n  if (options.enableErrorTracking === undefined) {\n    options.enableErrorTracking = true;\n  }\n\n  // uploading sourcemaps is enabled by default in production\n  if (options.uploadSourceMaps === undefined && Meteor.isProduction) {\n    options.uploadSourceMaps = true;\n  }\n\n  Kadira.options = options;\n  Kadira.options.authHeaders = {\n    'KADIRA-APP-ID': Kadira.options.appId,\n    'KADIRA-APP-SECRET': Kadira.options.appSecret\n  };\n\n  if (appId && appSecret) {\n    options.appId = options.appId.trim();\n    options.appSecret = options.appSecret.trim();\n\n    Kadira.coreApi = new KadiraCore({\n      appId: options.appId,\n      appSecret: options.appSecret,\n      endpoint: options.endpoint,\n      hostname: options.hostname,\n      agentVersion: packageMap['montiapm:agent'] || '<unknown>'\n    });\n\n    Kadira.coreApi._headers['METEOR-RELEASE'] = Meteor.release.replace('METEOR@', '');\n\n    Kadira.coreApi._checkAuth()\n      .then(function () {\n        logger('connected to app: ', appId);\n        console.log('Monti APM: Connected');\n        Kadira._sendAppStats();\n        Kadira._schedulePayloadSend();\n      })\n      .catch(function (err) {\n        if (err.message === 'Unauthorized') {\n          console.log('Monti APM: Authentication failed, check your \"appId\" & \"appSecret\"');\n        } else {\n          console.log(`Monti APM: Unable to connect. ${err.message}`);\n        }\n      });\n  } else {\n    throw new Error('Monti APM: required appId and appSecret');\n  }\n\n  Kadira.syncedDate = new Ntp(options);\n  Kadira.syncedDate.sync();\n  Kadira.models.error = new ErrorModel(appId);\n\n  // handle pre-added filters\n  let addFilterFn = Kadira.models.error.addFilter.bind(Kadira.models.error);\n  Kadira.errors.forEach(addFilterFn);\n  Kadira.errors = Kadira.models.error;\n\n  // setting runtime info, which will be sent to kadira\n  __meteor_runtime_config__.kadira = {\n    appId,\n    endpoint: options.endpoint,\n    clientEngineSyncDelay: options.clientEngineSyncDelay,\n    recordIPAddress: options.recordIPAddress,\n    disableNtp: options.disableNtp,\n    disableClientErrorTracking: options.disableClientErrorTracking,\n  };\n\n  if (options.enableErrorTracking) {\n    Kadira.enableErrorTracking();\n  } else {\n    Kadira.disableErrorTracking();\n  }\n\n  // start tracking errors\n  Meteor.startup(function () {\n    TrackUncaughtExceptions();\n    TrackUnhandledRejections();\n    TrackMeteorDebug();\n  });\n\n  Meteor.publish(null, function () {\n    let _options = __meteor_runtime_config__.kadira;\n    this.added('kadira_settings', Random.id(), _options);\n    this.ready();\n  });\n\n  // notify we've connected\n  Kadira.connected = true;\n};\n\n// track how many times we've sent the data (once per minute)\nKadira._buildPayload = function () {\n  let payload = {host: Kadira.options.hostname, clientVersions: getClientVersions()};\n  let buildDetailedInfo = Kadira._isDetailedInfo();\n  _.extend(payload, Kadira.models.methods.buildPayload(buildDetailedInfo));\n  _.extend(payload, Kadira.models.pubsub.buildPayload(buildDetailedInfo));\n  _.extend(payload, Kadira.models.system.buildPayload());\n  _.extend(payload, Kadira.models.http.buildPayload());\n\n  if (Kadira.options.enableErrorTracking) {\n    _.extend(payload, Kadira.models.error.buildPayload());\n  }\n\n  return payload;\n};\n\nKadira._countDataSent = 0;\nKadira._detailInfoSentInterval = Math.ceil((1000 * 60) / Kadira.options.payloadTimeout);\nKadira._isDetailedInfo = function () {\n  return (Kadira._countDataSent++ % Kadira._detailInfoSentInterval) === 0;\n};\n\nKadira._sendAppStats = function () {\n  let appStats = {};\n  appStats.release = Meteor.release;\n  appStats.protocolVersion = '1.0.0';\n  appStats.packageVersions = [];\n  appStats.clientVersions = getClientVersions();\n\n  _.each(Package, function (v, name) {\n    appStats.packageVersions.push({\n      name,\n      version: packageMap[name] || null\n    });\n  });\n\n  Kadira.coreApi.sendData({\n    startTime: new Date(),\n    appStats\n  }).then(function (body) {\n    handleApiResponse(body);\n  }).catch(function (err) {\n    console.error('Monti APM Error on sending appStats:', err.message);\n  });\n};\n\nKadira._schedulePayloadSend = function () {\n  clearInterval(buildInterval);\n\n  setTimeout(function () {\n    Kadira._schedulePayloadSend();\n    Kadira._sendPayload();\n  }, Kadira.options.payloadTimeout);\n};\n\nfunction logPayload (payload) {\n  let traceCount = payload.methodRequests.length +\n    payload.pubRequests.length + payload.httpRequests.length +\n    payload.errors.length;\n  let largestTrace = {\n    size: 0,\n    content: ''\n  };\n\n  // eslint-disable-next-line no-inner-declarations\n  function countBreakdowns (breakdowns, field) {\n    let result = 0;\n    breakdowns.forEach(entry => {\n      result += Object.keys(entry[field]).length;\n    });\n\n    return result;\n  }\n\n  // eslint-disable-next-line no-inner-declarations\n  function sizeTraces (traces) {\n    let histogram = Object.create(null);\n    let total = 0;\n    traces.forEach(trace => {\n      const stringified = JSON.stringify(trace);\n      let length = stringified.length;\n      total += length;\n\n      if (length > largestTrace.size) {\n        largestTrace = { size: length, content: stringified };\n      }\n\n      let normalized = length - (length % 500);\n      histogram[normalized] = histogram[normalized] || 0;\n      histogram[normalized] += 1;\n    });\n\n    histogram.total = total;\n\n    return Object.entries(histogram).map(([k, v]) => `${k}: ${v}`).join(', ');\n  }\n\n  console.log('------- APM Payload Metrics -------');\n  console.log(`methods: ${countBreakdowns(payload.methodMetrics, 'methods')}`);\n  console.log(`pubs: ${countBreakdowns(payload.pubMetrics, 'pubs')}`);\n  console.log(`routes: ${countBreakdowns(payload.httpMetrics, 'routes')}`);\n  console.log(`errors: ${payload.errors.length}`);\n  console.log(`traces: ${traceCount}`);\n  console.log('Method trace sizes:', sizeTraces(payload.methodRequests));\n  console.log('Pub trace sizes:', sizeTraces(payload.pubRequests));\n  console.log('HTTP trace sizes:', sizeTraces(payload.httpRequests));\n  console.log('Error trace sizes:', sizeTraces(payload.errors));\n  console.log('Largest trace:', largestTrace);\n  console.log('------- ------------------- -------');\n}\n\nKadira._sendPayload = function () {\n  new Fibers(function () {\n    let payload = Kadira._buildPayload();\n\n    if (DEBUG_PAYLOAD_SIZE) {\n      logPayload(payload);\n    }\n\n    function send () {\n      return Kadira.coreApi.sendData(payload)\n        .then(function (body) {\n          handleApiResponse(body);\n        });\n    }\n\n    function logErr (err) {\n      console.log('Monti APM Error:', 'while sending payload to Monti APM:', err.message);\n    }\n\n    send()\n      .catch(function (err) {\n        // Likely is RangeError: Invalid string length\n        // This probably means we are close to running out of memory.\n        if (err instanceof RangeError) {\n          console.log('Monti APM: payload was too large to send to Monti APM. Resending without traces');\n          payload.methodRequests = undefined;\n          payload.httpRequests = undefined;\n          payload.pubRequests = undefined;\n          send()\n            .catch(logErr);\n        } else {\n          logErr(err);\n        }\n      });\n  }).run();\n};\n\n// this return the __kadiraInfo from the current Fiber by default\n// if called with 2nd argument as true, it will get the kadira info from\n// Meteor.EnvironmentVariable\n//\n// WARNNING: returned info object is the reference object.\n//  Changing it might cause issues when building traces. So use with care\nKadira._getInfo = function (currentFiber, useEnvironmentVariable) {\n  currentFiber = currentFiber || Fibers.current;\n  if (currentFiber) {\n    if (useEnvironmentVariable) {\n      return Kadira.env.kadiraInfo.get();\n    }\n    return currentFiber.__kadiraInfo;\n  }\n};\n\n// this does not clone the info object. So, use with care\nKadira._setInfo = function (info) {\n  Fibers.current.__kadiraInfo = info;\n};\n\nKadira.startContinuousProfiling = function () {\n  MontiProfiler.startContinuous(function onProfile ({ profile, startTime, endTime }) {\n    if (!Kadira.connected) {\n      return;\n    }\n\n    Kadira.coreApi.sendData({ profiles: [{profile, startTime, endTime }]})\n      .catch(e => console.log('Monti: err sending cpu profile', e));\n  });\n};\n\n/**\n * @warning Mutating the `__meteor_runtime_config__` object does not propagate in real-time to the client, only if the\n * version changes and the client refreshes it seems. In the future we might want to change that into a reactive approach.\n */\n\nKadira.enableErrorTracking = function () {\n  __meteor_runtime_config__.kadira.enableErrorTracking = true;\n  Kadira.options.enableErrorTracking = true;\n};\n\nKadira.disableErrorTracking = function () {\n  __meteor_runtime_config__.kadira.enableErrorTracking = false;\n  Kadira.options.enableErrorTracking = false;\n};\n\nKadira.disableClientErrorTracking = function () {\n  __meteor_runtime_config__.kadira.disableClientErrorTracking = Kadira.options.disableClientErrorTracking = true;\n};\n\nKadira.enableClientErrorTracking = function () {\n  __meteor_runtime_config__.kadira.disableClientErrorTracking = Kadira.options.disableClientErrorTracking = false;\n};\n\nKadira.trackError = function () {\n  if (!Kadira.options.enableErrorTracking) {\n    return;\n  }\n\n  const {\n    message,\n    subType,\n    stack,\n    type,\n    kadiraInfo = Kadira._getInfo(),\n  } = getErrorParameters(arguments);\n\n  const now = Ntp._now();\n\n  const previousEvents =\n    kadiraInfo && kadiraInfo.trace ?\n      kadiraInfo.trace.events :\n      [{ type: 'start', at: now, endAt: now }];\n\n  const events = Kadira.tracer\n    .optimizeEvents(previousEvents)\n    .concat([['error', 0, { error: { message, stack } }]]);\n\n  if (message) {\n    let trace = {\n      type: type || 'server-internal',\n      subType: subType || 'server',\n      name: message,\n      errored: true,\n      at: Kadira.syncedDate.getTime(),\n      events,\n      metrics: { total: 0 },\n    };\n\n    Kadira.models.error.trackError({ message, stack }, trace);\n  }\n};\n\nKadira.ignoreErrorTracking = function (err) {\n  err._skipKadira = true;\n};\n\nKadira.startEvent = function (name, data = {}) {\n  let kadiraInfo = Kadira._getInfo();\n  if (kadiraInfo) {\n    return Kadira.tracer.event(kadiraInfo.trace, 'custom', data, { name });\n  }\n\n  return false;\n};\n\nKadira.endEvent = function (event, data) {\n  let kadiraInfo = Kadira._getInfo();\n\n  // The event could be false if it could not be started.\n  // Handle it here instead of requiring the app to.\n  if (kadiraInfo && event) {\n    Kadira.tracer.eventEnd(kadiraInfo.trace, event, data);\n  }\n};\n","export function wrapServer (serverProto) {\n  let originalHandleConnect = serverProto._handleConnect;\n  serverProto._handleConnect = function (socket, msg) {\n    originalHandleConnect.call(this, socket, msg);\n    let session = socket._meteorSession;\n    // sometimes it is possible for _meteorSession to be undefined\n    // one such reason would be if DDP versions are not matching\n    // if then, we should not process it\n    if (!session) {\n      return;\n    }\n\n    Kadira.EventBus.emit('system', 'createSession', msg, socket._meteorSession);\n\n    if (Kadira.connected) {\n      Kadira.models.system.handleSessionActivity(msg, socket._meteorSession);\n    }\n  };\n}\n","import { Meteor } from 'meteor/meteor';\nimport { _ } from 'meteor/underscore';\nimport { MeteorDebugIgnore } from './error';\nimport { TimeoutManager } from './timeout_manager';\n\nconst MAX_PARAMS_LENGTH = 4000;\n\nexport function wrapSession (sessionProto) {\n  let originalProcessMessage = sessionProto.processMessage;\n  sessionProto.processMessage = function (msg) {\n    let kadiraInfo = {\n      session: this.id,\n      userId: this.userId\n    };\n    if (msg.msg === 'method' || msg.msg === 'sub') {\n      kadiraInfo.trace = Kadira.tracer.start(this, msg);\n\n      Kadira.waitTimeBuilder.register(this, msg.id);\n\n      let params = Kadira.tracer._applyObjectFilters(msg.params || []);\n      // use JSON instead of EJSON to save the CPU\n      let stringifiedParams = JSON.stringify(params);\n\n      // The params could be several mb or larger.\n      // Truncate if it is large\n      if (stringifiedParams.length > MAX_PARAMS_LENGTH) {\n        stringifiedParams = `Monti APM: params are too big. First ${MAX_PARAMS_LENGTH} characters: ${stringifiedParams.slice(0, MAX_PARAMS_LENGTH)}`;\n      }\n\n      let startData = { userId: this.userId, params: stringifiedParams };\n      Kadira.tracer.event(kadiraInfo.trace, 'start', startData);\n      msg._waitEventId = Kadira.tracer.event(kadiraInfo.trace, 'wait', {}, kadiraInfo);\n      msg.__kadiraInfo = kadiraInfo;\n\n      if (msg.msg === 'sub') {\n        // start tracking inside processMessage allows us to indicate\n        // wait time as well\n        Kadira.EventBus.emit('pubsub', 'subReceived', this, msg);\n        Kadira.models.pubsub._trackSub(this, msg);\n      }\n    }\n    Kadira.EventBus.emit('system', 'ddpMessageReceived', this, msg);\n    Kadira.models.system.handleSessionActivity(msg, this);\n\n    return originalProcessMessage.call(this, msg);\n  };\n\n  // adding the method context to the current fiber\n  let originalMethodHandler = sessionProto.protocol_handlers.method;\n  sessionProto.protocol_handlers.method = function (msg, unblock) {\n    let self = this;\n    // add context\n    let kadiraInfo = msg.__kadiraInfo;\n\n    let response;\n\n    if (kadiraInfo) {\n      Kadira._setInfo(kadiraInfo);\n\n      TimeoutManager.trackTimeout({\n        kadiraInfo,\n        msg,\n      });\n\n      // end wait event\n      let waitList = Kadira.waitTimeBuilder.build(this, msg.id);\n      Kadira.tracer.eventEnd(kadiraInfo.trace, msg._waitEventId, {waitOn: waitList});\n\n      unblock = Kadira.waitTimeBuilder.trackWaitTime(this, msg, unblock);\n      response = Kadira.env.kadiraInfo.withValue(kadiraInfo, function () {\n        return originalMethodHandler.call(self, msg, unblock);\n      });\n      unblock();\n    } else {\n      response = originalMethodHandler.call(self, msg, unblock);\n    }\n\n    return response;\n  };\n\n  // to capture the currently processing message\n  let orginalSubHandler = sessionProto.protocol_handlers.sub;\n  sessionProto.protocol_handlers.sub = function (msg, unblock) {\n    let self = this;\n    // add context\n    let kadiraInfo = msg.__kadiraInfo;\n    let response;\n    if (kadiraInfo) {\n      Kadira._setInfo(kadiraInfo);\n\n      TimeoutManager.trackTimeout({\n        kadiraInfo,\n        msg,\n      });\n\n      // end wait event\n      let waitList = Kadira.waitTimeBuilder.build(this, msg.id);\n      Kadira.tracer.eventEnd(kadiraInfo.trace, msg._waitEventId, {waitOn: waitList});\n\n      unblock = Kadira.waitTimeBuilder.trackWaitTime(this, msg, unblock);\n      response = Kadira.env.kadiraInfo.withValue(kadiraInfo, function () {\n        return orginalSubHandler.call(self, msg, unblock);\n      });\n      unblock();\n    } else {\n      response = orginalSubHandler.call(self, msg, unblock);\n    }\n\n    return response;\n  };\n\n  // to capture the currently processing message\n  let orginalUnSubHandler = sessionProto.protocol_handlers.unsub;\n  sessionProto.protocol_handlers.unsub = function (msg, unblock) {\n    unblock = Kadira.waitTimeBuilder.trackWaitTime(this, msg, unblock);\n    let response = orginalUnSubHandler.call(this, msg, unblock);\n    unblock();\n    return response;\n  };\n\n  // track method ending (to get the result of error)\n  let originalSend = sessionProto.send;\n  sessionProto.send = function (msg) {\n    if (msg.msg === 'result') {\n      let kadiraInfo = Kadira._getInfo();\n      if (kadiraInfo) {\n        TimeoutManager.clearTimeout({ kadiraInfo });\n\n        let error;\n\n        if (msg.error) {\n          error = _.pick(msg.error, ['message', 'stack', 'details']);\n\n          // pick the error from the wrapped method handler\n          if (kadiraInfo && kadiraInfo.currentError) {\n            // the error stack is wrapped so Meteor._debug can identify\n            // this as a method error.\n            error = _.pick(kadiraInfo.currentError, ['message', 'stack', 'details']);\n            // see wrapMethodHanderForErrors() method def for more info\n            if (error.stack && error.stack.stack) {\n              error.stack = error.stack.stack;\n            }\n          }\n\n          Kadira.tracer.endLastEvent(kadiraInfo.trace);\n          Kadira.tracer.event(kadiraInfo.trace, 'error', {error});\n        } else {\n          Kadira.tracer.endLastEvent(kadiraInfo.trace);\n          Kadira.tracer.event(kadiraInfo.trace, 'complete');\n        }\n\n        // processing the message\n        let trace = Kadira.tracer.buildTrace(kadiraInfo.trace);\n        Kadira.EventBus.emit('method', 'methodCompleted', trace, this);\n        Kadira.models.methods.processMethod(trace);\n\n        // error may or may not exist and error tracking can be disabled\n        if (error && Kadira.options.enableErrorTracking) {\n          Kadira.models.error.trackError(error, trace);\n        }\n\n        // clean and make sure, fiber is clean\n        // not sure we need to do this, but a preventive measure\n        Kadira._setInfo(null);\n      }\n    }\n\n    return originalSend.call(this, msg);\n  };\n}\n\n// wrap existing method handlers for capturing errors\n_.each(Meteor.server.method_handlers, function (handler, name) {\n  wrapMethodHanderForErrors(name, handler, Meteor.server.method_handlers);\n});\n\n// wrap future method handlers for capturing errors\nlet originalMeteorMethods = Meteor.methods;\nMeteor.methods = function (methodMap) {\n  _.each(methodMap, function (handler, name) {\n    wrapMethodHanderForErrors(name, handler, methodMap);\n  });\n  originalMeteorMethods(methodMap);\n};\n\n\nfunction wrapMethodHanderForErrors (name, originalHandler, methodMap) {\n  methodMap[name] = function () {\n    try {\n      return originalHandler.apply(this, arguments);\n    } catch (ex) {\n      if (ex && Kadira._getInfo()) {\n        // sometimes error may be just a string or a primitive\n        // in that case, we need to make it a psuedo error\n        if (typeof ex !== 'object') {\n          // eslint-disable-next-line no-ex-assign\n          ex = {message: ex, stack: ex};\n        }\n        // Now we are marking this error to get tracked via methods\n        // But, this also triggers a Meteor.debug call, and\n        // it only gets the stack\n        // We also track Meteor.debug errors and want to stop\n        // tracking this error. That's why we do this\n        // See Meteor.debug error tracking code for more\n        // If error tracking is disabled, we do not modify the stack since\n        // it would be shown as an object in the logs\n        if (Kadira.options.enableErrorTracking) {\n          ex.stack = {stack: ex.stack, source: 'method', [MeteorDebugIgnore]: true};\n          Kadira._getInfo().currentError = ex;\n        }\n      }\n      throw ex;\n    }\n  };\n}\n","import { MeteorDebugIgnore } from './error';\nimport { _ } from 'meteor/underscore';\n\nexport function wrapSubscription (subscriptionProto) {\n  // If the ready event runs outside the Fiber, Kadira._getInfo() doesn't work.\n  // we need some other way to store kadiraInfo so we can use it at ready hijack.\n  let originalRunHandler = subscriptionProto._runHandler;\n  subscriptionProto._runHandler = function () {\n    let kadiraInfo = Kadira._getInfo();\n    if (kadiraInfo) {\n      this.__kadiraInfo = kadiraInfo;\n    }\n    originalRunHandler.call(this);\n  };\n\n  let originalReady = subscriptionProto.ready;\n  subscriptionProto.ready = function () {\n    // meteor has a field called `_ready` which tracks this,\n    // but we need to make it future-proof\n    if (!this._apmReadyTracked) {\n      let kadiraInfo = Kadira._getInfo() || this.__kadiraInfo;\n      delete this.__kadiraInfo;\n\n      let trace;\n\n      // sometime .ready can be called in the context of the method\n      // then we have some problems, that's why we are checking this\n      // eg:- Accounts.createUser\n      // Also, when the subscription is created by fast render, _subscriptionId and\n      // the trace.id are both undefined, but we don't want to complete the HTTP trace here\n      if (kadiraInfo && this._subscriptionId && this._subscriptionId === kadiraInfo.trace.id) {\n        Kadira.tracer.endLastEvent(kadiraInfo.trace);\n        Kadira.tracer.event(kadiraInfo.trace, 'complete');\n        trace = Kadira.tracer.buildTrace(kadiraInfo.trace);\n      }\n\n      Kadira.EventBus.emit('pubsub', 'subCompleted', trace, this._session, this);\n      Kadira.models.pubsub._trackReady(this._session, this, trace);\n      this._apmReadyTracked = true;\n    }\n\n    // we still pass the control to the original implementation\n    // since multiple ready calls are handled by itself\n    originalReady.call(this);\n  };\n\n  let originalError = subscriptionProto.error;\n  subscriptionProto.error = function (err) {\n    if (typeof err === 'string') {\n      err = { message: err };\n    }\n\n    let kadiraInfo = Kadira._getInfo();\n\n    if (kadiraInfo && this._subscriptionId && this._subscriptionId === kadiraInfo.trace.id) {\n      Kadira.tracer.endLastEvent(kadiraInfo.trace);\n\n      let errorForApm = _.pick(err, 'message', 'stack');\n      Kadira.tracer.event(kadiraInfo.trace, 'error', {error: errorForApm});\n      let trace = Kadira.tracer.buildTrace(kadiraInfo.trace);\n\n      Kadira.models.pubsub._trackError(this._session, this, trace);\n\n      // error tracking can be disabled and if there is a trace\n      // should be available all the time, but it won't\n      // if something wrong happened on the trace building\n      if (Kadira.options.enableErrorTracking && trace) {\n        Kadira.models.error.trackError(err, trace);\n      }\n    }\n\n    // wrap error stack so Meteor._debug can identify and ignore it\n    // it is not wrapped when error tracking is disabled since it\n    // would be shown as an object in the logs\n    if (Kadira.options.enableErrorTracking) {\n      err.stack = {stack: err.stack, source: 'subscription', [MeteorDebugIgnore]: true};\n    }\n    originalError.call(this, err);\n  };\n\n  let originalDeactivate = subscriptionProto._deactivate;\n  subscriptionProto._deactivate = function () {\n    Kadira.EventBus.emit('pubsub', 'subDeactivated', this._session, this);\n    Kadira.models.pubsub._trackUnsub(this._session, this);\n    originalDeactivate.call(this);\n  };\n\n  // adding the currenSub env variable\n  ['added', 'changed', 'removed'].forEach(function (funcName) {\n    let originalFunc = subscriptionProto[funcName];\n    subscriptionProto[funcName] = function (collectionName, id, fields) {\n      let self = this;\n\n      // we need to run this code in a fiber and that's how we track\n      // subscription info. Maybe we can figure out, some other way to do this\n      // We use this currently to get the publication info when tracking message\n      // sizes at wrap_ddp_stringify.js\n      Kadira.env.currentSub = self;\n      let res = originalFunc.call(self, collectionName, id, fields);\n      Kadira.env.currentSub = null;\n\n      return res;\n    };\n  });\n}\n","import { _ } from 'meteor/underscore';\n\nexport function wrapOplogObserveDriver (proto) {\n  // Track the polled documents. This is reflected to the RAM size and\n  // for the CPU usage directly\n  let originalPublishNewResults = proto._publishNewResults;\n  proto._publishNewResults = function (newResults, newBuffer) {\n    let coll = this._cursorDescription.collectionName;\n    let query = this._cursorDescription.selector;\n    let opts = this._cursorDescription.options;\n    const docSize = Kadira.docSzCache.getSize(coll, query, opts, newBuffer);\n    let count = newResults.size() + newBuffer.size();\n    if (this._ownerInfo) {\n      Kadira.models.pubsub.trackPolledDocuments(this._ownerInfo, count);\n      Kadira.models.pubsub.trackDocSize(this._ownerInfo.name, 'polledFetches', docSize * count);\n    } else {\n      this._polledDocuments = count;\n      this._docSize = {\n        polledFetches: docSize * count\n      };\n    }\n    return originalPublishNewResults.call(this, newResults, newBuffer);\n  };\n\n  let originalHandleOplogEntryQuerying = proto._handleOplogEntryQuerying;\n  proto._handleOplogEntryQuerying = function (op) {\n    Kadira.models.pubsub.trackDocumentChanges(this._ownerInfo, op);\n    return originalHandleOplogEntryQuerying.call(this, op);\n  };\n\n  let originalHandleOplogEntrySteadyOrFetching = proto._handleOplogEntrySteadyOrFetching;\n  proto._handleOplogEntrySteadyOrFetching = function (op) {\n    Kadira.models.pubsub.trackDocumentChanges(this._ownerInfo, op);\n    return originalHandleOplogEntrySteadyOrFetching.call(this, op);\n  };\n\n  // track live updates\n  ['_addPublished', '_removePublished', '_changePublished'].forEach(function (fnName) {\n    let originalFn = proto[fnName];\n    proto[fnName] = function (a, b, c) {\n      if (this._ownerInfo) {\n        Kadira.models.pubsub.trackLiveUpdates(this._ownerInfo, fnName, 1);\n\n        if (fnName === '_addPublished') {\n          const coll = this._cursorDescription.collectionName;\n          const query = this._cursorDescription.selector;\n          const opts = this._cursorDescription.options;\n          const docSize = Kadira.docSzCache.getSize(coll, query, opts, [b]);\n\n          Kadira.models.pubsub.trackDocSize(this._ownerInfo.name, 'liveFetches', docSize);\n        }\n      } else {\n        // If there is no ownerInfo, that means this is the initial adds\n        if (!this._liveUpdatesCounts) {\n          this._liveUpdatesCounts = {\n            _initialAdds: 0\n          };\n        }\n\n        this._liveUpdatesCounts._initialAdds++;\n\n        if (fnName === '_addPublished') {\n          if (!this._docSize) {\n            this._docSize = {\n              initialFetches: 0\n            };\n          }\n\n          if (!this._docSize.initialFetches) {\n            this._docSize.initialFetches = 0;\n          }\n\n          const coll = this._cursorDescription.collectionName;\n          const query = this._cursorDescription.selector;\n          const opts = this._cursorDescription.options;\n          const docSize = Kadira.docSzCache.getSize(coll, query, opts, [b]);\n\n          this._docSize.initialFetches += docSize;\n        }\n      }\n\n      return originalFn.call(this, a, b, c);\n    };\n  });\n\n  let originalStop = proto.stop;\n  proto.stop = function () {\n    if (this._ownerInfo && this._ownerInfo.type === 'sub') {\n      Kadira.EventBus.emit('pubsub', 'observerDeleted', this._ownerInfo);\n      Kadira.models.pubsub.trackDeletedObserver(this._ownerInfo);\n    }\n\n    return originalStop.call(this);\n  };\n}\n\nexport function wrapPollingObserveDriver (proto) {\n  let originalPollMongo = proto._pollMongo;\n  proto._pollMongo = function () {\n    originalPollMongo.call(this);\n\n    // Current result is stored in the following variable.\n    // So, we can use that\n    // Sometimes, it's possible to get size as undefined.\n    // May be something with different version. We don't need to worry about\n    // this now\n    let count = 0;\n    let docSize = 0;\n\n    if (this._results && this._results.size) {\n      count = this._results.size() || 0;\n\n      let coll = this._cursorDescription.collectionName;\n      let query = this._cursorDescription.selector;\n      let opts = this._cursorDescription.options;\n\n      docSize = Kadira.docSzCache.getSize(coll, query, opts, this._results._map) * count;\n    }\n\n    if (this._ownerInfo) {\n      Kadira.models.pubsub.trackPolledDocuments(this._ownerInfo, count);\n      Kadira.models.pubsub.trackDocSize(this._ownerInfo.name, 'polledFetches', docSize);\n    } else {\n      this._polledDocuments = count;\n      this._polledDocSize = docSize;\n    }\n  };\n\n  let originalStop = proto.stop;\n  proto.stop = function () {\n    if (this._ownerInfo && this._ownerInfo.type === 'sub') {\n      Kadira.EventBus.emit('pubsub', 'observerDeleted', this._ownerInfo);\n      Kadira.models.pubsub.trackDeletedObserver(this._ownerInfo);\n    }\n\n    return originalStop.call(this);\n  };\n}\n\nexport function wrapMultiplexer (proto) {\n  let originalInitalAdd = proto.addHandleAndSendInitialAdds;\n  proto.addHandleAndSendInitialAdds = function (handle) {\n    if (!this._firstInitialAddTime) {\n      this._firstInitialAddTime = Date.now();\n    }\n\n    handle._wasMultiplexerReady = this._ready();\n    handle._queueLength = this._queue._taskHandles.length;\n\n    if (!handle._wasMultiplexerReady) {\n      handle._elapsedPollingTime = Date.now() - this._firstInitialAddTime;\n    }\n    return originalInitalAdd.call(this, handle);\n  };\n}\n\nexport function wrapForCountingObservers () {\n  // to count observers\n  let mongoConnectionProto = MeteorX.MongoConnection.prototype;\n  let originalObserveChanges = mongoConnectionProto._observeChanges;\n  mongoConnectionProto._observeChanges = function (cursorDescription, ordered, callbacks) {\n    let ret = originalObserveChanges.call(this, cursorDescription, ordered, callbacks);\n    // get the Kadira Info via the Meteor.EnvironmentalVariable\n    let kadiraInfo = Kadira._getInfo(null, true);\n\n    if (kadiraInfo && ret._multiplexer) {\n      if (!ret._multiplexer.__kadiraTracked) {\n        // new multiplexer\n        ret._multiplexer.__kadiraTracked = true;\n        Kadira.EventBus.emit('pubsub', 'newSubHandleCreated', kadiraInfo.trace);\n        Kadira.models.pubsub.incrementHandleCount(kadiraInfo.trace, false);\n        if (kadiraInfo.trace.type === 'sub') {\n          let ownerInfo = {\n            type: kadiraInfo.trace.type,\n            name: kadiraInfo.trace.name,\n            startTime: new Date().getTime()\n          };\n\n          let observerDriver = ret._multiplexer._observeDriver;\n          observerDriver._ownerInfo = ownerInfo;\n          Kadira.EventBus.emit('pubsub', 'observerCreated', ownerInfo);\n          Kadira.models.pubsub.trackCreatedObserver(ownerInfo);\n\n          // We need to send initially polled documents if there are\n          if (observerDriver._polledDocuments) {\n            Kadira.models.pubsub.trackPolledDocuments(ownerInfo, observerDriver._polledDocuments);\n            observerDriver._polledDocuments = 0;\n          }\n\n          // We need to send initially polled documents if there are\n          if (observerDriver._polledDocSize) {\n            Kadira.models.pubsub.trackDocSize(ownerInfo.name, 'polledFetches', observerDriver._polledDocSize);\n            observerDriver._polledDocSize = 0;\n          }\n\n          // Process _liveUpdatesCounts\n          _.each(observerDriver._liveUpdatesCounts, function (count, key) {\n            Kadira.models.pubsub.trackLiveUpdates(ownerInfo, key, count);\n          });\n\n          // Process docSize\n          _.each(observerDriver._docSize, function (count, key) {\n            Kadira.models.pubsub.trackDocSize(ownerInfo.name, key, count);\n          });\n        }\n      } else {\n        Kadira.EventBus.emit('pubsub', 'cachedSubHandleCreated', kadiraInfo.trace);\n        Kadira.models.pubsub.incrementHandleCount(kadiraInfo.trace, true);\n      }\n    }\n\n    return ret;\n  };\n}\n","import { DDPCommon } from 'meteor/ddp-common';\n\nexport function wrapStringifyDDP () {\n  let originalStringifyDDP = DDPCommon.stringifyDDP;\n\n  DDPCommon.stringifyDDP = function (msg) {\n    let msgString = originalStringifyDDP(msg);\n    let msgSize = Buffer.byteLength(msgString, 'utf8');\n\n    let kadiraInfo = Kadira._getInfo(null, true);\n\n    if (kadiraInfo && !Kadira.env.currentSub) {\n      if (kadiraInfo.trace.type === 'method') {\n        Kadira.models.methods.trackMsgSize(kadiraInfo.trace.name, msgSize);\n      }\n\n      return msgString;\n    }\n\n    // 'currentSub' is set when we wrap Subscription object and override\n    // handlers for 'added', 'changed', 'removed' events. (see lib/hijack/wrap_subscription.js)\n    if (Kadira.env.currentSub) {\n      if (Kadira.env.currentSub.__kadiraInfo) {\n        Kadira.models.pubsub.trackMsgSize(Kadira.env.currentSub._name, 'initialSent', msgSize);\n        return msgString;\n      }\n      Kadira.models.pubsub.trackMsgSize(Kadira.env.currentSub._name, 'liveSent', msgSize);\n      return msgString;\n    }\n\n    Kadira.models.methods.trackMsgSize('<not-a-method-or-a-pub>', msgSize);\n    return msgString;\n  };\n}\n","import { wrapWebApp } from './wrap_webapp.js';\nimport { wrapFastRender } from './fast_render.js';\nimport { wrapFs } from './fs.js';\nimport { wrapPicker } from './picker.js';\nimport { wrapRouters } from './wrap_routers.js';\nimport { wrapFibers } from './async.js';\nimport { wrapSubscription } from './wrap_subscription';\nimport { wrapServer } from './wrap_server';\nimport { wrapSession } from './wrap_session';\nimport {\n  wrapForCountingObservers,\n  wrapMultiplexer,\n  wrapOplogObserveDriver,\n  wrapPollingObserveDriver\n} from './wrap_observers';\nimport { wrapStringifyDDP } from './wrap_ddp_stringify';\nimport { setLabels } from './set_labels';\nimport { hijackDBOps } from './db';\n\nlet instrumented = false;\nKadira._startInstrumenting = function (callback) {\n  if (instrumented) {\n    callback();\n    return;\n  }\n\n  instrumented = true;\n  wrapFibers();\n  wrapStringifyDDP();\n  wrapWebApp();\n  wrapFastRender();\n  wrapPicker();\n  wrapFs();\n  wrapRouters();\n\n  MeteorX.onReady(function () {\n    // instrumenting session\n    wrapServer(MeteorX.Server.prototype);\n    wrapSession(MeteorX.Session.prototype);\n    wrapSubscription(MeteorX.Subscription.prototype);\n\n    if (MeteorX.MongoOplogDriver) {\n      wrapOplogObserveDriver(MeteorX.MongoOplogDriver.prototype);\n    }\n\n    if (MeteorX.MongoPollingDriver) {\n      wrapPollingObserveDriver(MeteorX.MongoPollingDriver.prototype);\n    }\n\n    if (MeteorX.Multiplexer) {\n      wrapMultiplexer(MeteorX.Multiplexer.prototype);\n    }\n\n    wrapForCountingObservers();\n    hijackDBOps();\n\n    setLabels();\n    callback();\n  });\n};\n","import { Meteor } from 'meteor/meteor';\nimport { Random } from 'meteor/random';\nimport { Mongo, MongoInternals } from 'meteor/mongo';\nimport { _ } from 'meteor/underscore';\nimport {haveAsyncCallback, OptimizedApply} from '../utils';\n\n\n// This hijack is important to make sure, collections created before\n// we hijack dbOps, even gets tracked.\n//  Meteor does not simply expose MongoConnection object to the client\n//  It picks methods which are necessary and make a binded object and\n//  assigned to the Mongo.Collection\n//  so, even we updated prototype, we can't track those collections\n//  but, this will fix it.\n\nlet originalOpen = MongoInternals.RemoteCollectionDriver.prototype.open;\nMongoInternals.RemoteCollectionDriver.prototype.open = function open (name) {\n  let self = this;\n  let ret = originalOpen.call(self, name);\n\n  _.each(ret, function (fn, m) {\n    // make sure, it's in the actual mongo connection object\n    // meteorhacks:mongo-collection-utils package add some arbitary methods\n    // which does not exist in the mongo connection\n    if (self.mongo[m]) {\n      ret[m] = function () {\n        Array.prototype.unshift.call(arguments, name);\n        return OptimizedApply(self.mongo, self.mongo[m], arguments);\n      };\n    }\n  });\n\n  return ret;\n};\n\n// TODO: this should be added to Meteorx\nfunction getSyncronousCursor () {\n  const MongoColl = typeof Mongo !== 'undefined' ? Mongo.Collection : Meteor.Collection;\n  const coll = new MongoColl(`__dummy_coll_${Random.id()}`);\n  // we need to wait until the db is connected with meteor. findOne does that\n  coll.findOne();\n\n  const cursor = coll.find();\n  cursor.fetch();\n  return cursor._synchronousCursor.constructor;\n}\n\nexport function hijackDBOps () {\n  let mongoConnectionProto = MeteorX.MongoConnection.prototype;\n  // findOne is handled by find - so no need to track it\n  // upsert is handles by update\n  // 2.4 replaced _ensureIndex with createIndex\n  [\n    'find', 'update', 'remove', 'insert', '_ensureIndex', '_dropIndex', 'createIndex'\n  ].forEach(function (func) {\n    let originalFunc = mongoConnectionProto[func];\n\n    if (!originalFunc) {\n      return;\n    }\n\n    mongoConnectionProto[func] = function (collName, selector, mod, options) {\n      let payload = {\n        coll: collName,\n        func,\n      };\n\n      if (func === 'insert') {\n        // add nothing more to the payload\n      } else if (func === '_ensureIndex' || func === '_dropIndex' || func === 'createIndex') {\n        // add index\n        payload.index = JSON.stringify(selector);\n      } else if (func === 'update' && options && options.upsert) {\n        payload.func = 'upsert';\n        payload.selector = JSON.stringify(selector);\n      } else {\n        // all the other functions have selectors\n        payload.selector = JSON.stringify(selector);\n      }\n\n      let kadiraInfo = Kadira._getInfo();\n\n      let eventId;\n\n      if (kadiraInfo) {\n        eventId = Kadira.tracer.event(kadiraInfo.trace, 'db', payload);\n      }\n\n      // this cause V8 to avoid any performance optimizations, but this is must use\n      // otherwise, if the error adds try catch block our logs get messy and didn't work\n      // see: issue #6\n\n      let ret;\n\n      try {\n        ret = originalFunc.apply(this, arguments);\n        // handling functions which can be triggered with an asyncCallback\n        let endOptions = {};\n\n        if (haveAsyncCallback(arguments)) {\n          endOptions.async = true;\n        }\n\n        if (func === 'update') {\n          // upsert only returns an object when called `upsert` directly\n          // otherwise it only act an update command\n          if (options && options.upsert && typeof ret === 'object') {\n            endOptions.updatedDocs = ret.numberAffected;\n            endOptions.insertedId = ret.insertedId;\n          } else {\n            endOptions.updatedDocs = ret;\n          }\n        } else if (func === 'remove') {\n          endOptions.removedDocs = ret;\n        }\n\n        if (eventId) {\n          Kadira.tracer.eventEnd(kadiraInfo.trace, eventId, endOptions);\n        }\n      } catch (ex) {\n        if (eventId) {\n          Kadira.tracer.eventEnd(kadiraInfo.trace, eventId, {err: ex.message});\n        }\n        throw ex;\n      }\n\n      return ret;\n    };\n  });\n\n  let cursorProto = MeteorX.MongoCursor.prototype;\n  ['forEach', 'map', 'fetch', 'count', 'observeChanges', 'observe'].forEach(function (type) {\n    let originalFunc = cursorProto[type];\n    cursorProto[type] = function () {\n      let cursorDescription = this._cursorDescription;\n      let payload = Object.assign(Object.create(null), {\n        coll: cursorDescription.collectionName,\n        selector: JSON.stringify(cursorDescription.selector),\n        func: type,\n        cursor: true\n      });\n\n      if (cursorDescription.options) {\n        let cursorOptions = _.pick(cursorDescription.options, ['fields', 'projection', 'sort', 'limit']);\n        for (let field in cursorOptions) {\n          let value = cursorOptions[field];\n          if (typeof value === 'object') {\n            value = JSON.stringify(value);\n          }\n          payload[field] = value;\n        }\n      }\n\n      let kadiraInfo = Kadira._getInfo();\n      let previousTrackNextObject;\n      let eventId;\n\n      if (kadiraInfo) {\n        eventId = Kadira.tracer.event(kadiraInfo.trace, 'db', payload);\n\n        previousTrackNextObject = kadiraInfo.trackNextObject;\n        if (type === 'forEach' || type === 'map') {\n          kadiraInfo.trackNextObject = true;\n        }\n      }\n\n      try {\n        let ret = originalFunc.apply(this, arguments);\n\n        let endData = {};\n\n        if (type === 'observeChanges' || type === 'observe') {\n          let observerDriver;\n          endData.oplog = false;\n          // get data written by the multiplexer\n          endData.wasMultiplexerReady = ret._wasMultiplexerReady;\n          endData.queueLength = ret._queueLength;\n          endData.elapsedPollingTime = ret._elapsedPollingTime;\n\n          if (ret._multiplexer) {\n            // older meteor versions done not have an _multiplexer value\n            observerDriver = ret._multiplexer._observeDriver;\n            if (observerDriver) {\n              observerDriver = ret._multiplexer._observeDriver;\n              let observerDriverClass = observerDriver.constructor;\n              endData.oplog = typeof observerDriverClass.cursorSupported === 'function';\n\n              let size = 0;\n              ret._multiplexer._cache.docs.forEach(function () {\n                size++;\n              });\n              endData.noOfCachedDocs = size;\n\n              // if multiplexerWasNotReady, we need to get the time spend for the polling\n              if (!ret._wasMultiplexerReady) {\n                endData.initialPollingTime = observerDriver._lastPollTime;\n              }\n            }\n          }\n\n          if (!endData.oplog) {\n            // let's try to find the reason\n            let reasonInfo = Kadira.checkWhyNoOplog(cursorDescription, observerDriver);\n            endData.noOplogCode = reasonInfo.code;\n            endData.noOplogReason = reasonInfo.reason;\n            endData.noOplogSolution = reasonInfo.solution;\n          }\n        } else if (type === 'fetch' || type === 'map') {\n          // for other cursor operation\n\n          endData.docsFetched = ret.length;\n\n          if (type === 'fetch') {\n            let coll = cursorDescription.collectionName;\n            let query = cursorDescription.selector;\n            let opts = cursorDescription.options;\n            let docSize = Kadira.docSzCache.getSize(coll, query, opts, ret) * ret.length;\n            endData.docSize = docSize;\n\n            if (kadiraInfo) {\n              if (kadiraInfo.trace.type === 'method') {\n                Kadira.models.methods.trackDocSize(kadiraInfo.trace.name, docSize);\n              } else if (kadiraInfo.trace.type === 'sub') {\n                Kadira.models.pubsub.trackDocSize(kadiraInfo.trace.name, 'cursorFetches', docSize);\n              }\n\n              kadiraInfo.trackNextObject = previousTrackNextObject;\n            } else {\n              // Fetch with no kadira info are tracked as from a null method\n              Kadira.models.methods.trackDocSize('<not-a-method-or-a-pub>', docSize);\n            }\n\n            // TODO: Add doc size tracking to `map` as well.\n          }\n        }\n\n        if (eventId) {\n          Kadira.tracer.eventEnd(kadiraInfo.trace, eventId, endData);\n        }\n        return ret;\n      } catch (ex) {\n        if (eventId) {\n          Kadira.tracer.eventEnd(kadiraInfo.trace, eventId, {err: ex.message});\n        }\n        throw ex;\n      }\n    };\n  });\n\n  const SyncronousCursor = getSyncronousCursor();\n  let origNextObject = SyncronousCursor.prototype._nextObject;\n  SyncronousCursor.prototype._nextObject = function () {\n    let kadiraInfo = Kadira._getInfo();\n    let shouldTrack = kadiraInfo && kadiraInfo.trackNextObject;\n    let event;\n    if (shouldTrack ) {\n      event = Kadira.tracer.event(kadiraInfo.trace, 'db', {\n        func: '_nextObject',\n        coll: this._cursorDescription.collectionName\n      });\n    }\n\n    let result = origNextObject.call(this);\n\n    if (shouldTrack) {\n      Kadira.tracer.eventEnd(kadiraInfo.trace, event);\n    }\n    return result;\n  };\n}\n","/* eslint-disable prefer-rest-params */\nimport { haveAsyncCallback } from '../utils';\n\nif (Package['http']) {\n  const HTTP = Package['http'].HTTP;\n  const library = 'meteor/http';\n  const originalCall = HTTP.call;\n\n  HTTP.call = function (method, url) {\n    const tracer = Kadira.tracer;\n    const kadiraInfo = Kadira._getInfo();\n\n    const event = kadiraInfo ? tracer.event(kadiraInfo.trace, 'http', {\n      method,\n      url,\n      library,\n    }) : null;\n\n    if (!event) {\n      return originalCall.apply(this, arguments);\n    }\n\n    try {\n      const response = originalCall.apply(this, arguments);\n\n      // If the user supplied an asyncCallback,\n      // we don't have a response object and it handled asynchronously.\n      // We need to track it down to prevent issues like: #3\n      const endOptions = haveAsyncCallback(arguments) ? { async: true } : { statusCode: response.statusCode };\n\n      tracer.eventEnd(kadiraInfo.trace, event, endOptions);\n\n      return response;\n    } catch (ex) {\n      tracer.eventEnd(kadiraInfo.trace, event, { err: ex.message });\n\n      throw ex;\n    }\n  };\n}\n\nif (Package['fetch']) {\n  const library = 'meteor/fetch';\n  const originalCall = Package['fetch'].fetch;\n  const Request = Package['fetch'].Request;\n\n  Package['fetch'].fetch = function (url, opts) {\n    const request = new Request(url, opts);\n    const tracer = Kadira.tracer;\n    const kadiraInfo = Kadira._getInfo();\n\n    const event = kadiraInfo ? tracer.event(kadiraInfo.trace, 'http', {\n      method: request.method,\n      url: request.url,\n      library,\n    }) : null;\n\n    if (!event) {\n      return originalCall.apply(this, arguments);\n    }\n\n    try {\n      const response = originalCall.apply(this, arguments);\n\n      response\n        .then(() => {\n          tracer.eventEnd(kadiraInfo.trace, event, { });\n        })\n        .catch((ex) => {\n          tracer.eventEnd(kadiraInfo.trace, event, { err: ex.message });\n        });\n\n      return response;\n    } catch (ex) {\n      tracer.eventEnd(kadiraInfo.trace, event, { err: ex.message });\n\n      throw ex;\n    }\n  };\n}\n","import { pick } from '../utils';\n\nconst CAPTURED_OPTIONS = ['from', 'to', 'cc', 'bcc', 'replyTo', 'messageId'];\n\nconst getWrapper = (originalSend, func) => function wrapper (options) {\n  let eventId;\n  const kadiraInfo = Kadira._getInfo();\n\n  if (kadiraInfo) {\n    const data = pick(options, CAPTURED_OPTIONS);\n    data.func = func;\n\n    eventId = Kadira.tracer.event(kadiraInfo.trace, 'email', data);\n  }\n\n  try {\n    const ret = originalSend.call(this, options);\n    if (eventId) {\n      Kadira.tracer.eventEnd(kadiraInfo.trace, eventId);\n    }\n    return ret;\n  } catch (ex) {\n    if (eventId) {\n      Kadira.tracer.eventEnd(kadiraInfo.trace, eventId, {err: ex.message});\n    }\n    throw ex;\n  }\n};\n\nif (Package['email']) {\n  const { Email } = Package['email'];\n\n  Email.send = getWrapper(Email.send, 'email');\n\n  if (Email.sendAsync) {\n    Email.sendAsync = getWrapper(Email.sendAsync, 'emailAsync');\n  }\n}\n","let Fibers = Npm.require('fibers');\nlet EventSymbol = Symbol('MontiEventSymbol');\nlet StartTracked = Symbol('MontiStartTracked');\n\nlet activeFibers = 0;\nlet wrapped = false;\n\nfunction endAsyncEvent (fiber) {\n  if (!fiber[EventSymbol]) return;\n\n  const kadiraInfo = Kadira._getInfo(fiber);\n\n  if (!kadiraInfo) return;\n\n  Kadira.tracer.eventEnd(kadiraInfo.trace, fiber[EventSymbol]);\n\n  fiber[EventSymbol] = null;\n}\n\nexport function wrapFibers () {\n  if (wrapped) {\n    return;\n  }\n  wrapped = true;\n\n  let originalYield = Fibers.yield;\n  Fibers.yield = function () {\n    let kadiraInfo = Kadira._getInfo();\n    if (kadiraInfo) {\n      let eventId = Kadira.tracer.event(kadiraInfo.trace, 'async');\n      if (eventId) {\n        // The event unique to this fiber\n        // Using a symbol since Meteor doesn't copy symbols to new fibers created\n        // for promises. This is needed so the correct event is ended when a fiber runs after being yielded.\n        Fibers.current[EventSymbol] = eventId;\n      }\n    }\n\n    return originalYield();\n  };\n\n  let originalRun = Fibers.prototype.run;\n  let originalThrowInto = Fibers.prototype.throwInto;\n\n  function ensureFiberCounted (fiber) {\n    // If fiber.started is true, and StartTracked is false\n    // then the fiber was probably initially ran before we wrapped Fibers.run\n    if (!fiber.started || !fiber[StartTracked]) {\n      activeFibers += 1;\n      fiber[StartTracked] = true;\n    }\n  }\n\n  Fibers.prototype.run = function (val) {\n    ensureFiberCounted(this);\n\n    if (this[EventSymbol]) {\n      endAsyncEvent(this);\n    } else if (!this.__kadiraInfo && Fibers.current && Fibers.current.__kadiraInfo) {\n      // Copy kadiraInfo when packages or user code creates a new fiber\n      // Done by many apps and packages in connect middleware since older\n      // versions of Meteor did not do it automatically\n      this.__kadiraInfo = Fibers.current.__kadiraInfo;\n    }\n\n    let result;\n    try {\n      result = originalRun.call(this, val);\n    } finally {\n      if (!this.started) {\n        activeFibers -= 1;\n        this[StartTracked] = false;\n      }\n    }\n\n    return result;\n  };\n\n  Fibers.prototype.throwInto = function (val) {\n    ensureFiberCounted(this);\n    endAsyncEvent(this);\n\n    let result;\n\n    try {\n      result = originalThrowInto.call(this, val);\n    } finally {\n      if (!this.started) {\n        activeFibers -= 1;\n        this[StartTracked] = false;\n      }\n    }\n\n    return result;\n  };\n}\n\nlet activeFiberTotal = 0;\nlet activeFiberCount = 0;\nlet previousTotalCreated = 0;\n\nsetInterval(() => {\n  activeFiberTotal += activeFibers;\n  activeFiberCount += 1;\n}, 1000);\n\nexport function getFiberMetrics () {\n  return {\n    created: Fibers.fibersCreated - previousTotalCreated,\n    active: activeFiberTotal / activeFiberCount,\n    poolSize: Fibers.poolSize\n  };\n}\n\nexport function resetFiberMetrics () {\n  activeFiberTotal = 0;\n  activeFiberCount = 0;\n  previousTotalCreated = Fibers.fibersCreated;\n}\n","import { Meteor } from 'meteor/meteor';\nimport { CreateUserStack } from '../utils';\n\nexport const MeteorDebugIgnore = Symbol('MontiMeteorDebugIgnore');\n\nexport function TrackUncaughtExceptions () {\n  process.on('uncaughtException', function (err) {\n    if (err === undefined || err === null) {\n      let type = err === null ? 'null' : 'undefined';\n      err = new Error(`uncaught exception: ${type}`);\n    }\n\n    const timer = setTimeout(function () {\n      throwError(err);\n    }, 1000 * 10);\n\n    // skip errors with `_skipKadira` flag\n    if (err._skipKadira) {\n      return;\n    }\n\n    // let the server crash normally if error tracking is disabled\n    if (!Kadira.options.enableErrorTracking) {\n      printErrorAndKill(err);\n    }\n\n    // looking for already tracked errors and throw them immediately\n    // throw error immediately if kadira is not ready\n    if (err._tracked || !Kadira.connected) {\n      printErrorAndKill(err);\n    }\n\n    let trace = getTrace(err, 'server-crash', 'uncaughtException');\n    Kadira.models.error.trackError(err, trace);\n    Kadira._sendPayload(function () {\n      clearTimeout(timer);\n      throwError(err);\n    });\n\n\n    function throwError (_err) {\n      // sometimes error came back from a fiber.\n      // But we don't fibers to track that error for us\n      // That's why we throw the error on the nextTick\n      process.nextTick(function () {\n        // we need to mark this error where we really need to throw\n        _err._tracked = true;\n        printErrorAndKill(_err);\n      });\n    }\n  });\n\n  function printErrorAndKill (err) {\n    // since we are capturing error, we are also on the error message.\n    // so developers think we are also reponsible for the error.\n    // But we are not. This will fix that.\n    console.error(err.stack);\n    process.exit(7);\n  }\n}\n\nexport function TrackUnhandledRejections () {\n  process.on('unhandledRejection', function (reason) {\n    // skip errors with `_skipKadira` flag\n    if (\n      reason &&\n      reason._skipKadira ||\n      !Kadira.options.enableErrorTracking\n    ) {\n      return;\n    }\n\n    if (reason === undefined) {\n      reason = new Error('unhandledRejection: undefined');\n    }\n\n    let trace = getTrace(reason, 'server-internal', 'unhandledRejection');\n    Kadira.models.error.trackError(reason, trace);\n\n    // TODO: we should respect the --unhandled-rejections option\n    // message taken from\n    // https://github.com/nodejs/node/blob/f4797ff1ef7304659d747d181ec1e7afac408d50/lib/internal/process/promises.js#L243-L248\n    const message =\n      'This error originated either by ' +\n      'throwing inside of an async function without a catch block, ' +\n      'or by rejecting a promise which was not handled with .catch().' +\n      ' The promise rejected with the reason: ';\n\n    // We could emit a warning instead like Node does internally\n    // but it requires Node 8 or newer\n    console.warn(message);\n    console.error(reason && reason.stack ? reason.stack : reason);\n  });\n}\n\nexport function TrackMeteorDebug () {\n  let originalMeteorDebug = Meteor._debug;\n  Meteor._debug = function (message, stack) {\n    // Sometimes Meteor calls Meteor._debug with no arguments\n    // to log an empty line\n    const isArgs = message !== undefined || stack !== undefined;\n\n    // We've changed `stack` into an object at method and sub handlers so we can\n    // detect the error here. These errors are already tracked so don't track them again.\n    let alreadyTracked = false;\n\n    // Some Meteor versions pass the error, and other versions pass the error stack\n    // Restore so origionalMeteorDebug shows the stack as a string instead as an object\n    if (stack && stack[MeteorDebugIgnore]) {\n      alreadyTracked = true;\n      arguments[1] = stack.stack;\n    } else if (stack && stack.stack && stack.stack[MeteorDebugIgnore]) {\n      alreadyTracked = true;\n      arguments[1] = stack.stack.stack;\n    }\n\n    // only send to the server if connected to kadira\n    if (\n      Kadira.options.enableErrorTracking &&\n      isArgs &&\n      !alreadyTracked &&\n      Kadira.connected\n    ) {\n      let errorMessage = message;\n\n      if (typeof message === 'string' && stack instanceof Error) {\n        const separator = message.endsWith(':') ? '' : ':';\n        errorMessage = `${message}${separator} ${stack.message}`;\n      }\n\n      let error = new Error(errorMessage);\n      if (stack instanceof Error) {\n        error.stack = stack.stack;\n      } else if (stack) {\n        error.stack = stack;\n      } else {\n        error.stack = CreateUserStack(error);\n      }\n      let trace = getTrace(error, 'server-internal', 'Meteor._debug');\n      Kadira.models.error.trackError(error, trace);\n    }\n\n    return originalMeteorDebug.apply(this, arguments);\n  };\n}\n\nfunction getTrace (err, type, subType) {\n  return {\n    type,\n    subType,\n    name: err.message,\n    errored: true,\n    at: Kadira.syncedDate.getTime(),\n    events: [\n      ['start', 0, {}],\n      ['error', 0, {error: {message: err.message, stack: err.stack}}]\n    ],\n    metrics: {\n      total: 0\n    }\n  };\n}\n","/* eslint-disable camelcase */\n\nimport { DDPServer } from 'meteor/ddp-server';\n\nexport function setLabels () {\n  // name Session.prototype.send\n  let originalSend = MeteorX.Session.prototype.send;\n  MeteorX.Session.prototype.send = function kadira_Session_send (msg) {\n    return originalSend.call(this, msg);\n  };\n\n  // name Multiplexer initial adds\n  // Multiplexer is undefined in rocket chat\n  if (MeteorX.Multiplexer) {\n    let originalSendAdds = MeteorX.Multiplexer.prototype._sendAdds;\n    MeteorX.Multiplexer.prototype._sendAdds = function kadira_Multiplexer_sendAdds (handle) {\n      return originalSendAdds.call(this, handle);\n    };\n  }\n\n  // name MongoConnection insert\n  let originalMongoInsert = MeteorX.MongoConnection.prototype._insert;\n  MeteorX.MongoConnection.prototype._insert = function kadira_MongoConnection_insert (coll, doc, cb) {\n    return originalMongoInsert.call(this, coll, doc, cb);\n  };\n\n  // name MongoConnection update\n  let originalMongoUpdate = MeteorX.MongoConnection.prototype._update;\n  MeteorX.MongoConnection.prototype._update = function kadira_MongoConnection_update (coll, selector, mod, options, cb) {\n    return originalMongoUpdate.call(this, coll, selector, mod, options, cb);\n  };\n\n  // name MongoConnection remove\n  let originalMongoRemove = MeteorX.MongoConnection.prototype._remove;\n  MeteorX.MongoConnection.prototype._remove = function kadira_MongoConnection_remove (coll, selector, cb) {\n    return originalMongoRemove.call(this, coll, selector, cb);\n  };\n\n  // name Pubsub added\n  let originalPubsubAdded = MeteorX.Session.prototype.sendAdded;\n  MeteorX.Session.prototype.sendAdded = function kadira_Session_sendAdded (coll, id, fields) {\n    return originalPubsubAdded.call(this, coll, id, fields);\n  };\n\n  // name Pubsub changed\n  let originalPubsubChanged = MeteorX.Session.prototype.sendChanged;\n  MeteorX.Session.prototype.sendChanged = function kadira_Session_sendChanged (coll, id, fields) {\n    return originalPubsubChanged.call(this, coll, id, fields);\n  };\n\n  // name Pubsub removed\n  let originalPubsubRemoved = MeteorX.Session.prototype.sendRemoved;\n  MeteorX.Session.prototype.sendRemoved = function kadira_Session_sendRemoved (coll, id) {\n    return originalPubsubRemoved.call(this, coll, id);\n  };\n\n  // name MongoCursor forEach\n  let originalCursorForEach = MeteorX.MongoCursor.prototype.forEach;\n  MeteorX.MongoCursor.prototype.forEach = function kadira_Cursor_forEach () {\n    return originalCursorForEach.apply(this, arguments);\n  };\n\n  // name MongoCursor map\n  let originalCursorMap = MeteorX.MongoCursor.prototype.map;\n  MeteorX.MongoCursor.prototype.map = function kadira_Cursor_map () {\n    return originalCursorMap.apply(this, arguments);\n  };\n\n  // name MongoCursor fetch\n  let originalCursorFetch = MeteorX.MongoCursor.prototype.fetch;\n  MeteorX.MongoCursor.prototype.fetch = function kadira_Cursor_fetch () {\n    return originalCursorFetch.apply(this, arguments);\n  };\n\n  // name MongoCursor count\n  let originalCursorCount = MeteorX.MongoCursor.prototype.count;\n  MeteorX.MongoCursor.prototype.count = function kadira_Cursor_count () {\n    return originalCursorCount.apply(this, arguments);\n  };\n\n  // name MongoCursor observeChanges\n  let originalCursorObserveChanges = MeteorX.MongoCursor.prototype.observeChanges;\n  MeteorX.MongoCursor.prototype.observeChanges = function kadira_Cursor_observeChanges () {\n    return originalCursorObserveChanges.apply(this, arguments);\n  };\n\n  // name MongoCursor observe\n  let originalCursorObserve = MeteorX.MongoCursor.prototype.observe;\n  MeteorX.MongoCursor.prototype.observe = function kadira_Cursor_observe () {\n    return originalCursorObserve.apply(this, arguments);\n  };\n\n  // name CrossBar listen\n  let originalCrossbarListen = DDPServer._Crossbar.prototype.listen;\n  DDPServer._Crossbar.prototype.listen = function kadira_Crossbar_listen (trigger, callback) {\n    return originalCrossbarListen.call(this, trigger, callback);\n  };\n\n  // name CrossBar fire\n  let originalCrossbarFire = DDPServer._Crossbar.prototype.fire;\n  DDPServer._Crossbar.prototype.fire = function kadira_Crossbar_fire (notification) {\n    return originalCrossbarFire.call(this, notification);\n  };\n}\n","import { Meteor } from 'meteor/meteor';\n\nexport function wrapFastRender () {\n  Meteor.startup(() => {\n    if (Package['staringatlights:fast-render']) {\n      const FastRender = Package['staringatlights:fast-render'].FastRender;\n\n      // Flow Router doesn't call FastRender.route until after all\n      // Meteor.startup callbacks finish\n      let origRoute = FastRender.route;\n      FastRender.route = function (path, _callback) {\n        let callback = function () {\n          const info = Kadira._getInfo();\n          if (info) {\n            info.suggestedRouteName = path;\n          }\n\n          return _callback.apply(this, arguments);\n        };\n\n        return origRoute.call(FastRender, path, callback);\n      };\n    }\n  });\n}\n","import fs from 'fs';\nconst Fibers = require('fibers');\n\nfunction wrapCallback (args, createWrapper) {\n  if (typeof args[args.length - 1] === 'function') {\n    args[args.length - 1] = createWrapper(args[args.length - 1]);\n  }\n}\n\nexport function handleErrorEvent (eventEmitter, trace, event) {\n  function handler (error) {\n    if (trace && event) {\n      Kadira.tracer.eventEnd(trace, event, {\n        error\n      });\n    }\n\n    // Node throws the error if there are no listeners\n    // We want it to behave as if we are not listening to it\n    if (eventEmitter.listenerCount('error') === 1) {\n      eventEmitter.removeListener('error', handler);\n      eventEmitter.emit('error', error);\n    }\n  }\n\n  eventEmitter.on('error', handler);\n}\n\nexport function wrapFs () {\n  // Some npm packages will do fs calls in the\n  // callback of another fs call.\n  // This variable is set with the kadiraInfo while\n  // a callback is run so we can track other fs calls\n  let fsKadiraInfo = null;\n\n  let originalStat = fs.stat;\n  fs.stat = function () {\n    const kadiraInfo = Kadira._getInfo() || fsKadiraInfo;\n\n    if (kadiraInfo) {\n      let event = Kadira.tracer.event(kadiraInfo.trace, 'fs', {\n        func: 'stat',\n        path: arguments[0],\n        options: typeof arguments[1] === 'object' ? arguments[1] : undefined\n      });\n\n      wrapCallback(arguments, (cb) => function () {\n        Kadira.tracer.eventEnd(kadiraInfo.trace, event);\n\n        if (!Fibers.current) {\n          fsKadiraInfo = kadiraInfo;\n        }\n\n        try {\n          cb(...arguments);\n        } finally {\n          fsKadiraInfo = null;\n        }\n      });\n    }\n\n    return originalStat.apply(fs, arguments);\n  };\n\n  let originalCreateReadStream = fs.createReadStream;\n  fs.createReadStream = function () {\n    const kadiraInfo = Kadira._getInfo() || fsKadiraInfo;\n    let stream = originalCreateReadStream.apply(this, arguments);\n\n    if (kadiraInfo) {\n      const event = Kadira.tracer.event(kadiraInfo.trace, 'fs', {\n        func: 'createReadStream',\n        path: arguments[0],\n        options: JSON.stringify(arguments[1])\n      });\n\n      stream.on('end', () => {\n        Kadira.tracer.eventEnd(kadiraInfo.trace, event);\n      });\n\n      handleErrorEvent(stream, kadiraInfo.trace, event);\n    }\n\n    return stream;\n  };\n}\n","let PerformanceObserver;\nlet constants;\nlet performance;\n\ntry {\n  // Only available in Node 8.5 and newer\n  ({\n    PerformanceObserver,\n    constants,\n    performance\n    // eslint-disable-next-line global-require\n  } = require('perf_hooks'));\n} catch (e) { /* empty */ }\n\nexport default class GCMetrics {\n  constructor () {\n    this._observer = null;\n    this.started = false;\n    this.metrics = {};\n\n    this.reset();\n  }\n\n  start () {\n    if (this.started) {\n      return false;\n    }\n\n    if (!PerformanceObserver || !constants) {\n      // The node version is too old to have PerformanceObserver\n      return false;\n    }\n\n    this.started = true;\n\n    this.observer = new PerformanceObserver(list => {\n      list.getEntries().forEach(entry => {\n        let metric = this._mapKindToMetric(entry.kind);\n        this.metrics[metric] += entry.duration;\n      });\n\n      // The function was removed in Node 10 since it stopped storing old\n      // entries\n      if (typeof performance.clearGC === 'function') {\n        performance.clearGC();\n      }\n    });\n\n    this.observer.observe({ entryTypes: ['gc'], buffered: false });\n  }\n\n  _mapKindToMetric (gcKind) {\n    switch (gcKind) {\n      case constants.NODE_PERFORMANCE_GC_MAJOR:\n        return 'gcMajor';\n      case constants.NODE_PERFORMANCE_GC_MINOR:\n        return 'gcMinor';\n      case constants.NODE_PERFORMANCE_GC_INCREMENTAL:\n        return 'gcIncremental';\n      case constants.NODE_PERFORMANCE_GC_WEAKCB:\n        return 'gcWeakCB';\n      default:\n        console.log(`Monti APM: Unrecognized GC Kind: ${gcKind}`);\n    }\n  }\n\n  reset () {\n    this.metrics = {\n      gcMajor: 0,\n      gcMinor: 0,\n      gcIncremental: 0,\n      gcWeakCB: 0\n    };\n  }\n}\n","import { Meteor } from 'meteor/meteor';\nimport { MongoInternals } from 'meteor/mongo';\n\nlet client;\nlet serverStatus = Object.create(null);\n\nlet otherCheckouts = 0;\n\n// These metrics are only for the mongo pool for the primary Mongo server\nlet primaryCheckouts = 0;\nlet totalCheckoutTime = 0;\nlet maxCheckoutTime = 0;\nlet created = 0;\nlet measurementCount = 0;\nlet pendingTotal = 0;\nlet checkedOutTotal = 0;\n\nsetInterval(() => {\n  let status = getServerStatus(getPrimary(), true);\n\n  if (status) {\n    pendingTotal += status.pending.length;\n    checkedOutTotal += status.checkedOut.size;\n    measurementCount += 1;\n  }\n}, 1000);\n\n// Version 4 of the driver defaults to 100. Older versions used 10.\nlet DEFAULT_MAX_POOL_SIZE = 100;\n\nfunction getPoolSize () {\n  if (client && client.topology && client.topology.s && client.topology.s.options) {\n    return client.topology.s.options.maxPoolSize || DEFAULT_MAX_POOL_SIZE;\n  }\n\n  return 0;\n}\n\nexport function getMongoDriverStats () {\n  return {\n    poolSize: getPoolSize(),\n    primaryCheckouts,\n    otherCheckouts,\n    checkoutTime: totalCheckoutTime,\n    maxCheckoutTime,\n    pending: pendingTotal ? pendingTotal / measurementCount : 0,\n    checkedOut: checkedOutTotal ? checkedOutTotal / measurementCount : 0,\n    created\n  };\n}\n\nexport function resetMongoDriverStats () {\n  primaryCheckouts = 0;\n  otherCheckouts = 0;\n  totalCheckoutTime = 0;\n  maxCheckoutTime = 0;\n  pendingTotal = 0;\n  checkedOutTotal = 0;\n  measurementCount = 0;\n  primaryCheckouts = 0;\n  created = 0;\n}\n\nMeteor.startup(() => {\n  let _client = MongoInternals.defaultRemoteCollectionDriver().mongo.client;\n\n  if (!_client || !_client.s) {\n    // Old version of agent\n    return;\n  }\n\n  let options = _client.s.options || {};\n  let versionParts = MongoInternals.NpmModules.mongodb.version.split('.')\n    .map(part => parseInt(part, 10));\n\n  // Version 4 of the driver removed the option and enabled it by default\n  if (!options.useUnifiedTopology && versionParts[0] < 4) {\n    // CMAP and topology monitoring requires useUnifiedTopology\n    return;\n  }\n\n  // Meteor 1.9 enabled useUnifiedTopology, but CMAP events were only added\n  // in version 3.5 of the driver.\n  if (versionParts[0] === 3 && versionParts[1] < 5) {\n    return;\n  }\n\n  client = _client;\n\n  // Get the number of connections already created\n  let primaryDescription = getServerDescription(getPrimary());\n  if (primaryDescription && primaryDescription.s && primaryDescription.s.pool) {\n    let pool = primaryDescription.s.pool;\n    let totalConnections = pool.totalConnectionCount;\n    let availableConnections = pool.availableConnectionCount;\n\n    // totalConnectionCount counts available connections twice\n    created += totalConnections - availableConnections;\n  }\n\n  client.on('connectionCreated', event => {\n    let primary = getPrimary();\n    if (primary === event.address) {\n      created += 1;\n    }\n  });\n\n  client.on('connectionClosed', event => {\n    let status = getServerStatus(event.address, true);\n    if (status) {\n      status.checkedOut.delete(event.connectionId);\n    }\n  });\n\n  client.on('connectionCheckOutStarted', event => {\n    let status = getServerStatus(event.address);\n    status.pending.push(event.time);\n  });\n\n  client.on('connectionCheckOutFailed', event => {\n    let status = getServerStatus(event.address, true);\n    if (status) {\n      status.pending.shift();\n    }\n  });\n\n  client.on('connectionCheckedOut', event => {\n    let status = getServerStatus(event.address);\n    let start = status.pending.shift();\n    let primary = getPrimary();\n\n    if (start && primary === event.address) {\n      let checkoutDuration = event.time.getTime() - start.getTime();\n\n      primaryCheckouts += 1;\n      totalCheckoutTime += checkoutDuration;\n      if (checkoutDuration > maxCheckoutTime) {\n        maxCheckoutTime = checkoutDuration;\n      }\n    } else {\n      otherCheckouts += 1;\n    }\n\n    status.checkedOut.add(event.connectionId);\n  });\n\n  client.on('connectionCheckedIn', event => {\n    let status = getServerStatus(event.address, true);\n    if (status) {\n      status.checkedOut.delete(event.connectionId);\n    }\n  });\n\n  client.on('serverClosed', function (event) {\n    delete serverStatus[event.address];\n  });\n});\n\nfunction getServerStatus (address, disableCreate) {\n  if (typeof address !== 'string') {\n    return null;\n  }\n\n  if (address in serverStatus) {\n    return serverStatus[address];\n  }\n\n  if (disableCreate) {\n    return null;\n  }\n\n  serverStatus[address] = {\n    pending: [],\n    checkedOut: new Set(),\n  };\n\n  return serverStatus[address];\n}\n\nfunction getPrimary () {\n  if (!client || !client.topology) {\n    return null;\n  }\n  // The driver renamed lastIsMaster in version 4.3.1 to lastHello\n  let server = client.topology.lastIsMaster ?\n    client.topology.lastIsMaster() :\n    client.topology.lastHello();\n\n  if (server.type === 'Standalone') {\n    return server.address;\n  }\n\n  if (!server || !server.primary) {\n    return null;\n  }\n\n  return server.primary;\n}\n\nfunction getServerDescription (address) {\n  if (!client || !client.topology || !client.topology.s || !client.topology.s.servers) {\n    return null;\n  }\n  let description = client.topology.s.servers.get(address);\n\n  return description || null;\n}\n","import { Meteor } from 'meteor/meteor';\nimport Fiber from 'fibers';\n\nexport function wrapPicker () {\n  Meteor.startup(() => {\n    if (!Package['meteorhacks:picker']) {\n      return;\n    }\n\n    const Picker = Package['meteorhacks:picker'].Picker;\n\n    // Wrap Picker._processRoute to make sure it runs the\n    // handler in a Fiber with __kadiraInfo set\n    // Needed if any previous middleware called `next` outside of a fiber.\n    const origProcessRoute = Picker.constructor.prototype._processRoute;\n    Picker.constructor.prototype._processRoute = function (callback, params, req) {\n      const args = arguments;\n\n      if (!Fiber.current) {\n        return new Fiber(() => {\n          Kadira._setInfo(req.__kadiraInfo);\n          return origProcessRoute.apply(this, args);\n        }).run();\n      }\n\n      if (req.__kadiraInfo) {\n        Kadira._setInfo(req.__kadiraInfo);\n      }\n\n      return origProcessRoute.apply(this, args);\n    };\n  });\n}\n","import { millisToHuman } from '../common/utils';\n\nexport const TimeoutManager = {\n  id: 0,\n  map: new Map(),\n\n  prettyMessage: {\n    method: (method) => `Method \"${method}\" still running after`,\n    sub: (sub) => `Subscription \"${sub}\" still not ready after`\n  },\n\n  addTimeout (fn, timeout) {\n    if (!fn) {\n      throw new Error('TimeoutManager.addTimeout: fn is required');\n    }\n\n    const id = ++this.id;\n\n    this.map.set(id, setTimeout(Meteor.bindEnvironment(() => {\n      fn();\n\n      this.map.delete(id);\n    }), timeout));\n\n    return id;\n  },\n\n  trackTimeout ({ kadiraInfo, msg, timeout = Kadira.options.stalledTimeout }) {\n    if (!timeout) {\n      return;\n    }\n\n    const type = msg.msg;\n    const method = msg.method || msg.name;\n\n    const error = new Error(`${this.prettyMessage[type](method) || 'Unknown Timeout'} ${millisToHuman(timeout)}`);\n\n    kadiraInfo.timeoutId = this.addTimeout(() => {\n      Kadira.EventBus.emit('method', 'timeout', kadiraInfo, error);\n\n      Monti.trackError(error, { type, subType: 'server', kadiraInfo });\n\n      console.warn(`[Monti APM] ${error.message}`);\n    }, timeout);\n  },\n\n  clearTimeout ({ kadiraInfo = Kadira._getInfo() } = {}) {\n    if (!kadiraInfo) return;\n\n    const { timeoutId } = kadiraInfo;\n\n    if (timeoutId && this.map.has(timeoutId)) {\n      clearTimeout(this.map.get(timeoutId));\n      this.map.delete(timeoutId);\n      delete kadiraInfo.timeoutId;\n    }\n  }\n};\n","export function wrapRouters () {\n  let connectRoutes = [];\n  try {\n    // eslint-disable-next-line global-require\n    connectRoutes.push(require('connect-route'));\n  } catch (e) {\n    // We can ignore errors\n  }\n\n  try {\n    if (Package['simple:json-routes']) {\n      // Relative from .npm/node_modules/meteor/montiapm_agent/node_modules\n      // Npm.require is less strict on what paths you use than require\n      connectRoutes.push(Npm.require('../../simple_json-routes/node_modules/connect-route'));\n    }\n  } catch (e) {\n    // we can ignore errors\n  }\n\n  connectRoutes.forEach(connectRoute => {\n    if (typeof connectRoute !== 'function') {\n      return;\n    }\n\n    connectRoute((router) => {\n      const oldAdd = router.constructor.prototype.add;\n      router.constructor.prototype.add = function (method, route, handler) {\n        // Unlike most routers, connect-route doesn't look at the arguments length\n        oldAdd.call(this, method, route, function () {\n          if (arguments[0] && arguments[0].__kadiraInfo) {\n            arguments[0].__kadiraInfo.suggestedRouteName = route;\n          }\n\n          handler(...arguments);\n        });\n      };\n    });\n  });\n}\n","import { WebAppInternals, WebApp } from 'meteor/webapp';\nimport Fibers from 'fibers';\n\n// Maximum content-length size\nconst MAX_BODY_SIZE = 8000;\n// Maximum characters for stringified body\nconst MAX_STRINGIFIED_BODY_SIZE = 4000;\n\nconst canWrapStaticHandler = !!WebAppInternals.staticFilesByArch;\n\n// This checks if running on a version of Meteor that\n// wraps connect handlers in a fiber.\n// This check is dependant on Meteor's implementation of `use`,\n// which wraps every handler in a new fiber.\n// This will need to be updated if Meteor starts reusing\n// fibers when they exist.\nexport function checkHandlersInFiber () {\n  const handlersLength = WebApp.rawConnectHandlers.stack.length;\n  let inFiber = false;\n  let outsideFiber = Fibers.current;\n\n  WebApp.rawConnectHandlers.use((_req, _res, next) => {\n    inFiber = Fibers.current && Fibers.current !== outsideFiber;\n\n    // in case we didn't successfully remove this handler\n    // and it is a real request\n    next();\n  });\n\n  if (WebApp.rawConnectHandlers.stack[handlersLength]) {\n    let handler = WebApp.rawConnectHandlers.stack[handlersLength].handle;\n\n    // remove the newly added handler\n    // We remove it immediately so there is no opportunity for\n    // other code to add handlers first if the current fiber is yielded\n    // while running the handler\n    while (WebApp.rawConnectHandlers.stack.length > handlersLength) {\n      WebApp.rawConnectHandlers.stack.pop();\n    }\n\n    handler({}, {}, () => {});\n  }\n\n  return inFiber;\n}\n\nconst InfoSymbol = Symbol('MontiInfoSymbol');\n\nexport async function wrapWebApp () {\n  if (!checkHandlersInFiber() || !canWrapStaticHandler) {\n    return;\n  }\n\n  const parseUrl = require('parseurl');\n\n  WebAppInternals.registerBoilerplateDataCallback('__montiApmRouteName', function (request) {\n    // TODO: record in trace which arch is used\n\n    if (request[InfoSymbol]) {\n      request[InfoSymbol].isAppRoute = true;\n    }\n\n    // Let WebApp know we didn't make changes\n    // so it can use a cache\n    return false;\n  });\n\n  // We want the request object returned by categorizeRequest to have\n  // __kadiraInfo\n  let origCategorizeRequest = WebApp.categorizeRequest;\n  WebApp.categorizeRequest = function (req) {\n    let result = origCategorizeRequest.apply(this, arguments);\n\n    if (result && req.__kadiraInfo) {\n      result[InfoSymbol] = req.__kadiraInfo;\n    }\n\n    return result;\n  };\n\n  // Adding the handler directly to the stack\n  // to force it to be the first one to run\n  WebApp.rawConnectHandlers.stack.unshift({\n    route: '',\n    handle: (req, res, next) => {\n      const name = parseUrl(req).pathname;\n      const trace = Kadira.tracer.start(`${req.method}-${name}`, 'http');\n\n      const headers = Kadira.tracer._applyObjectFilters(req.headers);\n      Kadira.tracer.event(trace, 'start', {\n        url: req.url,\n        method: req.method,\n        headers: JSON.stringify(headers),\n      });\n      req.__kadiraInfo = { trace };\n\n      res.on('finish', () => {\n        if (req.__kadiraInfo.asyncEvent) {\n          Kadira.tracer.eventEnd(trace, req.__kadiraInfo.asyncEvent);\n        }\n\n        Kadira.tracer.endLastEvent(trace);\n\n        if (req.__kadiraInfo.isStatic) {\n          trace.name = `${req.method}-<static file>`;\n        } else if (req.__kadiraInfo.suggestedRouteName) {\n          trace.name = `${req.method}-${req.__kadiraInfo.suggestedRouteName}`;\n        } else if (req.__kadiraInfo.isAppRoute) {\n          trace.name = `${req.method}-<app>`;\n        }\n\n        const isJson = req.headers['content-type'] === 'application/json';\n        const hasSmallBody = req.headers['content-length'] > 0 && req.headers['content-length'] < MAX_BODY_SIZE;\n\n        // Check after all middleware have run to see if any of them\n        // set req.body\n        // Technically bodies can be used with any method, but since many load balancers and\n        // other software only support bodies for POST requests, we are\n        // not recording the body for other methods.\n        if (req.method === 'POST' && req.body && isJson && hasSmallBody) {\n          try {\n            let body = JSON.stringify(req.body);\n\n            // Check the body size again in case it is much\n            // larger than what was in the content-length header\n            if (body.length < MAX_STRINGIFIED_BODY_SIZE) {\n              trace.events[0].data.body = body;\n            }\n          } catch (e) {\n          // It is okay if this fails\n          }\n        }\n\n        // TODO: record status code\n        Kadira.tracer.event(trace, 'complete');\n        let built = Kadira.tracer.buildTrace(trace);\n        Kadira.models.http.processRequest(built, req, res);\n      });\n\n      next();\n    }\n  });\n\n\n  function wrapHandler (handler) {\n    // connect identifies error handles by them accepting\n    // four arguments\n    let errorHandler = handler.length === 4;\n\n    function wrapper (req, res, next) {\n      let error;\n      if (errorHandler) {\n        error = req;\n        req = res;\n        res = next;\n        next = arguments[3];\n      }\n\n      const kadiraInfo = req.__kadiraInfo;\n      Kadira._setInfo(kadiraInfo);\n\n      let nextCalled = false;\n      // TODO: track errors passed to next or thrown\n      function wrappedNext (...args) {\n        if (kadiraInfo && kadiraInfo.asyncEvent) {\n          Kadira.tracer.eventEnd(req.__kadiraInfo.trace, req.__kadiraInfo.asyncEvent);\n          req.__kadiraInfo.asyncEvent = null;\n        }\n\n        nextCalled = true;\n        next(...args);\n      }\n\n      let potentialPromise;\n\n      if (errorHandler) {\n        potentialPromise = handler.call(this, error, req, res, wrappedNext);\n      } else {\n        potentialPromise = handler.call(this, req, res, wrappedNext);\n      }\n\n      if (potentialPromise && typeof potentialPromise.then === 'function') {\n        potentialPromise.then(() => {\n          // res.finished is depreciated in Node 13, but it is the only option\n          // for Node 12.9 and older.\n          if (kadiraInfo && !res.finished && !nextCalled) {\n            const lastEvent = Kadira.tracer.getLastEvent(kadiraInfo.trace);\n            if (lastEvent.endAt) {\n              // req is not done, and next has not been called\n              // create an async event that will end when either of those happens\n              kadiraInfo.asyncEvent = Kadira.tracer.event(kadiraInfo.trace, 'async');\n            }\n          }\n        });\n      }\n\n      return potentialPromise;\n    }\n\n    if (errorHandler) {\n      return function (error, req, res, next) {\n        return wrapper(error, req, res, next);\n      };\n    }\n    return function (req, res, next) {\n      return wrapper(req, res, next);\n    };\n  }\n\n  function wrapConnect (app, wrapStack) {\n    let oldUse = app.use;\n    if (wrapStack) {\n      // We need to set kadiraInfo on the Fiber the handler will run in.\n      // Meteor has already wrapped the handler to run it in a new Fiber\n      // by using Promise.asyncApply so we are not able to directly set it\n      // on that Fiber.\n      // Meteor's promise library copies properties from the current fiber to\n      // the new fiber, so we can wrap it in another Fiber with kadiraInfo set\n      // and Meteor will copy kadiraInfo to the new Fiber.\n      // It will only create the additional Fiber if it isn't already running in a Fiber\n      app.stack.forEach(entry => {\n        let wrappedHandler = wrapHandler(entry.handle);\n        if (entry.handle.length >= 4) {\n          // eslint-disable-next-line no-unused-vars,handle-callback-err\n          entry.handle = function (error, req, res, next) {\n            return Promise.asyncApply(\n              wrappedHandler,\n              this,\n              arguments,\n              true\n            );\n          };\n        } else {\n          // eslint-disable-next-line no-unused-vars\n          entry.handle = function (req, res, next) {\n            return Promise.asyncApply(\n              wrappedHandler,\n              this,\n              arguments,\n              true\n            );\n          };\n        }\n      });\n    }\n    app.use = function (...args) {\n      args[args.length - 1] = wrapHandler(args[args.length - 1]);\n      return oldUse.apply(app, args);\n    };\n  }\n\n  wrapConnect(WebApp.rawConnectHandlers, false);\n  wrapConnect(WebAppInternals.meteorInternalHandlers, false);\n\n  // The oauth package and other core packages might have already added their middleware,\n  // so we need to wrap the existing middleware\n  wrapConnect(WebApp.connectHandlers, true);\n\n  wrapConnect(WebApp.connectApp, false);\n\n  let oldStaticFilesMiddleware = WebAppInternals.staticFilesMiddleware;\n  const staticHandler = wrapHandler(oldStaticFilesMiddleware.bind(WebAppInternals, WebAppInternals.staticFilesByArch));\n  WebAppInternals.staticFilesMiddleware = function (_staticFiles, req, res, next) {\n    if (req.__kadiraInfo) {\n      req.__kadiraInfo.isStatic = true;\n    }\n\n    return staticHandler(req, res, function () {\n      // if the request is for a static file, the static handler will end the response\n      // instead of calling next\n      req.__kadiraInfo.isStatic = false;\n      return next.apply(this, arguments);\n    });\n  };\n}\n","function normalizedPrefix (name) {\n  return name.replace('KADIRA_', 'MONTI_');\n}\n\nKadira._parseEnv = function (env) {\n  let options = {};\n  for (let name in env) {\n    let value = env[name];\n    let normalizedName = normalizedPrefix(name);\n    let info = Kadira._parseEnv._options[normalizedName];\n\n    if (info && value) {\n      options[info.name] = info.parser(value);\n    }\n  }\n\n  return options;\n};\n\n\nKadira._parseEnv.parseInt = function (str) {\n  let num = parseInt(str, 10);\n  if (num || num === 0) {\n    return num;\n  }\n  throw new Error(`Kadira: Match Error: \"${num}\" is not a number`);\n};\n\n\nKadira._parseEnv.parseBool = function (str) {\n  str = str.toLowerCase();\n  if (str === 'true') {\n    return true;\n  }\n  if (str === 'false') {\n    return false;\n  }\n  throw new Error(`Kadira: Match Error: ${str} is not a boolean`);\n};\n\n\nKadira._parseEnv.parseUrl = function (str) {\n  return str;\n};\n\n\nKadira._parseEnv.parseString = function (str) {\n  return str;\n};\n\n\nKadira._parseEnv._options = {\n  // auth\n  MONTI_APP_ID: {\n    name: 'appId',\n    parser: Kadira._parseEnv.parseString\n  },\n  MONTI_APP_SECRET: {\n    name: 'appSecret',\n    parser: Kadira._parseEnv.parseString\n  },\n  MONTI_OPTIONS_STALLED_TIMEOUT: {\n    name: 'stalledTimeout',\n    parser: Kadira._parseEnv.parseInt,\n  },\n  // delay to send the initial ping to the kadira engine after page loads\n  MONTI_OPTIONS_CLIENT_ENGINE_SYNC_DELAY: {\n    name: 'clientEngineSyncDelay',\n    parser: Kadira._parseEnv.parseInt,\n  },\n  // time between sending errors to the engine\n  MONTI_OPTIONS_ERROR_DUMP_INTERVAL: {\n    name: 'errorDumpInterval',\n    parser: Kadira._parseEnv.parseInt,\n  },\n  // no of errors allowed in a given interval\n  MONTI_OPTIONS_MAX_ERRORS_PER_INTERVAL: {\n    name: 'maxErrorsPerInterval',\n    parser: Kadira._parseEnv.parseInt,\n  },\n  // a zone.js specific option to collect the full stack trace(which is not much useful)\n  MONTI_OPTIONS_COLLECT_ALL_STACKS: {\n    name: 'collectAllStacks',\n    parser: Kadira._parseEnv.parseBool,\n  },\n  // enable error tracking (which is turned on by default)\n  MONTI_OPTIONS_ENABLE_ERROR_TRACKING: {\n    name: 'enableErrorTracking',\n    parser: Kadira._parseEnv.parseBool,\n  },\n  MONTI_OPTIONS_DISABLE_CLIENT_ERROR_TRACKING: {\n    name: 'disableClientErrorTracking',\n    parser: Kadira._parseEnv.parseBool,\n  },\n  // kadira engine endpoint\n  MONTI_OPTIONS_ENDPOINT: {\n    name: 'endpoint',\n    parser: Kadira._parseEnv.parseUrl,\n  },\n  // define the hostname of the current running process\n  MONTI_OPTIONS_HOSTNAME: {\n    name: 'hostname',\n    parser: Kadira._parseEnv.parseString,\n  },\n  // interval between sending data to the kadira engine from the server\n  MONTI_OPTIONS_PAYLOAD_TIMEOUT: {\n    name: 'payloadTimeout',\n    parser: Kadira._parseEnv.parseInt,\n  },\n  // set HTTP/HTTPS proxy\n  MONTI_OPTIONS_PROXY: {\n    name: 'proxy',\n    parser: Kadira._parseEnv.parseUrl,\n  },\n  // number of items cached for tracking document size\n  MONTI_OPTIONS_DOCUMENT_SIZE_CACHE_SIZE: {\n    name: 'documentSizeCacheSize',\n    parser: Kadira._parseEnv.parseInt,\n  },\n  // enable uploading sourcemaps\n  MONTI_UPLOAD_SOURCE_MAPS: {\n    name: 'uploadSourceMaps',\n    parser: Kadira._parseEnv.parseBool\n  },\n  MONTI_RECORD_IP_ADDRESS: {\n    name: 'recordIPAddress',\n    parser: Kadira._parseEnv.parseString,\n  },\n  MONTI_EVENT_STACK_TRACE: {\n    name: 'eventStackTrace',\n    parser: Kadira._parseEnv.parseBool,\n  },\n  MONTI_OPTIONS_DISABLE_NTP: {\n    name: 'disableNtp',\n    parser: Kadira._parseEnv.parseBool,\n  },\n};\n","import { Meteor } from 'meteor/meteor';\n\nKadira._connectWithEnv = function () {\n  const options = Kadira._parseEnv(process.env);\n  if (options.appId && options.appSecret) {\n    Kadira.connect(\n      options.appId,\n      options.appSecret,\n      options\n    );\n\n    Kadira.connect = function () {\n      throw new Error('Kadira has been already connected using credentials from Environment Variables');\n    };\n  }\n};\n\n\nKadira._connectWithSettings = function () {\n  const montiSettings = Meteor.settings.monti || Meteor.settings.kadira;\n\n  if (\n    montiSettings &&\n    montiSettings.appId &&\n    montiSettings.appSecret\n  ) {\n    Kadira.connect(\n      montiSettings.appId,\n      montiSettings.appSecret,\n      montiSettings.options || {}\n    );\n\n    Kadira.connect = function () {\n      throw new Error('Kadira has been already connected using credentials from Meteor.settings');\n    };\n  }\n};\n\n/**\n * We need to instrument this right away, and it's okay\n * One reason for this is to call `setLabels()` function\n * Otherwise, CPU profile can't see all our custom labeling\n *\n * Previously there was two log messages (one for instrumentation,\n * and another for connection), this way we merged both of them.\n */\nKadira._startInstrumenting(function () {\n  Kadira._connectWithEnv();\n  Kadira._connectWithSettings();\n});\n","import { Meteor } from 'meteor/meteor';\n\nconst conflictingPackages = [\n  'mdg:meteor-apm-agent',\n  'lmachens:kadira',\n  'meteorhacks:kadira'\n];\n\nMeteor.startup(() => {\n  conflictingPackages.forEach(name => {\n    if (name in Package) {\n      console.log(\n        `Monti APM: your app is using the ${name} package. Using more than one APM agent in an app can cause unexpected problems.`\n      );\n    }\n  });\n});\n","import { EventEmitter } from 'events';\n\nfunction isNode () {\n  return typeof process !== 'undefined' && process.versions && process.versions.node;\n}\n\nfunction polyfillNow () {\n  const [seconds, nanoseconds] = process.hrtime();\n\n  return seconds * 1000 + nanoseconds / 1000000;\n}\n\nexport class EventLoopMonitor extends EventEmitter {\n  constructor (timeoutMillis) {\n    super();\n    this.timeoutMillis = timeoutMillis;\n    this._watchLag = this._watchLag.bind(this);\n    this._stopped = true;\n    this._startTime = null;\n    this._totalLag = 0;\n\n    this._registerNowFunc();\n  }\n\n  start () {\n    this._stopped = false;\n    this._lastWatchTime = null;\n    this._startTime = Date.now();\n    this._totalLag = 0;\n\n    this.on('lag', this._watchLag);\n    this._detectLag();\n  }\n\n  stop () {\n    this._stopped = true;\n    this.removeAllListeners('lag');\n  }\n\n  status () {\n    let pctBlock = 0;\n    let elapsedTime = 0;\n    if (!this._stopped && this._lastWatchTime) {\n      elapsedTime = this._lastWatchTime - this._startTime;\n      pctBlock = (this._totalLag / elapsedTime) * 100;\n    }\n\n    let statusObject = {\n      pctBlock,\n      elapsedTime,\n      totalLag: this._totalLag\n    };\n\n    this._startTime = this._lastWatchTime;\n    this._totalLag = 0;\n\n    return statusObject;\n  }\n\n  _watchLag (lag) {\n    this._lastWatchTime = Date.now();\n    this._totalLag += lag;\n  }\n\n  _detectLag () {\n    let self = this;\n    let start = self._now();\n\n    setTimeout(function () {\n      let end = self._now();\n      let elapsedTime = end - start;\n      let realDiff = elapsedTime - self.timeoutMillis;\n      let lag = Math.max(0, realDiff);\n\n      if (!self._stopped) {\n        self.emit('lag', lag);\n        self._detectLag();\n      }\n    }, self.timeoutMillis);\n  }\n\n  _registerNowFunc () {\n    if (isNode()) {\n      const [major] = process.versions.node.split('.').map(Number);\n\n      if (major < 8) {\n        this._now = polyfillNow;\n        return;\n      }\n\n      const {\n        performance\n        // eslint-disable-next-line global-require\n      } = require('perf_hooks');\n      this._now = performance.now;\n      return;\n    }\n\n    if (typeof window !== 'undefined' && window.performance && window.performance.now) {\n      this._now = window.performance.now;\n      return;\n    }\n\n    this._now = Date.now;\n  }\n}\n"]}